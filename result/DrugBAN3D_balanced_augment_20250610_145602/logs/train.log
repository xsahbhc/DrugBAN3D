=== 详细配置信息 ===
配置文件: result/DrugBAN3D_balanced_augment_20250610_145602/config/DrugBAN3D_augmented_20250610_143149.yaml
训练数据: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250610_143149/train_augmented.csv
验证数据: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250610_143149/valid_augmented.csv
测试数据: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv
缓存目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250610_143149
结果目录: result/DrugBAN3D_balanced_augment_20250610_145602

=== 完整配置参数详览 ===
📋 训练参数 (TRAIN):
  TRAIN:
    D_LEARNING_RATE: 0.0004   # 最优判别器学习率（来自最佳实验）
    G_LEARNING_RATE: 0.0002   # 最优生成器学习率（来自最佳实验）
    BATCH_SIZE: 48  # 最佳batch size（来自最佳实验）
    D_STEPS_PER_G_STEP: 1
    RESUME_CHECKPOINT: ""
    EPOCH: 100  # 充足的训练轮数
    GRADIENT_ACCUMULATE_STEPS: 2  # 梯度累积，有效batch size = 48*2 = 96
    GRADIENT_CLIP_NORM: 1.0  # 梯度裁剪阈值（来自最佳实验）
    WEIGHT_DECAY: 0.0004  # 最优权重衰减（来自最佳实验）
    LABEL_SMOOTHING: 0.05  # 标签平滑参数（来自最佳实验）
    POS_WEIGHT: 1.05  # 正样本权重（来自最佳实验）

🏗️ GNN配置:
  GNN:
    HIDDEN_DIM: 384  # 最优GNN隐藏维度
    NUM_LAYERS: 4    # 最优GNN层数
  
  BCN:
    HEADS: 8  # 最优注意力头数量

🔧 解码器配置:
  DECODER:
    IN_DIM: 384
    HIDDEN_DIM: 512  # 最优解码器隐藏维度
    OUT_DIM: 128  # 最优解码器输出维度
    BINARY: 1
    DROPOUT: 0.3  # 最优Dropout率，平衡过拟合和欠拟合
  
  ADAPT:
    LAMBDA: 0.1

📊 损失函数配置:
  USE_BIAS_CORRECTION: True  # 启用偏置校正，提升模型稳定性
  USE_FOCAL_LOSS: True  # 使用焦点损失处理类别不平衡
  FOCAL_LOSS_GAMMA: 1.0  # 最优gamma值，温和的焦点损失
  FOCAL_LOSS_ALPHA: 0.3  # 最优alpha值，平衡正负样本

🌐 3D空间特征配置:
  SPATIAL_3D:
    ENABLE_SPATIAL_FUSION: true      # 启用3D空间感知特征融合 - 重要性能提升
    ENABLE_MULTISCALE: true          # 启用多尺度特征提取 - 捕获不同距离的相互作用
    DISTANCE_SCALES: [2.0, 5.0, 8.0]  # 最优多尺度距离阈值(Å)
    SPATIAL_DROPOUT: 0.1             # 最优空间模块Dropout率
    CROSS_ATTENTION_HEADS: 8         # 最优交叉注意力头数
  
  # 损失函数配置 - 最优设置
  USE_FOCAL_LOSS: True  # 使用焦点损失处理类别不平衡

⚙️ 求解器配置:
  SOLVER:
    MAX_EPOCH: 100  # 充足的训练轮数
    BATCH_SIZE: 48  # 最优batch size（来自最佳实验）
    USE_MIXED_PRECISION: False  # 不使用混合精度训练，保持稳定性
    LR_SCHEDULER: True  # 启用学习率调度器（来自最佳实验）
    LR_SCHEDULER_TYPE: "plateau"  # 最优学习率调度器（来自最佳实验）
    LR_WARMUP_EPOCHS: 4  # 最优学习率预热轮数（来自最佳实验）
    GRADIENT_CLIP_NORM: 1.0  # 梯度裁剪阈值（来自最佳实验）
    SEED: 42  # 固定随机种子保证可重现性
  
  RESULT:

⏹️ 早停配置:
  USE_EARLY_STOPPING: True
  EARLY_STOPPING_PATIENCE: 15  # 最优早停耐心值，避免过早停止

=========================

训练开始时间: 2025年 06月 10日 星期二 14:56:03 CST
使用命令行指定的输出目录: result/DrugBAN3D_balanced_augment_20250610_145602
已保存当前配置到 result/DrugBAN3D_balanced_augment_20250610_145602/config/config_used.yaml
配置文件: result/DrugBAN3D_balanced_augment_20250610_145602/config/DrugBAN3D_augmented_20250610_143149.yaml
输出目录: result/DrugBAN3D_balanced_augment_20250610_145602
运行设备: cuda
数据加载器使用 16 个工作线程
使用分层采样的预划分数据集
数据集: 训练集 10519 样本, 验证集 1393 样本, 测试集 1044 样本
正样本比例: 训练集 48.75%, 验证集 32.23%, 测试集 32.28%
使用增强数据集进行训练...
加载标签文件: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250610_143149/train_augmented.csv, 包含 10519 条记录
找到 10519/10519 个对应的缓存文件
数据集初始化完成，总样本数: 10519
训练/验证 数据集初始化完成: 10519 个样本
创建数据加载器成功: 预期 220 批次，批次大小 48
加载标签文件: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250610_143149/valid_augmented.csv, 包含 1393 条记录
找到 1393/1393 个对应的缓存文件
数据集初始化完成，总样本数: 1393
训练/验证 数据集初始化完成: 1393 个样本
创建数据加载器成功: 预期 30 批次，批次大小 48
测试模式: 使用原始测试数据
测试标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv
缓存目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/cached_graphs
测试标签文件包含 1044 条记录
测试集标签分布: 正样本 337 (32.28%), 负样本 707 (67.72%)
读取测试标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv, 包含 1044 条记录
成功创建测试标签映射，包含 2088 个条目
测试模式：从标签文件获取 2088 个复合物ID
测试模式：只处理标签文件中的 2088 个样本
在缓存目录中找到 1039/2088 个测试样本缓存文件
数据集初始化完成，总样本数: 1039
测试 数据集初始化完成: 1039 个样本
创建数据加载器成功: 预期 22 批次，批次大小 48

==================================================
DrugBAN3D初始化 - 偏差校正模块: 启用
Dropout率: 0.3
GNN层数: 4
==================================================

优化器: Adam, 学习率: 0.0002, L2正则化强度: 0.0004
启用标签平滑，参数值: 0.05
启用类别加权，正样本权重: 1.050
启用梯度裁剪，阈值：1.0
使用state_dict保存模型，避免完整对象复制
使用plateau学习率调度器
运行设备: cuda
启用标签平滑，参数值: 0.05
启用类别加权，正样本权重: 1.0499999523162842
使用ReduceLROnPlateau学习率调度器，监控验证集AUROC
开始训练...
批次 0: 正样本 28, 负样本 20
批次 100: 正样本 30, 负样本 18
批次 200: 正样本 22, 负样本 26
本轮训练: 正样本 80 (55.56%), 负样本 64 (44.44%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 1.2688
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.8954
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.9452
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 0.9026
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 1.7606
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.5623, AUPRC=0.3883
当前学习率: 0.000200
保存最佳模型（轮次 1）到 result/DrugBAN3D_balanced_augment_20250610_145602/best_model.pth
Epoch 1/100 - 训练损失: 2.4968 - 验证AUROC: 0.5623 - 验证AUPRC: 0.3883
批次 0: 正样本 22, 负样本 26
批次 100: 正样本 24, 负样本 24
批次 200: 正样本 18, 负样本 30
本轮训练: 正样本 64 (44.44%), 负样本 80 (55.56%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 0.6824
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.6794
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.6046
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 0.5627
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 2.9159
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.7173, AUPRC=0.5321
当前学习率: 0.000200
保存最佳模型（轮次 2）到 result/DrugBAN3D_balanced_augment_20250610_145602/best_model.pth
Epoch 2/100 - 训练损失: 1.7176 - 验证AUROC: 0.7173 - 验证AUPRC: 0.5321
批次 0: 正样本 25, 负样本 23
批次 100: 正样本 25, 负样本 23
批次 200: 正样本 19, 负样本 29
本轮训练: 正样本 69 (47.92%), 负样本 75 (52.08%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 0.8279
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.7996
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.5609
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 0.6094
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 4.9183
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.7105, AUPRC=0.5242
当前学习率: 0.000200
Epoch 3/100 - 训练损失: 1.4873 - 验证AUROC: 0.7105 - 验证AUPRC: 0.5242
批次 0: 正样本 27, 负样本 21
批次 100: 正样本 25, 负样本 23
批次 200: 正样本 23, 负样本 25
本轮训练: 正样本 75 (52.08%), 负样本 69 (47.92%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 0.7332
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 2.7759
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.7711
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 0.6448
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 1.0460
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.7732, AUPRC=0.6017
当前学习率: 0.000200
保存最佳模型（轮次 4）到 result/DrugBAN3D_balanced_augment_20250610_145602/best_model.pth
Epoch 4/100 - 训练损失: 1.3319 - 验证AUROC: 0.7732 - 验证AUPRC: 0.6017
批次 0: 正样本 24, 负样本 24
批次 100: 正样本 24, 负样本 24
批次 200: 正样本 17, 负样本 31
本轮训练: 正样本 65 (45.14%), 负样本 79 (54.86%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 0.5948
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.6884
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.6104
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 0.4640
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 2.8124
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.7853, AUPRC=0.6103
当前学习率: 0.000200
保存最佳模型（轮次 5）到 result/DrugBAN3D_balanced_augment_20250610_145602/best_model.pth
Epoch 5/100 - 训练损失: 1.2374 - 验证AUROC: 0.7853 - 验证AUPRC: 0.6103
批次 0: 正样本 19, 负样本 29
批次 100: 正样本 26, 负样本 22
批次 200: 正样本 24, 负样本 24
本轮训练: 正样本 69 (47.92%), 负样本 75 (52.08%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 1.8186
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.8023
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 1.5773
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 0.5695
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 2.6020
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.7718, AUPRC=0.6130
当前学习率: 0.000200
Epoch 6/100 - 训练损失: 1.1401 - 验证AUROC: 0.7718 - 验证AUPRC: 0.6130
批次 0: 正样本 26, 负样本 22
批次 100: 正样本 22, 负样本 26
批次 200: 正样本 25, 负样本 23
本轮训练: 正样本 73 (50.69%), 负样本 71 (49.31%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 0.5327
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.5873
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.4713
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 0.4759
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 2.8200
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8122, AUPRC=0.6461
当前学习率: 0.000200
保存最佳模型（轮次 7）到 result/DrugBAN3D_balanced_augment_20250610_145602/best_model.pth
Epoch 7/100 - 训练损失: 1.0857 - 验证AUROC: 0.8122 - 验证AUPRC: 0.6461
批次 0: 正样本 22, 负样本 26
批次 100: 正样本 28, 负样本 20
批次 200: 正样本 16, 负样本 32
本轮训练: 正样本 66 (45.83%), 负样本 78 (54.17%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 0.6419
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.6806
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.7578
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 0.4738
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.6192
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8233, AUPRC=0.6905
当前学习率: 0.000200
保存最佳模型（轮次 8）到 result/DrugBAN3D_balanced_augment_20250610_145602/best_model.pth
Epoch 8/100 - 训练损失: 1.0915 - 验证AUROC: 0.8233 - 验证AUPRC: 0.6905
批次 0: 正样本 22, 负样本 26
批次 100: 正样本 25, 负样本 23
批次 200: 正样本 16, 负样本 32
本轮训练: 正样本 63 (43.75%), 负样本 81 (56.25%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 0.7156
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.5786
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.5261
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 0.5751
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 2.5913
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8034, AUPRC=0.6474
当前学习率: 0.000200
Epoch 9/100 - 训练损失: 1.0026 - 验证AUROC: 0.8034 - 验证AUPRC: 0.6474
批次 0: 正样本 16, 负样本 32
批次 100: 正样本 29, 负样本 19
批次 200: 正样本 19, 负样本 29
本轮训练: 正样本 64 (44.44%), 负样本 80 (55.56%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 0.7168
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.5749
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.6993
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 0.5862
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 2.7249
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8069, AUPRC=0.6297
当前学习率: 0.000200
Epoch 10/100 - 训练损失: 1.0889 - 验证AUROC: 0.8069 - 验证AUPRC: 0.6297
批次 0: 正样本 24, 负样本 24
批次 100: 正样本 30, 负样本 18
批次 200: 正样本 18, 负样本 30
本轮训练: 正样本 72 (50.00%), 负样本 72 (50.00%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 0.7117
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.6034
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.5594
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 0.5282
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 2.5306
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8177, AUPRC=0.6875
当前学习率: 0.000200
Epoch 11/100 - 训练损失: 0.9586 - 验证AUROC: 0.8177 - 验证AUPRC: 0.6875
批次 0: 正样本 22, 负样本 26
批次 100: 正样本 26, 负样本 22
批次 200: 正样本 28, 负样本 20
本轮训练: 正样本 76 (52.78%), 负样本 68 (47.22%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 0.9185
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.6820
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.5729
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 0.5836
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.4812
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8146, AUPRC=0.6899
当前学习率: 0.000200
Epoch 12/100 - 训练损失: 0.8678 - 验证AUROC: 0.8146 - 验证AUPRC: 0.6899
批次 0: 正样本 26, 负样本 22
批次 100: 正样本 29, 负样本 19
批次 200: 正样本 23, 负样本 25
本轮训练: 正样本 78 (54.17%), 负样本 66 (45.83%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 0.7304
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.5273
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.5233
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 0.5357
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.4719
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8318, AUPRC=0.6991
当前学习率: 0.000200
保存最佳模型（轮次 13）到 result/DrugBAN3D_balanced_augment_20250610_145602/best_model.pth
Epoch 13/100 - 训练损失: 0.8196 - 验证AUROC: 0.8318 - 验证AUPRC: 0.6991
批次 0: 正样本 25, 负样本 23
批次 100: 正样本 29, 负样本 19
批次 200: 正样本 24, 负样本 24
本轮训练: 正样本 78 (54.17%), 负样本 66 (45.83%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 0.6692
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.7354
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.5646
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 0.5840
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.6769
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8470, AUPRC=0.7111
当前学习率: 0.000200
保存最佳模型（轮次 14）到 result/DrugBAN3D_balanced_augment_20250610_145602/best_model.pth
Epoch 14/100 - 训练损失: 0.7639 - 验证AUROC: 0.8470 - 验证AUPRC: 0.7111
批次 0: 正样本 23, 负样本 25
批次 100: 正样本 29, 负样本 19
批次 200: 正样本 22, 负样本 26
本轮训练: 正样本 74 (51.39%), 负样本 70 (48.61%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 0.7818
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.7734
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.5151
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 0.5743
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.4961
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8480, AUPRC=0.7360
当前学习率: 0.000200
保存最佳模型（轮次 15）到 result/DrugBAN3D_balanced_augment_20250610_145602/best_model.pth
Epoch 15/100 - 训练损失: 0.7134 - 验证AUROC: 0.8480 - 验证AUPRC: 0.7360
批次 0: 正样本 28, 负样本 20
批次 100: 正样本 25, 负样本 23
批次 200: 正样本 19, 负样本 29
本轮训练: 正样本 72 (50.00%), 负样本 72 (50.00%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 0.9750
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 1.1353
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.7289
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 0.7989
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.6757
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8493, AUPRC=0.7247
当前学习率: 0.000200
保存最佳模型（轮次 16）到 result/DrugBAN3D_balanced_augment_20250610_145602/best_model.pth
Epoch 16/100 - 训练损失: 0.6943 - 验证AUROC: 0.8493 - 验证AUPRC: 0.7247
批次 0: 正样本 20, 负样本 28
批次 100: 正样本 25, 负样本 23
批次 200: 正样本 23, 负样本 25
本轮训练: 正样本 68 (47.22%), 负样本 76 (52.78%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 0.7238
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.8877
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.6562
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 0.5088
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.5414
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8498, AUPRC=0.7225
当前学习率: 0.000200
保存最佳模型（轮次 17）到 result/DrugBAN3D_balanced_augment_20250610_145602/best_model.pth
Epoch 17/100 - 训练损失: 0.6203 - 验证AUROC: 0.8498 - 验证AUPRC: 0.7225
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 25, 负样本 23
批次 200: 正样本 17, 负样本 31
本轮训练: 正样本 60 (41.67%), 负样本 84 (58.33%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 0.7851
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.5838
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.4929
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 0.4911
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.4552
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8583, AUPRC=0.7499
当前学习率: 0.000200
保存最佳模型（轮次 18）到 result/DrugBAN3D_balanced_augment_20250610_145602/best_model.pth
Epoch 18/100 - 训练损失: 0.6333 - 验证AUROC: 0.8583 - 验证AUPRC: 0.7499
批次 0: 正样本 25, 负样本 23
批次 100: 正样本 22, 负样本 26
批次 200: 正样本 22, 负样本 26
本轮训练: 正样本 69 (47.92%), 负样本 75 (52.08%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 0.7457
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 1.0809
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.5324
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 0.8167
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.5513
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8504, AUPRC=0.7379
当前学习率: 0.000200
Epoch 19/100 - 训练损失: 0.5474 - 验证AUROC: 0.8504 - 验证AUPRC: 0.7379
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 22, 负样本 26
批次 200: 正样本 16, 负样本 32
本轮训练: 正样本 56 (38.89%), 负样本 88 (61.11%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 0.5607
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.8135
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.4243
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 0.5575
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.5277
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8687, AUPRC=0.7694
当前学习率: 0.000200
保存最佳模型（轮次 20）到 result/DrugBAN3D_balanced_augment_20250610_145602/best_model.pth
Epoch 20/100 - 训练损失: 0.5873 - 验证AUROC: 0.8687 - 验证AUPRC: 0.7694
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 18, 负样本 30
批次 200: 正样本 26, 负样本 22
本轮训练: 正样本 62 (43.06%), 负样本 82 (56.94%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 0.9705
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.8779
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.7888
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 0.7118
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.5143
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8701, AUPRC=0.7684
当前学习率: 0.000200
保存最佳模型（轮次 21）到 result/DrugBAN3D_balanced_augment_20250610_145602/best_model.pth
Epoch 21/100 - 训练损失: 0.5424 - 验证AUROC: 0.8701 - 验证AUPRC: 0.7684
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 28, 负样本 20
批次 200: 正样本 24, 负样本 24
本轮训练: 正样本 70 (48.61%), 负样本 74 (51.39%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 1.2436
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 1.0748
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.7731
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 0.7240
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.6957
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8566, AUPRC=0.7466
当前学习率: 0.000200
Epoch 22/100 - 训练损失: 0.5422 - 验证AUROC: 0.8566 - 验证AUPRC: 0.7466
批次 0: 正样本 20, 负样本 28
批次 100: 正样本 29, 负样本 19
批次 200: 正样本 19, 负样本 29
本轮训练: 正样本 68 (47.22%), 负样本 76 (52.78%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 1.0107
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 1.0134
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.5953
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 0.5303
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.6029
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8734, AUPRC=0.7738
当前学习率: 0.000200
保存最佳模型（轮次 23）到 result/DrugBAN3D_balanced_augment_20250610_145602/best_model.pth
Epoch 23/100 - 训练损失: 0.4943 - 验证AUROC: 0.8734 - 验证AUPRC: 0.7738
批次 0: 正样本 23, 负样本 25
批次 100: 正样本 20, 负样本 28
批次 200: 正样本 25, 负样本 23
本轮训练: 正样本 68 (47.22%), 负样本 76 (52.78%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 0.6936
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.7294
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.7691
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 1.0118
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.6574
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8712, AUPRC=0.7861
当前学习率: 0.000200
Epoch 24/100 - 训练损失: 0.4965 - 验证AUROC: 0.8712 - 验证AUPRC: 0.7861
批次 0: 正样本 22, 负样本 26
批次 100: 正样本 18, 负样本 30
批次 200: 正样本 22, 负样本 26
本轮训练: 正样本 62 (43.06%), 负样本 82 (56.94%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 0.9642
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.8935
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.7598
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 0.7700
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.6582
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8744, AUPRC=0.7856
当前学习率: 0.000200
保存最佳模型（轮次 25）到 result/DrugBAN3D_balanced_augment_20250610_145602/best_model.pth
Epoch 25/100 - 训练损失: 0.5009 - 验证AUROC: 0.8744 - 验证AUPRC: 0.7856
批次 0: 正样本 17, 负样本 31
批次 100: 正样本 26, 负样本 22
批次 200: 正样本 24, 负样本 24
本轮训练: 正样本 67 (46.53%), 负样本 77 (53.47%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 0.7929
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.5934
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.7337
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 0.6996
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.6750
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8680, AUPRC=0.7760
当前学习率: 0.000200
Epoch 26/100 - 训练损失: 0.4603 - 验证AUROC: 0.8680 - 验证AUPRC: 0.7760
批次 0: 正样本 16, 负样本 32
批次 100: 正样本 19, 负样本 29
批次 200: 正样本 19, 负样本 29
本轮训练: 正样本 54 (37.50%), 负样本 90 (62.50%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 0.6428
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.6727
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.6105
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 0.9338
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.6139
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8745, AUPRC=0.7703
当前学习率: 0.000200
保存最佳模型（轮次 27）到 result/DrugBAN3D_balanced_augment_20250610_145602/best_model.pth
Epoch 27/100 - 训练损失: 0.4957 - 验证AUROC: 0.8745 - 验证AUPRC: 0.7703
批次 0: 正样本 19, 负样本 29
批次 100: 正样本 22, 负样本 26
批次 200: 正样本 23, 负样本 25
本轮训练: 正样本 64 (44.44%), 负样本 80 (55.56%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 1.3472
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 2.6421
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.6174
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 0.6860
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.7102
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8706, AUPRC=0.7590
当前学习率: 0.000200
Epoch 28/100 - 训练损失: 0.4556 - 验证AUROC: 0.8706 - 验证AUPRC: 0.7590
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 23, 负样本 25
批次 200: 正样本 26, 负样本 22
本轮训练: 正样本 67 (46.53%), 负样本 77 (53.47%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 1.1151
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.6640
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.8090
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 0.6994
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.7488
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8810, AUPRC=0.7878
当前学习率: 0.000200
保存最佳模型（轮次 29）到 result/DrugBAN3D_balanced_augment_20250610_145602/best_model.pth
Epoch 29/100 - 训练损失: 0.4490 - 验证AUROC: 0.8810 - 验证AUPRC: 0.7878
批次 0: 正样本 19, 负样本 29
批次 100: 正样本 23, 负样本 25
批次 200: 正样本 34, 负样本 14
本轮训练: 正样本 76 (52.78%), 负样本 68 (47.22%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 0.7925
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.8320
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.7556
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 0.7725
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.7372
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8761, AUPRC=0.7780
当前学习率: 0.000200
Epoch 30/100 - 训练损失: 0.4492 - 验证AUROC: 0.8761 - 验证AUPRC: 0.7780
批次 0: 正样本 20, 负样本 28
批次 100: 正样本 24, 负样本 24
批次 200: 正样本 19, 负样本 29
本轮训练: 正样本 63 (43.75%), 负样本 81 (56.25%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 2.2118
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.8343
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 1.0258
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 1.6619
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 1.0568
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8586, AUPRC=0.7478
当前学习率: 0.000200
Epoch 31/100 - 训练损失: 0.4500 - 验证AUROC: 0.8586 - 验证AUPRC: 0.7478
批次 0: 正样本 22, 负样本 26
批次 100: 正样本 27, 负样本 21
批次 200: 正样本 23, 负样本 25
本轮训练: 正样本 72 (50.00%), 负样本 72 (50.00%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 2.9052
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.9008
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.9386
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 1.2122
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.7839
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8735, AUPRC=0.7604
当前学习率: 0.000200
Epoch 32/100 - 训练损失: 0.4385 - 验证AUROC: 0.8735 - 验证AUPRC: 0.7604
批次 0: 正样本 29, 负样本 19
批次 100: 正样本 22, 负样本 26
批次 200: 正样本 25, 负样本 23
本轮训练: 正样本 76 (52.78%), 负样本 68 (47.22%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 2.3220
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 1.4777
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.7719
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 0.9629
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.8664
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8688, AUPRC=0.7680
当前学习率: 0.000200
Epoch 33/100 - 训练损失: 0.4236 - 验证AUROC: 0.8688 - 验证AUPRC: 0.7680
批次 0: 正样本 25, 负样本 23
批次 100: 正样本 20, 负样本 28
批次 200: 正样本 23, 负样本 25
本轮训练: 正样本 68 (47.22%), 负样本 76 (52.78%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 0.7519
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.7866
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.8070
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 0.8707
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.8404
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8905, AUPRC=0.7918
当前学习率: 0.000200
保存最佳模型（轮次 34）到 result/DrugBAN3D_balanced_augment_20250610_145602/best_model.pth
Epoch 34/100 - 训练损失: 0.5111 - 验证AUROC: 0.8905 - 验证AUPRC: 0.7918
批次 0: 正样本 28, 负样本 20
批次 100: 正样本 20, 负样本 28
批次 200: 正样本 27, 负样本 21
本轮训练: 正样本 75 (52.08%), 负样本 69 (47.92%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 1.8078
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 1.1624
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.9580
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 1.8231
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 1.0764
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8701, AUPRC=0.7813
当前学习率: 0.000200
Epoch 35/100 - 训练损失: 0.4407 - 验证AUROC: 0.8701 - 验证AUPRC: 0.7813
批次 0: 正样本 21, 负样本 27
批次 100: 正样本 18, 负样本 30
批次 200: 正样本 27, 负样本 21
本轮训练: 正样本 66 (45.83%), 负样本 78 (54.17%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 1.2516
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.8964
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.9042
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 2.5107
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 1.1291
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8622, AUPRC=0.7530
当前学习率: 0.000200
Epoch 36/100 - 训练损失: 0.4588 - 验证AUROC: 0.8622 - 验证AUPRC: 0.7530
批次 0: 正样本 23, 负样本 25
批次 100: 正样本 24, 负样本 24
批次 200: 正样本 24, 负样本 24
本轮训练: 正样本 71 (49.31%), 负样本 73 (50.69%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 2.1422
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.8588
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.8550
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 0.9023
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.8342
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8653, AUPRC=0.7672
当前学习率: 0.000200
Epoch 37/100 - 训练损失: 0.4533 - 验证AUROC: 0.8653 - 验证AUPRC: 0.7672
批次 0: 正样本 21, 负样本 27
批次 100: 正样本 28, 负样本 20
批次 200: 正样本 27, 负样本 21
本轮训练: 正样本 76 (52.78%), 负样本 68 (47.22%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 0.7198
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.9894
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.6858
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 1.1922
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.9100
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8580, AUPRC=0.7406
当前学习率: 0.000200
Epoch 38/100 - 训练损失: 0.4532 - 验证AUROC: 0.8580 - 验证AUPRC: 0.7406
批次 0: 正样本 27, 负样本 21
批次 100: 正样本 24, 负样本 24
批次 200: 正样本 18, 负样本 30
本轮训练: 正样本 69 (47.92%), 负样本 75 (52.08%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 1.5948
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 2.7328
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.8354
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 1.2468
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 1.3064
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8553, AUPRC=0.7485
Epoch 00039: reducing learning rate of group 0 to 1.0000e-04.
当前学习率: 0.000100
Epoch 39/100 - 训练损失: 0.4339 - 验证AUROC: 0.8553 - 验证AUPRC: 0.7485
批次 0: 正样本 24, 负样本 24
批次 100: 正样本 24, 负样本 24
批次 200: 正样本 23, 负样本 25
本轮训练: 正样本 71 (49.31%), 负样本 73 (50.69%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 1.2297
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.9350
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.8583
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 1.3684
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 1.0069
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8839, AUPRC=0.7828
当前学习率: 0.000100
Epoch 40/100 - 训练损失: 0.3895 - 验证AUROC: 0.8839 - 验证AUPRC: 0.7828
批次 0: 正样本 21, 负样本 27
批次 100: 正样本 20, 负样本 28
批次 200: 正样本 20, 负样本 28
本轮训练: 正样本 61 (42.36%), 负样本 83 (57.64%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 2.7940
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 2.9779
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.9180
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 1.8756
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.9016
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8827, AUPRC=0.7705
当前学习率: 0.000100
Epoch 41/100 - 训练损失: 0.3901 - 验证AUROC: 0.8827 - 验证AUPRC: 0.7705
批次 0: 正样本 23, 负样本 25
批次 100: 正样本 24, 负样本 24
批次 200: 正样本 18, 负样本 30
本轮训练: 正样本 65 (45.14%), 负样本 79 (54.86%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 1.4795
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 1.1137
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.9111
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 1.4094
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.9341
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8949, AUPRC=0.8026
当前学习率: 0.000100
保存最佳模型（轮次 42）到 result/DrugBAN3D_balanced_augment_20250610_145602/best_model.pth
Epoch 42/100 - 训练损失: 0.3707 - 验证AUROC: 0.8949 - 验证AUPRC: 0.8026
批次 0: 正样本 23, 负样本 25
批次 100: 正样本 23, 负样本 25
批次 200: 正样本 22, 负样本 26
本轮训练: 正样本 68 (47.22%), 负样本 76 (52.78%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 4.2167
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 1.1422
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 1.0969
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 2.0423
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.9763
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8837, AUPRC=0.7848
当前学习率: 0.000100
Epoch 43/100 - 训练损失: 0.3760 - 验证AUROC: 0.8837 - 验证AUPRC: 0.7848
批次 0: 正样本 24, 负样本 24
批次 100: 正样本 21, 负样本 27
批次 200: 正样本 21, 负样本 27
本轮训练: 正样本 66 (45.83%), 负样本 78 (54.17%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 2.2705
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.9774
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.9720
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 1.2826
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.9261
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8808, AUPRC=0.7809
当前学习率: 0.000100
Epoch 44/100 - 训练损失: 0.3691 - 验证AUROC: 0.8808 - 验证AUPRC: 0.7809
批次 0: 正样本 24, 负样本 24
批次 100: 正样本 20, 负样本 28
批次 200: 正样本 25, 负样本 23
本轮训练: 正样本 69 (47.92%), 负样本 75 (52.08%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 1.2887
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 1.0709
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.9420
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 1.2346
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.8215
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8886, AUPRC=0.7830
当前学习率: 0.000100
Epoch 45/100 - 训练损失: 0.4006 - 验证AUROC: 0.8886 - 验证AUPRC: 0.7830
批次 0: 正样本 24, 负样本 24
批次 100: 正样本 26, 负样本 22
批次 200: 正样本 23, 负样本 25
本轮训练: 正样本 73 (50.69%), 负样本 71 (49.31%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 1.3506
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 2.9137
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 1.1080
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 1.4377
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.9521
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8959, AUPRC=0.7985
当前学习率: 0.000100
保存最佳模型（轮次 46）到 result/DrugBAN3D_balanced_augment_20250610_145602/best_model.pth
Epoch 46/100 - 训练损失: 0.3713 - 验证AUROC: 0.8959 - 验证AUPRC: 0.7985
批次 0: 正样本 21, 负样本 27
批次 100: 正样本 20, 负样本 28
批次 200: 正样本 26, 负样本 22
本轮训练: 正样本 67 (46.53%), 负样本 77 (53.47%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 3.6827
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 2.9781
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.8331
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 1.3272
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.8875
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8432, AUPRC=0.7281
当前学习率: 0.000100
Epoch 47/100 - 训练损失: 0.4044 - 验证AUROC: 0.8432 - 验证AUPRC: 0.7281
批次 0: 正样本 23, 负样本 25
批次 100: 正样本 24, 负样本 24
批次 200: 正样本 24, 负样本 24
本轮训练: 正样本 71 (49.31%), 负样本 73 (50.69%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 3.0705
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 3.0201
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 1.1808
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 1.5238
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 1.3014
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8728, AUPRC=0.7396
当前学习率: 0.000100
Epoch 48/100 - 训练损失: 0.4028 - 验证AUROC: 0.8728 - 验证AUPRC: 0.7396
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 26, 负样本 22
批次 200: 正样本 28, 负样本 20
本轮训练: 正样本 72 (50.00%), 负样本 72 (50.00%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 4.2382
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.8569
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.8937
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 1.8670
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 1.2300
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8390, AUPRC=0.7002
当前学习率: 0.000100
Epoch 49/100 - 训练损失: 0.4339 - 验证AUROC: 0.8390 - 验证AUPRC: 0.7002
批次 0: 正样本 25, 负样本 23
批次 100: 正样本 26, 负样本 22
批次 200: 正样本 23, 负样本 25
本轮训练: 正样本 74 (51.39%), 负样本 70 (48.61%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 3.1462
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 1.0836
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.8708
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 1.2752
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.8160
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8836, AUPRC=0.7682
当前学习率: 0.000100
Epoch 50/100 - 训练损失: 0.4217 - 验证AUROC: 0.8836 - 验证AUPRC: 0.7682
批次 0: 正样本 29, 负样本 19
批次 100: 正样本 15, 负样本 33
批次 200: 正样本 20, 负样本 28
本轮训练: 正样本 64 (44.44%), 负样本 80 (55.56%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 1.0254
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 1.0043
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.7808
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 1.5570
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.7437
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8720, AUPRC=0.7590
Epoch 00051: reducing learning rate of group 0 to 5.0000e-05.
当前学习率: 0.000050
Epoch 51/100 - 训练损失: 0.4105 - 验证AUROC: 0.8720 - 验证AUPRC: 0.7590
批次 0: 正样本 22, 负样本 26
批次 100: 正样本 23, 负样本 25
批次 200: 正样本 25, 负样本 23
本轮训练: 正样本 70 (48.61%), 负样本 74 (51.39%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 1.9011
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.7778
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.8194
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 1.0794
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.7489
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8789, AUPRC=0.7812
当前学习率: 0.000050
Epoch 52/100 - 训练损失: 0.3805 - 验证AUROC: 0.8789 - 验证AUPRC: 0.7812
批次 0: 正样本 22, 负样本 26
批次 100: 正样本 27, 负样本 21
批次 200: 正样本 23, 负样本 25
本轮训练: 正样本 72 (50.00%), 负样本 72 (50.00%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 3.3414
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.8174
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.8623
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 1.2682
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.7786
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8796, AUPRC=0.7769
当前学习率: 0.000050
Epoch 53/100 - 训练损失: 0.3669 - 验证AUROC: 0.8796 - 验证AUPRC: 0.7769
批次 0: 正样本 20, 负样本 28
批次 100: 正样本 23, 负样本 25
批次 200: 正样本 22, 负样本 26
本轮训练: 正样本 65 (45.14%), 负样本 79 (54.86%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 1.3733
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 1.2434
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.8748
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 1.5172
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 1.0416
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8881, AUPRC=0.7775
当前学习率: 0.000050
Epoch 54/100 - 训练损失: 0.3779 - 验证AUROC: 0.8881 - 验证AUPRC: 0.7775
批次 0: 正样本 21, 负样本 27
批次 100: 正样本 20, 负样本 28
批次 200: 正样本 24, 负样本 24
本轮训练: 正样本 65 (45.14%), 负样本 79 (54.86%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 1.2194
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 1.2337
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 1.1005
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 1.3547
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.9505
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8846, AUPRC=0.7928
当前学习率: 0.000050
Epoch 55/100 - 训练损失: 0.3619 - 验证AUROC: 0.8846 - 验证AUPRC: 0.7928
批次 0: 正样本 24, 负样本 24
批次 100: 正样本 27, 负样本 21
批次 200: 正样本 31, 负样本 17
本轮训练: 正样本 82 (56.94%), 负样本 62 (43.06%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 1.8679
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.9597
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 1.4675
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 1.1793
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.6895
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8704, AUPRC=0.7530
Epoch 00056: reducing learning rate of group 0 to 2.5000e-05.
当前学习率: 0.000025
Epoch 56/100 - 训练损失: 0.3641 - 验证AUROC: 0.8704 - 验证AUPRC: 0.7530
批次 0: 正样本 26, 负样本 22
批次 100: 正样本 20, 负样本 28
批次 200: 正样本 23, 负样本 25
本轮训练: 正样本 69 (47.92%), 负样本 75 (52.08%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 1.4513
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 1.1649
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 1.0712
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 1.2927
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.7747
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8929, AUPRC=0.8029
当前学习率: 0.000025
Epoch 57/100 - 训练损失: 0.3560 - 验证AUROC: 0.8929 - 验证AUPRC: 0.8029
批次 0: 正样本 21, 负样本 27
批次 100: 正样本 17, 负样本 31
批次 200: 正样本 23, 负样本 25
本轮训练: 正样本 61 (42.36%), 负样本 83 (57.64%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 1.7507
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 1.1266
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 1.0291
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 1.2930
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.8312
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8941, AUPRC=0.8046
当前学习率: 0.000025
Epoch 58/100 - 训练损失: 0.3304 - 验证AUROC: 0.8941 - 验证AUPRC: 0.8046
批次 0: 正样本 20, 负样本 28
批次 100: 正样本 25, 负样本 23
批次 200: 正样本 17, 负样本 31
本轮训练: 正样本 62 (43.06%), 负样本 82 (56.94%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 1.3144
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 1.0207
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 1.0144
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 1.3426
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.8422
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8869, AUPRC=0.7967
当前学习率: 0.000025
Epoch 59/100 - 训练损失: 0.3539 - 验证AUROC: 0.8869 - 验证AUPRC: 0.7967
批次 0: 正样本 20, 负样本 28
批次 100: 正样本 19, 负样本 29
批次 200: 正样本 18, 负样本 30
本轮训练: 正样本 57 (39.58%), 负样本 87 (60.42%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 1.7992
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 0.8156
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.9010
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 1.3825
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.8775
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8841, AUPRC=0.7862
当前学习率: 0.000025
Epoch 60/100 - 训练损失: 0.3294 - 验证AUROC: 0.8841 - 验证AUPRC: 0.7862
批次 0: 正样本 23, 负样本 25
批次 100: 正样本 27, 负样本 21
批次 200: 正样本 20, 负样本 28
本轮训练: 正样本 70 (48.61%), 负样本 74 (51.39%)
验证数据集大小: 30 批次
开始进行val评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/30, 累计样本数: 48, 批次损失: 1.5560
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/30, 累计样本数: 96, 批次损失: 1.0137
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/30, 累计样本数: 144, 批次损失: 0.9449
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/30, 累计样本数: 192, 批次损失: 1.2056
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/30, 累计样本数: 240, 批次损失: 0.8334
测试完成: 处理了 30/30 批次, 1393 个样本
错误批次数: 0
预测标签统计: 正样本数=449, 负样本数=944
成功计算评估指标: AUROC=0.8896, AUPRC=0.7964
Epoch 00061: reducing learning rate of group 0 to 1.2500e-05.
当前学习率: 0.000013
早停触发！连续15轮验证集性能未提升
测试数据集大小: 22 批次
成功加载最佳模型状态（来自Epoch 46）
开始进行test评估...
批次 0: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 0/22, 累计样本数: 48, 批次损失: 0.7531
批次 1: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 1/22, 累计样本数: 96, 批次损失: 1.1208
批次 2: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 2/22, 累计样本数: 144, 批次损失: 1.1169
批次 3: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 3/22, 累计样本数: 192, 批次损失: 2.0411
批次 4: score形状=torch.Size([48]), labels形状=torch.Size([48])
处理批次 4/22, 累计样本数: 240, 批次损失: 1.6706
测试完成: 处理了 22/22 批次, 1039 个样本
错误批次数: 0
预测标签统计: 正样本数=336, 负样本数=703
成功计算评估指标: AUROC=0.8799, AUPRC=0.7744
最佳阈值: 0.2506, 对应的F1分数: 0.8206
混淆矩阵:
[[525 178]
 [ 43 293]]
详细测试结果: AUROC=0.8799, AUPRC=0.7744, F1=0.8206, 敏感度=0.7468, 特异度=0.8720, 准确率=0.7873, 精确度=0.6221
训练完成！最佳模型来自Epoch 46 - AUROC: 0.8799 - F1: 0.8206
结果已保存到: result/DrugBAN3D_balanced_augment_20250610_145602
训练完成时间: 2025年 06月 10日 星期二 16:36:33 CST
=== 训练总结 ===
训练成功完成！
结果保存在: result/DrugBAN3D_balanced_augment_20250610_145602
配置文件: result/DrugBAN3D_balanced_augment_20250610_145602/config/DrugBAN3D_augmented_20250610_143149.yaml
日志文件: result/DrugBAN3D_balanced_augment_20250610_145602/logs/train.log
保存的模型文件:
  result/DrugBAN3D_balanced_augment_20250610_145602/best_model.pth
