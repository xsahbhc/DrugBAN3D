
================================================================================
DrugBAN 数据增强与标签生成流程
================================================================================
开始时间: 2025-06-09 13:12:08
原始缓存目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/cached_graphs
增强缓存目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250609_131154
原始标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/labels.csv
训练标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/train_stratified.csv
验证标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/val_stratified.csv
测试标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv
增强标签目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_131154
是否增强测试集: 否
================================================================================

步骤1：执行数据增强...
读取标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/labels.csv
总样本数: 10436, 正样本数: 3369 (32.28%), 负样本数: 7067 (67.72%)
使用的增强类型: ['gentle_rotate', 'thermal_vibration']
正样本增强数量: 每个样本1次
负样本增强数量: 每个样本1次

数据增强完成! 耗时: 190.08秒
成功: 10398/10436 (99.64%)
失败记录已保存到 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250609_131154/augment_failures.txt
生成的文件总数: 20796
  原始文件数: 10398
  增强文件数: 10398
增强后样本总数: 20872
  正样本数: 6738 (32.28%)
  负样本数: 14134 (67.72%)
分布保持: 原始32.28% → 增强后32.28% (分布保持)

================================================================================
步骤2：为增强数据生成标签文件...
读取原始标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/labels.csv
原始标签文件包含 10436 条记录
使用预划分的测试集标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv
测试集包含 1044 条记录
测试集正样本率: 32.28%
正在从缓存目录 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250609_131154 中读取增强数据...
找到 20796 个缓存文件
从缓存文件中提取标签信息...
增强标签已保存至 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_131154/augmented_labels.csv，包含 20796 条记录
正样本: 6720 (32.31%), 负样本: 14076 (67.69%)
数据集划分: 训练集 7955 分子, 验证集 1404 分子, 测试集 1044 分子
验证集当前正样本率: 31.41%, 目标正样本率: 32.28%
调整验证集: 从1926个负样本中抽样1850个
调整后验证集正样本率: 32.28%
训练标签已保存至 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_131154/train_augmented.csv，包含 15910 条记录
验证标签已保存至 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_131154/valid_augmented.csv，包含 2732 条记录
测试标签已保存至 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_131154/test_augmented.csv，包含 1044 条记录
训练集: 总样本 15910, 正样本率 32.47%
验证集: 总样本 2732, 正样本率 32.28%
测试集: 总样本 1044, 正样本率 32.28%

================================================================================
数据增强与标签生成完成!
增强后的缓存文件保存在: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250609_131154
增强后的标签文件保存在: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_131154
结束时间: 2025-06-09 13:15:40
================================================================================

=== 详细配置信息 ===
配置文件: result/DrugBAN3D_balanced_augment_20250609_131154/config/DrugBAN3D_augmented_20250609_131154.yaml
训练数据: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_131154/train_augmented.csv
验证数据: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_131154/valid_augmented.csv
测试数据: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv
缓存目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250609_131154
结果目录: result/DrugBAN3D_balanced_augment_20250609_131154

=== 完整配置参数详览 ===
📋 训练参数 (TRAIN):
  TRAIN:
    D_LEARNING_RATE: 0.0004   # 最优判别器学习率（来自最佳实验）
    G_LEARNING_RATE: 0.0002   # 最优生成器学习率（来自最佳实验）
    BATCH_SIZE: 48  # 最佳batch size（来自最佳实验）
    D_STEPS_PER_G_STEP: 1
    RESUME_CHECKPOINT: ""
    EPOCH: 100  # 充足的训练轮数
    GRADIENT_ACCUMULATE_STEPS: 2  # 梯度累积，有效batch size = 48*2 = 96
    GRADIENT_CLIP_NORM: 1.0  # 梯度裁剪阈值（来自最佳实验）
    WEIGHT_DECAY: 0.0004  # 最优权重衰减（来自最佳实验）
    LABEL_SMOOTHING: 0.05  # 标签平滑参数（来自最佳实验）
    POS_WEIGHT: 1.05  # 正样本权重（来自最佳实验）

🏗️ GNN配置:
  GNN:
    HIDDEN_DIM: 384  # 最优GNN隐藏维度
    NUM_LAYERS: 4    # 最优GNN层数
  
  BCN:
    HEADS: 8  # 最优注意力头数量

🔧 解码器配置:
  DECODER:
    IN_DIM: 384
    HIDDEN_DIM: 512  # 最优解码器隐藏维度
    OUT_DIM: 128  # 最优解码器输出维度
    BINARY: 1
    DROPOUT: 0.3  # 最优Dropout率，平衡过拟合和欠拟合
  
  ADAPT:
    LAMBDA: 0.1

📊 损失函数配置:
  USE_BIAS_CORRECTION: True  # 启用偏置校正，提升模型稳定性
  USE_FOCAL_LOSS: True  # 使用焦点损失处理类别不平衡
  FOCAL_LOSS_GAMMA: 1.0  # 最优gamma值，温和的焦点损失
  FOCAL_LOSS_ALPHA: 0.3  # 最优alpha值，平衡正负样本

🌐 3D空间特征配置:
  SPATIAL_3D:
    ENABLE_SPATIAL_FUSION: true      # 启用3D空间感知特征融合 - 重要性能提升
    ENABLE_MULTISCALE: true          # 启用多尺度特征提取 - 捕获不同距离的相互作用
    DISTANCE_SCALES: [2.0, 5.0, 8.0]  # 最优多尺度距离阈值(Å)
    SPATIAL_DROPOUT: 0.1             # 最优空间模块Dropout率
    CROSS_ATTENTION_HEADS: 8         # 最优交叉注意力头数
  
  # 损失函数配置 - 最优设置
  USE_FOCAL_LOSS: True  # 使用焦点损失处理类别不平衡

⚙️ 求解器配置:
  SOLVER:
    MAX_EPOCH: 100  # 充足的训练轮数
    BATCH_SIZE: 48  # 最优batch size（来自最佳实验）
    USE_MIXED_PRECISION: False  # 不使用混合精度训练，保持稳定性
    LR_SCHEDULER: True  # 启用学习率调度器（来自最佳实验）
    LR_SCHEDULER_TYPE: "plateau"  # 最优学习率调度器（来自最佳实验）
    LR_WARMUP_EPOCHS: 4  # 最优学习率预热轮数（来自最佳实验）
    GRADIENT_CLIP_NORM: 1.0  # 梯度裁剪阈值（来自最佳实验）
    SEED: 42  # 固定随机种子保证可重现性
  
  RESULT:

⏹️ 早停配置:
  USE_EARLY_STOPPING: True
  EARLY_STOPPING_PATIENCE: 15  # 最优早停耐心值，避免过早停止

=========================

训练开始时间: 2025年 06月 09日 星期一 13:15:44 CST
使用命令行指定的输出目录: result/DrugBAN3D_balanced_augment_20250609_131154
已保存当前配置到 result/DrugBAN3D_balanced_augment_20250609_131154/config/config_used.yaml
配置文件: result/DrugBAN3D_balanced_augment_20250609_131154/config/DrugBAN3D_augmented_20250609_131154.yaml
输出目录: result/DrugBAN3D_balanced_augment_20250609_131154
运行设备: cuda
数据加载器使用 16 个工作线程
使用分层采样的预划分数据集
数据集: 训练集 15910 样本, 验证集 2732 样本, 测试集 1044 样本
正样本比例: 训练集 32.47%, 验证集 32.28%, 测试集 32.28%
使用增强数据集进行训练...
加载标签文件: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_131154/train_augmented.csv, 包含 15910 条记录
找到 15910/15910 个对应的缓存文件
数据集初始化完成，总样本数: 15910
训练/验证 数据集初始化完成: 15910 个样本
创建数据加载器成功: 预期 332 批次，批次大小 48
加载标签文件: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_131154/valid_augmented.csv, 包含 2732 条记录
找到 2732/2732 个对应的缓存文件
数据集初始化完成，总样本数: 2732
训练/验证 数据集初始化完成: 2732 个样本
创建数据加载器成功: 预期 57 批次，批次大小 48
测试模式: 使用原始测试数据
测试标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv
缓存目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/cached_graphs
测试标签文件包含 1044 条记录
测试集标签分布: 正样本 337 (32.28%), 负样本 707 (67.72%)
读取测试标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv, 包含 1044 条记录
成功创建测试标签映射，包含 2088 个条目
测试模式：从标签文件获取 2088 个复合物ID
测试模式：只处理标签文件中的 2088 个样本
在缓存目录中找到 1039/2088 个测试样本缓存文件
数据集初始化完成，总样本数: 1039
测试 数据集初始化完成: 1039 个样本
创建数据加载器成功: 预期 22 批次，批次大小 48

==================================================
DrugBAN3D初始化 - 偏差校正模块: 启用
Dropout率: 0.3
GNN层数: 4
==================================================

优化器: Adam, 学习率: 0.0002, L2正则化强度: 0.0004
启用标签平滑，参数值: 0.05
启用类别加权，正样本权重: 1.050
启用梯度裁剪，阈值：1.0
使用state_dict保存模型，避免完整对象复制
使用plateau学习率调度器
运行设备: cuda
启用标签平滑，参数值: 0.05
启用类别加权，正样本权重: 1.0499999523162842
使用ReduceLROnPlateau学习率调度器，监控验证集AUROC
开始训练...
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 17, 负样本 31
批次 200: 正样本 13, 负样本 35
批次 300: 正样本 19, 负样本 29
本轮训练: 正样本 67 (34.90%), 负样本 125 (65.10%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 0.9053
处理批次 1/57, 累计样本数: 96, 批次损失: 0.6540
处理批次 2/57, 累计样本数: 144, 批次损失: 0.8437
处理批次 3/57, 累计样本数: 192, 批次损失: 0.7141
处理批次 4/57, 累计样本数: 240, 批次损失: 2.7876
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.6274, AUPRC=0.4468
当前学习率: 0.000200
保存最佳模型（轮次 1）到 result/DrugBAN3D_balanced_augment_20250609_131154/best_model.pth
Epoch 1/100 - 训练损失: 2.1077 - 验证AUROC: 0.6274 - 验证AUPRC: 0.4468
批次 0: 正样本 11, 负样本 37
批次 100: 正样本 20, 负样本 28
批次 200: 正样本 17, 负样本 31
批次 300: 正样本 19, 负样本 29
本轮训练: 正样本 67 (34.90%), 负样本 125 (65.10%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 0.8321
处理批次 1/57, 累计样本数: 96, 批次损失: 0.7758
处理批次 2/57, 累计样本数: 144, 批次损失: 1.0585
处理批次 3/57, 累计样本数: 192, 批次损失: 0.7408
处理批次 4/57, 累计样本数: 240, 批次损失: 2.8418
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.6840, AUPRC=0.4940
当前学习率: 0.000200
保存最佳模型（轮次 2）到 result/DrugBAN3D_balanced_augment_20250609_131154/best_model.pth
Epoch 2/100 - 训练损失: 1.4796 - 验证AUROC: 0.6840 - 验证AUPRC: 0.4940
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 15, 负样本 33
批次 200: 正样本 15, 负样本 33
批次 300: 正样本 18, 负样本 30
本轮训练: 正样本 66 (34.38%), 负样本 126 (65.62%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 0.6927
处理批次 1/57, 累计样本数: 96, 批次损失: 0.6592
处理批次 2/57, 累计样本数: 144, 批次损失: 0.7414
处理批次 3/57, 累计样本数: 192, 批次损失: 0.8979
处理批次 4/57, 累计样本数: 240, 批次损失: 2.7667
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.6937, AUPRC=0.4948
当前学习率: 0.000200
保存最佳模型（轮次 3）到 result/DrugBAN3D_balanced_augment_20250609_131154/best_model.pth
Epoch 3/100 - 训练损失: 1.3987 - 验证AUROC: 0.6937 - 验证AUPRC: 0.4948
批次 0: 正样本 22, 负样本 26
批次 100: 正样本 15, 负样本 33
批次 200: 正样本 22, 负样本 26
批次 300: 正样本 18, 负样本 30
本轮训练: 正样本 77 (40.10%), 负样本 115 (59.90%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 0.6884
处理批次 1/57, 累计样本数: 96, 批次损失: 0.6422
处理批次 2/57, 累计样本数: 144, 批次损失: 0.6012
处理批次 3/57, 累计样本数: 192, 批次损失: 0.7165
处理批次 4/57, 累计样本数: 240, 批次损失: 2.5812
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.7140, AUPRC=0.5190
当前学习率: 0.000200
保存最佳模型（轮次 4）到 result/DrugBAN3D_balanced_augment_20250609_131154/best_model.pth
Epoch 4/100 - 训练损失: 1.1684 - 验证AUROC: 0.7140 - 验证AUPRC: 0.5190
批次 0: 正样本 19, 负样本 29
批次 100: 正样本 13, 负样本 35
批次 200: 正样本 18, 负样本 30
批次 300: 正样本 9, 负样本 39
本轮训练: 正样本 59 (30.73%), 负样本 133 (69.27%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 0.5843
处理批次 1/57, 累计样本数: 96, 批次损失: 0.4844
处理批次 2/57, 累计样本数: 144, 批次损失: 0.5479
处理批次 3/57, 累计样本数: 192, 批次损失: 1.1023
处理批次 4/57, 累计样本数: 240, 批次损失: 3.0733
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.7611, AUPRC=0.5703
当前学习率: 0.000200
保存最佳模型（轮次 5）到 result/DrugBAN3D_balanced_augment_20250609_131154/best_model.pth
Epoch 5/100 - 训练损失: 1.0121 - 验证AUROC: 0.7611 - 验证AUPRC: 0.5703
批次 0: 正样本 25, 负样本 23
批次 100: 正样本 9, 负样本 39
批次 200: 正样本 13, 负样本 35
批次 300: 正样本 22, 负样本 26
本轮训练: 正样本 69 (35.94%), 负样本 123 (64.06%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 0.5787
处理批次 1/57, 累计样本数: 96, 批次损失: 0.5346
处理批次 2/57, 累计样本数: 144, 批次损失: 0.5396
处理批次 3/57, 累计样本数: 192, 批次损失: 0.6614
处理批次 4/57, 累计样本数: 240, 批次损失: 2.6155
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.7507, AUPRC=0.5528
当前学习率: 0.000200
Epoch 6/100 - 训练损失: 0.9667 - 验证AUROC: 0.7507 - 验证AUPRC: 0.5528
批次 0: 正样本 13, 负样本 35
批次 100: 正样本 17, 负样本 31
批次 200: 正样本 13, 负样本 35
批次 300: 正样本 16, 负样本 32
本轮训练: 正样本 59 (30.73%), 负样本 133 (69.27%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 0.7107
处理批次 1/57, 累计样本数: 96, 批次损失: 0.6094
处理批次 2/57, 累计样本数: 144, 批次损失: 0.6743
处理批次 3/57, 累计样本数: 192, 批次损失: 0.6434
处理批次 4/57, 累计样本数: 240, 批次损失: 2.9333
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.7519, AUPRC=0.5667
当前学习率: 0.000200
Epoch 7/100 - 训练损失: 0.8250 - 验证AUROC: 0.7519 - 验证AUPRC: 0.5667
批次 0: 正样本 19, 负样本 29
批次 100: 正样本 15, 负样本 33
批次 200: 正样本 19, 负样本 29
批次 300: 正样本 12, 负样本 36
本轮训练: 正样本 65 (33.85%), 负样本 127 (66.15%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 0.5983
处理批次 1/57, 累计样本数: 96, 批次损失: 0.8607
处理批次 2/57, 累计样本数: 144, 批次损失: 0.5663
处理批次 3/57, 累计样本数: 192, 批次损失: 0.5840
处理批次 4/57, 累计样本数: 240, 批次损失: 0.7728
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.7844, AUPRC=0.6175
当前学习率: 0.000200
保存最佳模型（轮次 8）到 result/DrugBAN3D_balanced_augment_20250609_131154/best_model.pth
Epoch 8/100 - 训练损失: 0.7385 - 验证AUROC: 0.7844 - 验证AUPRC: 0.6175
批次 0: 正样本 22, 负样本 26
批次 100: 正样本 14, 负样本 34
批次 200: 正样本 18, 负样本 30
批次 300: 正样本 18, 负样本 30
本轮训练: 正样本 72 (37.50%), 负样本 120 (62.50%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 0.6372
处理批次 1/57, 累计样本数: 96, 批次损失: 0.5603
处理批次 2/57, 累计样本数: 144, 批次损失: 0.4677
处理批次 3/57, 累计样本数: 192, 批次损失: 0.6149
处理批次 4/57, 累计样本数: 240, 批次损失: 0.8097
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.8078, AUPRC=0.6526
当前学习率: 0.000200
保存最佳模型（轮次 9）到 result/DrugBAN3D_balanced_augment_20250609_131154/best_model.pth
Epoch 9/100 - 训练损失: 0.6059 - 验证AUROC: 0.8078 - 验证AUPRC: 0.6526
批次 0: 正样本 14, 负样本 34
批次 100: 正样本 13, 负样本 35
批次 200: 正样本 20, 负样本 28
批次 300: 正样本 19, 负样本 29
本轮训练: 正样本 66 (34.38%), 负样本 126 (65.62%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 0.5585
处理批次 1/57, 累计样本数: 96, 批次损失: 0.6278
处理批次 2/57, 累计样本数: 144, 批次损失: 0.5693
处理批次 3/57, 累计样本数: 192, 批次损失: 0.7885
处理批次 4/57, 累计样本数: 240, 批次损失: 0.6352
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.8138, AUPRC=0.6757
当前学习率: 0.000200
保存最佳模型（轮次 10）到 result/DrugBAN3D_balanced_augment_20250609_131154/best_model.pth
Epoch 10/100 - 训练损失: 0.5442 - 验证AUROC: 0.8138 - 验证AUPRC: 0.6757
批次 0: 正样本 17, 负样本 31
批次 100: 正样本 19, 负样本 29
批次 200: 正样本 15, 负样本 33
批次 300: 正样本 17, 负样本 31
本轮训练: 正样本 68 (35.42%), 负样本 124 (64.58%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 0.6433
处理批次 1/57, 累计样本数: 96, 批次损失: 0.5704
处理批次 2/57, 累计样本数: 144, 批次损失: 0.4873
处理批次 3/57, 累计样本数: 192, 批次损失: 0.6276
处理批次 4/57, 累计样本数: 240, 批次损失: 0.7341
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.8398, AUPRC=0.6944
当前学习率: 0.000200
保存最佳模型（轮次 11）到 result/DrugBAN3D_balanced_augment_20250609_131154/best_model.pth
Epoch 11/100 - 训练损失: 0.5147 - 验证AUROC: 0.8398 - 验证AUPRC: 0.6944
批次 0: 正样本 19, 负样本 29
批次 100: 正样本 18, 负样本 30
批次 200: 正样本 14, 负样本 34
批次 300: 正样本 13, 负样本 35
本轮训练: 正样本 64 (33.33%), 负样本 128 (66.67%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 0.5462
处理批次 1/57, 累计样本数: 96, 批次损失: 0.6972
处理批次 2/57, 累计样本数: 144, 批次损失: 0.6018
处理批次 3/57, 累计样本数: 192, 批次损失: 0.5764
处理批次 4/57, 累计样本数: 240, 批次损失: 0.5772
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.8426, AUPRC=0.7181
当前学习率: 0.000200
保存最佳模型（轮次 12）到 result/DrugBAN3D_balanced_augment_20250609_131154/best_model.pth
Epoch 12/100 - 训练损失: 0.5003 - 验证AUROC: 0.8426 - 验证AUPRC: 0.7181
批次 0: 正样本 17, 负样本 31
批次 100: 正样本 17, 负样本 31
批次 200: 正样本 14, 负样本 34
批次 300: 正样本 14, 负样本 34
本轮训练: 正样本 62 (32.29%), 负样本 130 (67.71%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 0.6703
处理批次 1/57, 累计样本数: 96, 批次损失: 0.6213
处理批次 2/57, 累计样本数: 144, 批次损失: 0.6442
处理批次 3/57, 累计样本数: 192, 批次损失: 0.5464
处理批次 4/57, 累计样本数: 240, 批次损失: 0.6637
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.8394, AUPRC=0.7315
当前学习率: 0.000200
Epoch 13/100 - 训练损失: 0.4420 - 验证AUROC: 0.8394 - 验证AUPRC: 0.7315
批次 0: 正样本 15, 负样本 33
批次 100: 正样本 19, 负样本 29
批次 200: 正样本 18, 负样本 30
批次 300: 正样本 13, 负样本 35
本轮训练: 正样本 65 (33.85%), 负样本 127 (66.15%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 0.7441
处理批次 1/57, 累计样本数: 96, 批次损失: 0.6787
处理批次 2/57, 累计样本数: 144, 批次损失: 0.6239
处理批次 3/57, 累计样本数: 192, 批次损失: 0.7392
处理批次 4/57, 累计样本数: 240, 批次损失: 0.8975
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.8418, AUPRC=0.7280
当前学习率: 0.000200
Epoch 14/100 - 训练损失: 0.4418 - 验证AUROC: 0.8418 - 验证AUPRC: 0.7280
批次 0: 正样本 9, 负样本 39
批次 100: 正样本 13, 负样本 35
批次 200: 正样本 12, 负样本 36
批次 300: 正样本 13, 负样本 35
本轮训练: 正样本 47 (24.48%), 负样本 145 (75.52%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 0.7674
处理批次 1/57, 累计样本数: 96, 批次损失: 0.7043
处理批次 2/57, 累计样本数: 144, 批次损失: 0.5531
处理批次 3/57, 累计样本数: 192, 批次损失: 0.6010
处理批次 4/57, 累计样本数: 240, 批次损失: 0.7747
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.8457, AUPRC=0.7276
当前学习率: 0.000200
保存最佳模型（轮次 15）到 result/DrugBAN3D_balanced_augment_20250609_131154/best_model.pth
Epoch 15/100 - 训练损失: 0.4243 - 验证AUROC: 0.8457 - 验证AUPRC: 0.7276
批次 0: 正样本 14, 负样本 34
批次 100: 正样本 15, 负样本 33
批次 200: 正样本 20, 负样本 28
批次 300: 正样本 14, 负样本 34
本轮训练: 正样本 63 (32.81%), 负样本 129 (67.19%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 0.5892
处理批次 1/57, 累计样本数: 96, 批次损失: 0.6566
处理批次 2/57, 累计样本数: 144, 批次损失: 0.6012
处理批次 3/57, 累计样本数: 192, 批次损失: 0.6677
处理批次 4/57, 累计样本数: 240, 批次损失: 0.7276
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.8712, AUPRC=0.7649
当前学习率: 0.000200
保存最佳模型（轮次 16）到 result/DrugBAN3D_balanced_augment_20250609_131154/best_model.pth
Epoch 16/100 - 训练损失: 0.4018 - 验证AUROC: 0.8712 - 验证AUPRC: 0.7649
批次 0: 正样本 11, 负样本 37
批次 100: 正样本 14, 负样本 34
批次 200: 正样本 11, 负样本 37
批次 300: 正样本 14, 负样本 34
本轮训练: 正样本 50 (26.04%), 负样本 142 (73.96%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 0.7072
处理批次 1/57, 累计样本数: 96, 批次损失: 0.6915
处理批次 2/57, 累计样本数: 144, 批次损失: 0.6435
处理批次 3/57, 累计样本数: 192, 批次损失: 0.6171
处理批次 4/57, 累计样本数: 240, 批次损失: 0.5801
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.8697, AUPRC=0.7642
当前学习率: 0.000200
Epoch 17/100 - 训练损失: 0.3912 - 验证AUROC: 0.8697 - 验证AUPRC: 0.7642
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 17, 负样本 31
批次 200: 正样本 16, 负样本 32
批次 300: 正样本 22, 负样本 26
本轮训练: 正样本 73 (38.02%), 负样本 119 (61.98%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 0.6853
处理批次 1/57, 累计样本数: 96, 批次损失: 0.6622
处理批次 2/57, 累计样本数: 144, 批次损失: 0.6575
处理批次 3/57, 累计样本数: 192, 批次损失: 0.6280
处理批次 4/57, 累计样本数: 240, 批次损失: 0.6422
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.8789, AUPRC=0.7725
当前学习率: 0.000200
保存最佳模型（轮次 18）到 result/DrugBAN3D_balanced_augment_20250609_131154/best_model.pth
Epoch 18/100 - 训练损失: 0.3893 - 验证AUROC: 0.8789 - 验证AUPRC: 0.7725
批次 0: 正样本 16, 负样本 32
批次 100: 正样本 13, 负样本 35
批次 200: 正样本 17, 负样本 31
批次 300: 正样本 12, 负样本 36
本轮训练: 正样本 58 (30.21%), 负样本 134 (69.79%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 0.8702
处理批次 1/57, 累计样本数: 96, 批次损失: 0.8648
处理批次 2/57, 累计样本数: 144, 批次损失: 0.5210
处理批次 3/57, 累计样本数: 192, 批次损失: 0.5703
处理批次 4/57, 累计样本数: 240, 批次损失: 0.7746
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.8688, AUPRC=0.7617
当前学习率: 0.000200
Epoch 19/100 - 训练损失: 0.3725 - 验证AUROC: 0.8688 - 验证AUPRC: 0.7617
批次 0: 正样本 15, 负样本 33
批次 100: 正样本 13, 负样本 35
批次 200: 正样本 18, 负样本 30
批次 300: 正样本 11, 负样本 37
本轮训练: 正样本 57 (29.69%), 负样本 135 (70.31%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 0.9012
处理批次 1/57, 累计样本数: 96, 批次损失: 0.9832
处理批次 2/57, 累计样本数: 144, 批次损失: 0.7087
处理批次 3/57, 累计样本数: 192, 批次损失: 0.9935
处理批次 4/57, 累计样本数: 240, 批次损失: 0.7016
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.8693, AUPRC=0.7635
当前学习率: 0.000200
Epoch 20/100 - 训练损失: 0.3633 - 验证AUROC: 0.8693 - 验证AUPRC: 0.7635
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 13, 负样本 35
批次 200: 正样本 14, 负样本 34
批次 300: 正样本 19, 负样本 29
本轮训练: 正样本 64 (33.33%), 负样本 128 (66.67%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 1.2828
处理批次 1/57, 累计样本数: 96, 批次损失: 0.9262
处理批次 2/57, 累计样本数: 144, 批次损失: 0.7350
处理批次 3/57, 累计样本数: 192, 批次损失: 1.0761
处理批次 4/57, 累计样本数: 240, 批次损失: 0.8344
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.8744, AUPRC=0.7770
当前学习率: 0.000200
Epoch 21/100 - 训练损失: 0.3849 - 验证AUROC: 0.8744 - 验证AUPRC: 0.7770
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 13, 负样本 35
批次 200: 正样本 24, 负样本 24
批次 300: 正样本 16, 负样本 32
本轮训练: 正样本 71 (36.98%), 负样本 121 (63.02%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 1.8970
处理批次 1/57, 累计样本数: 96, 批次损失: 2.1175
处理批次 2/57, 累计样本数: 144, 批次损失: 0.7540
处理批次 3/57, 累计样本数: 192, 批次损失: 1.5861
处理批次 4/57, 累计样本数: 240, 批次损失: 0.8955
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.8510, AUPRC=0.7531
当前学习率: 0.000200
Epoch 22/100 - 训练损失: 0.3553 - 验证AUROC: 0.8510 - 验证AUPRC: 0.7531
批次 0: 正样本 20, 负样本 28
批次 100: 正样本 16, 负样本 32
批次 200: 正样本 16, 负样本 32
批次 300: 正样本 17, 负样本 31
本轮训练: 正样本 69 (35.94%), 负样本 123 (64.06%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 0.8357
处理批次 1/57, 累计样本数: 96, 批次损失: 0.7658
处理批次 2/57, 累计样本数: 144, 批次损失: 0.6229
处理批次 3/57, 累计样本数: 192, 批次损失: 0.9776
处理批次 4/57, 累计样本数: 240, 批次损失: 1.1728
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.8611, AUPRC=0.7429
Epoch 00023: reducing learning rate of group 0 to 1.0000e-04.
当前学习率: 0.000100
Epoch 23/100 - 训练损失: 0.3639 - 验证AUROC: 0.8611 - 验证AUPRC: 0.7429
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 20, 负样本 28
批次 200: 正样本 22, 负样本 26
批次 300: 正样本 16, 负样本 32
本轮训练: 正样本 76 (39.58%), 负样本 116 (60.42%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 0.8854
处理批次 1/57, 累计样本数: 96, 批次损失: 0.9934
处理批次 2/57, 累计样本数: 144, 批次损失: 0.8650
处理批次 3/57, 累计样本数: 192, 批次损失: 0.7673
处理批次 4/57, 累计样本数: 240, 批次损失: 0.8421
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.8847, AUPRC=0.7929
当前学习率: 0.000100
保存最佳模型（轮次 24）到 result/DrugBAN3D_balanced_augment_20250609_131154/best_model.pth
Epoch 24/100 - 训练损失: 0.3217 - 验证AUROC: 0.8847 - 验证AUPRC: 0.7929
批次 0: 正样本 19, 负样本 29
批次 100: 正样本 13, 负样本 35
批次 200: 正样本 17, 负样本 31
批次 300: 正样本 16, 负样本 32
本轮训练: 正样本 65 (33.85%), 负样本 127 (66.15%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 1.1045
处理批次 1/57, 累计样本数: 96, 批次损失: 1.1964
处理批次 2/57, 累计样本数: 144, 批次损失: 0.8230
处理批次 3/57, 累计样本数: 192, 批次损失: 0.8506
处理批次 4/57, 累计样本数: 240, 批次损失: 0.8064
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.8837, AUPRC=0.7995
当前学习率: 0.000100
Epoch 25/100 - 训练损失: 0.2822 - 验证AUROC: 0.8837 - 验证AUPRC: 0.7995
批次 0: 正样本 13, 负样本 35
批次 100: 正样本 16, 负样本 32
批次 200: 正样本 10, 负样本 38
批次 300: 正样本 13, 负样本 35
本轮训练: 正样本 52 (27.08%), 负样本 140 (72.92%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 0.7831
处理批次 1/57, 累计样本数: 96, 批次损失: 1.0346
处理批次 2/57, 累计样本数: 144, 批次损失: 0.7366
处理批次 3/57, 累计样本数: 192, 批次损失: 0.8330
处理批次 4/57, 累计样本数: 240, 批次损失: 0.8393
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.8853, AUPRC=0.8010
当前学习率: 0.000100
保存最佳模型（轮次 26）到 result/DrugBAN3D_balanced_augment_20250609_131154/best_model.pth
Epoch 26/100 - 训练损失: 0.2830 - 验证AUROC: 0.8853 - 验证AUPRC: 0.8010
批次 0: 正样本 15, 负样本 33
批次 100: 正样本 17, 负样本 31
批次 200: 正样本 22, 负样本 26
批次 300: 正样本 12, 负样本 36
本轮训练: 正样本 66 (34.38%), 负样本 126 (65.62%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 0.9754
处理批次 1/57, 累计样本数: 96, 批次损失: 1.0681
处理批次 2/57, 累计样本数: 144, 批次损失: 0.6870
处理批次 3/57, 累计样本数: 192, 批次损失: 0.7373
处理批次 4/57, 累计样本数: 240, 批次损失: 0.6908
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.8947, AUPRC=0.8136
当前学习率: 0.000100
保存最佳模型（轮次 27）到 result/DrugBAN3D_balanced_augment_20250609_131154/best_model.pth
Epoch 27/100 - 训练损失: 0.2797 - 验证AUROC: 0.8947 - 验证AUPRC: 0.8136
批次 0: 正样本 19, 负样本 29
批次 100: 正样本 18, 负样本 30
批次 200: 正样本 19, 负样本 29
批次 300: 正样本 16, 负样本 32
本轮训练: 正样本 72 (37.50%), 负样本 120 (62.50%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 1.5017
处理批次 1/57, 累计样本数: 96, 批次损失: 1.7335
处理批次 2/57, 累计样本数: 144, 批次损失: 0.7387
处理批次 3/57, 累计样本数: 192, 批次损失: 1.3689
处理批次 4/57, 累计样本数: 240, 批次损失: 0.9172
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.8779, AUPRC=0.7944
当前学习率: 0.000100
Epoch 28/100 - 训练损失: 0.2781 - 验证AUROC: 0.8779 - 验证AUPRC: 0.7944
批次 0: 正样本 14, 负样本 34
批次 100: 正样本 13, 负样本 35
批次 200: 正样本 12, 负样本 36
批次 300: 正样本 13, 负样本 35
本轮训练: 正样本 52 (27.08%), 负样本 140 (72.92%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 2.1486
处理批次 1/57, 累计样本数: 96, 批次损失: 1.3819
处理批次 2/57, 累计样本数: 144, 批次损失: 0.7900
处理批次 3/57, 累计样本数: 192, 批次损失: 1.5404
处理批次 4/57, 累计样本数: 240, 批次损失: 1.0068
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.8808, AUPRC=0.7891
当前学习率: 0.000100
Epoch 29/100 - 训练损失: 0.2650 - 验证AUROC: 0.8808 - 验证AUPRC: 0.7891
批次 0: 正样本 17, 负样本 31
批次 100: 正样本 17, 负样本 31
批次 200: 正样本 15, 负样本 33
批次 300: 正样本 15, 负样本 33
本轮训练: 正样本 64 (33.33%), 负样本 128 (66.67%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 1.8713
处理批次 1/57, 累计样本数: 96, 批次损失: 1.7231
处理批次 2/57, 累计样本数: 144, 批次损失: 0.9049
处理批次 3/57, 累计样本数: 192, 批次损失: 1.2969
处理批次 4/57, 累计样本数: 240, 批次损失: 1.4434
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.8784, AUPRC=0.7977
当前学习率: 0.000100
Epoch 30/100 - 训练损失: 0.2857 - 验证AUROC: 0.8784 - 验证AUPRC: 0.7977
批次 0: 正样本 14, 负样本 34
批次 100: 正样本 15, 负样本 33
批次 200: 正样本 16, 负样本 32
批次 300: 正样本 19, 负样本 29
本轮训练: 正样本 64 (33.33%), 负样本 128 (66.67%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 1.6072
处理批次 1/57, 累计样本数: 96, 批次损失: 0.9487
处理批次 2/57, 累计样本数: 144, 批次损失: 0.7613
处理批次 3/57, 累计样本数: 192, 批次损失: 1.0251
处理批次 4/57, 累计样本数: 240, 批次损失: 0.8917
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.8856, AUPRC=0.7971
当前学习率: 0.000100
Epoch 31/100 - 训练损失: 0.2628 - 验证AUROC: 0.8856 - 验证AUPRC: 0.7971
批次 0: 正样本 20, 负样本 28
批次 100: 正样本 23, 负样本 25
批次 200: 正样本 15, 负样本 33
批次 300: 正样本 16, 负样本 32
本轮训练: 正样本 74 (38.54%), 负样本 118 (61.46%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 2.2108
处理批次 1/57, 累计样本数: 96, 批次损失: 0.8777
处理批次 2/57, 累计样本数: 144, 批次损失: 0.9485
处理批次 3/57, 累计样本数: 192, 批次损失: 1.3959
处理批次 4/57, 累计样本数: 240, 批次损失: 1.1089
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.8704, AUPRC=0.7746
Epoch 00032: reducing learning rate of group 0 to 5.0000e-05.
当前学习率: 0.000050
Epoch 32/100 - 训练损失: 0.2701 - 验证AUROC: 0.8704 - 验证AUPRC: 0.7746
批次 0: 正样本 11, 负样本 37
批次 100: 正样本 17, 负样本 31
批次 200: 正样本 14, 负样本 34
批次 300: 正样本 15, 负样本 33
本轮训练: 正样本 57 (29.69%), 负样本 135 (70.31%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 1.6170
处理批次 1/57, 累计样本数: 96, 批次损失: 0.9352
处理批次 2/57, 累计样本数: 144, 批次损失: 0.7747
处理批次 3/57, 累计样本数: 192, 批次损失: 1.2668
处理批次 4/57, 累计样本数: 240, 批次损失: 1.1440
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.8855, AUPRC=0.8045
当前学习率: 0.000050
Epoch 33/100 - 训练损失: 0.2394 - 验证AUROC: 0.8855 - 验证AUPRC: 0.8045
批次 0: 正样本 20, 负样本 28
批次 100: 正样本 17, 负样本 31
批次 200: 正样本 20, 负样本 28
批次 300: 正样本 16, 负样本 32
本轮训练: 正样本 73 (38.02%), 负样本 119 (61.98%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 1.9579
处理批次 1/57, 累计样本数: 96, 批次损失: 1.0216
处理批次 2/57, 累计样本数: 144, 批次损失: 2.7147
处理批次 3/57, 累计样本数: 192, 批次损失: 1.6078
处理批次 4/57, 累计样本数: 240, 批次损失: 1.4966
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.8839, AUPRC=0.7829
当前学习率: 0.000050
Epoch 34/100 - 训练损失: 0.2244 - 验证AUROC: 0.8839 - 验证AUPRC: 0.7829
批次 0: 正样本 17, 负样本 31
批次 100: 正样本 14, 负样本 34
批次 200: 正样本 19, 负样本 29
批次 300: 正样本 21, 负样本 27
本轮训练: 正样本 71 (36.98%), 负样本 121 (63.02%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 1.6308
处理批次 1/57, 累计样本数: 96, 批次损失: 1.4223
处理批次 2/57, 累计样本数: 144, 批次损失: 2.7240
处理批次 3/57, 累计样本数: 192, 批次损失: 1.2909
处理批次 4/57, 累计样本数: 240, 批次损失: 1.4073
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.8852, AUPRC=0.8055
当前学习率: 0.000050
Epoch 35/100 - 训练损失: 0.2267 - 验证AUROC: 0.8852 - 验证AUPRC: 0.8055
批次 0: 正样本 12, 负样本 36
批次 100: 正样本 17, 负样本 31
批次 200: 正样本 15, 负样本 33
批次 300: 正样本 14, 负样本 34
本轮训练: 正样本 58 (30.21%), 负样本 134 (69.79%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 2.1454
处理批次 1/57, 累计样本数: 96, 批次损失: 0.9850
处理批次 2/57, 累计样本数: 144, 批次损失: 1.0538
处理批次 3/57, 累计样本数: 192, 批次损失: 1.2771
处理批次 4/57, 累计样本数: 240, 批次损失: 1.5608
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.8826, AUPRC=0.7977
当前学习率: 0.000050
Epoch 36/100 - 训练损失: 0.2208 - 验证AUROC: 0.8826 - 验证AUPRC: 0.7977
批次 0: 正样本 17, 负样本 31
批次 100: 正样本 14, 负样本 34
批次 200: 正样本 13, 负样本 35
批次 300: 正样本 12, 负样本 36
本轮训练: 正样本 56 (29.17%), 负样本 136 (70.83%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 2.4715
处理批次 1/57, 累计样本数: 96, 批次损失: 1.2517
处理批次 2/57, 累计样本数: 144, 批次损失: 1.2585
处理批次 3/57, 累计样本数: 192, 批次损失: 1.6657
处理批次 4/57, 累计样本数: 240, 批次损失: 1.3623
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.8830, AUPRC=0.8084
Epoch 00037: reducing learning rate of group 0 to 2.5000e-05.
当前学习率: 0.000025
Epoch 37/100 - 训练损失: 0.2152 - 验证AUROC: 0.8830 - 验证AUPRC: 0.8084
批次 0: 正样本 15, 负样本 33
批次 100: 正样本 15, 负样本 33
批次 200: 正样本 13, 负样本 35
批次 300: 正样本 13, 负样本 35
本轮训练: 正样本 56 (29.17%), 负样本 136 (70.83%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 2.0345
处理批次 1/57, 累计样本数: 96, 批次损失: 1.2521
处理批次 2/57, 累计样本数: 144, 批次损失: 2.7738
处理批次 3/57, 累计样本数: 192, 批次损失: 1.1458
处理批次 4/57, 累计样本数: 240, 批次损失: 1.2726
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.8929, AUPRC=0.8164
当前学习率: 0.000025
Epoch 38/100 - 训练损失: 0.2008 - 验证AUROC: 0.8929 - 验证AUPRC: 0.8164
批次 0: 正样本 12, 负样本 36
批次 100: 正样本 16, 负样本 32
批次 200: 正样本 13, 负样本 35
批次 300: 正样本 14, 负样本 34
本轮训练: 正样本 55 (28.65%), 负样本 137 (71.35%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 2.3366
处理批次 1/57, 累计样本数: 96, 批次损失: 1.6266
处理批次 2/57, 累计样本数: 144, 批次损失: 2.8072
处理批次 3/57, 累计样本数: 192, 批次损失: 1.1993
处理批次 4/57, 累计样本数: 240, 批次损失: 1.3151
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.8833, AUPRC=0.8038
当前学习率: 0.000025
Epoch 39/100 - 训练损失: 0.1882 - 验证AUROC: 0.8833 - 验证AUPRC: 0.8038
批次 0: 正样本 21, 负样本 27
批次 100: 正样本 16, 负样本 32
批次 200: 正样本 12, 负样本 36
批次 300: 正样本 17, 负样本 31
本轮训练: 正样本 66 (34.38%), 负样本 126 (65.62%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 2.1763
处理批次 1/57, 累计样本数: 96, 批次损失: 1.4574
处理批次 2/57, 累计样本数: 144, 批次损失: 2.7655
处理批次 3/57, 累计样本数: 192, 批次损失: 1.4468
处理批次 4/57, 累计样本数: 240, 批次损失: 1.4176
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.8870, AUPRC=0.8018
当前学习率: 0.000025
Epoch 40/100 - 训练损失: 0.1840 - 验证AUROC: 0.8870 - 验证AUPRC: 0.8018
批次 0: 正样本 19, 负样本 29
批次 100: 正样本 12, 负样本 36
批次 200: 正样本 17, 负样本 31
批次 300: 正样本 15, 负样本 33
本轮训练: 正样本 63 (32.81%), 负样本 129 (67.19%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 2.2338
处理批次 1/57, 累计样本数: 96, 批次损失: 1.3474
处理批次 2/57, 累计样本数: 144, 批次损失: 2.8634
处理批次 3/57, 累计样本数: 192, 批次损失: 1.2727
处理批次 4/57, 累计样本数: 240, 批次损失: 1.7087
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.8856, AUPRC=0.7895
当前学习率: 0.000025
Epoch 41/100 - 训练损失: 0.1818 - 验证AUROC: 0.8856 - 验证AUPRC: 0.7895
批次 0: 正样本 17, 负样本 31
批次 100: 正样本 18, 负样本 30
批次 200: 正样本 13, 负样本 35
批次 300: 正样本 13, 负样本 35
本轮训练: 正样本 61 (31.77%), 负样本 131 (68.23%)
验证数据集大小: 57 批次
开始进行val评估...
处理批次 0/57, 累计样本数: 48, 批次损失: 1.9052
处理批次 1/57, 累计样本数: 96, 批次损失: 1.0994
处理批次 2/57, 累计样本数: 144, 批次损失: 2.7924
处理批次 3/57, 累计样本数: 192, 批次损失: 0.8967
处理批次 4/57, 累计样本数: 240, 批次损失: 1.3917
测试完成: 处理了 57/57 批次, 2732 个样本
错误批次数: 0
预测标签统计: 正样本数=882, 负样本数=1850
成功计算评估指标: AUROC=0.8874, AUPRC=0.7998
Epoch 00042: reducing learning rate of group 0 to 1.2500e-05.
当前学习率: 0.000013
早停触发！连续15轮验证集性能未提升
测试数据集大小: 22 批次
成功加载最佳模型状态（来自Epoch 27）
开始进行test评估...
处理批次 0/22, 累计样本数: 48, 批次损失: 0.5800
处理批次 1/22, 累计样本数: 96, 批次损失: 0.8805
处理批次 2/22, 累计样本数: 144, 批次损失: 0.7787
处理批次 3/22, 累计样本数: 192, 批次损失: 1.4194
处理批次 4/22, 累计样本数: 240, 批次损失: 0.5823
测试完成: 处理了 22/22 批次, 1039 个样本
错误批次数: 0
预测标签统计: 正样本数=336, 负样本数=703
成功计算评估指标: AUROC=0.8808, AUPRC=0.7792
最佳阈值: 0.1291, 对应的F1分数: 0.8142
混淆矩阵:
[[507 196]
 [ 41 295]]
详细测试结果: AUROC=0.8808, AUPRC=0.7792, F1=0.8142, 敏感度=0.7212, 特异度=0.8780, 准确率=0.7719, 精确度=0.6008
训练完成！最佳模型来自Epoch 27 - AUROC: 0.8808 - F1: 0.8142
结果已保存到: result/DrugBAN3D_balanced_augment_20250609_131154
训练完成时间: 2025年 06月 09日 星期一 16:22:16 CST
=== 训练总结 ===
训练成功完成！
结果保存在: result/DrugBAN3D_balanced_augment_20250609_131154
配置文件: result/DrugBAN3D_balanced_augment_20250609_131154/config/DrugBAN3D_augmented_20250609_131154.yaml
日志文件: result/DrugBAN3D_balanced_augment_20250609_131154/logs/train.log
保存的模型文件:
  result/DrugBAN3D_balanced_augment_20250609_131154/best_model.pth
