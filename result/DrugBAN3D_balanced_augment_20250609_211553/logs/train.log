
================================================================================
DrugBAN 数据增强与标签生成流程
================================================================================
开始时间: 2025-06-09 21:18:52
原始缓存目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/cached_graphs
增强缓存目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250609_211553
原始标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/labels.csv
训练标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/train_stratified.csv
验证标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/val_stratified.csv
测试标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv
增强标签目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_211553
是否增强测试集: 否
================================================================================

步骤1：执行数据增强...
读取标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/labels.csv
总样本数: 10436, 正样本数: 3369 (32.28%), 负样本数: 7067 (67.72%)
使用的增强类型: ['smart_conformational', 'binding_aware', 'adaptive_rotate']
正样本增强数量: 每个样本0.5次
负样本增强数量: 每个样本0.5次

数据增强完成! 耗时: 223.15秒
成功: 10398/10436 (99.64%)
失败记录已保存到 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250609_211553/augment_failures.txt
生成的文件总数: 15662
  原始文件数: 10398
  增强文件数: 5264
增强后样本总数: 15654 (期望值)
  正样本数: 5053 (32.28%)
  负样本数: 10600 (67.72%)
分布保持: 原始32.28% → 增强后32.28% (分布保持)

================================================================================
步骤2：为增强数据生成标签文件...
读取原始标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/labels.csv
原始标签文件包含 10436 条记录
使用预划分的测试集标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv
测试集包含 1044 条记录
测试集正样本率: 32.28%
正在从缓存目录 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250609_211553 中读取增强数据...
找到 15662 个缓存文件
从缓存文件中提取标签信息...
增强标签已保存至 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_211553/augmented_labels.csv，包含 15662 条记录
正样本: 5064 (32.33%), 负样本: 10598 (67.67%)
数据集划分: 训练集 7955 分子, 验证集 1404 分子, 测试集 1044 分子
验证集当前正样本率: 34.54%, 目标正样本率: 32.28%
调整验证集: 从727个正样本中抽样656个
调整后验证集正样本率: 32.25%
训练标签已保存至 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_211553/train_augmented.csv，包含 11996 条记录
验证标签已保存至 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_211553/valid_augmented.csv，包含 2034 条记录
测试标签已保存至 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_211553/test_augmented.csv，包含 1044 条记录
训练集: 总样本 11996, 正样本率 31.89%
验证集: 总样本 2034, 正样本率 32.25%
测试集: 总样本 1044, 正样本率 32.28%

================================================================================
数据增强与标签生成完成!
增强后的缓存文件保存在: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250609_211553
增强后的标签文件保存在: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_211553
结束时间: 2025-06-09 21:22:52
================================================================================

=== 详细配置信息 ===
配置文件: result/DrugBAN3D_balanced_augment_20250609_211553/config/DrugBAN3D_augmented_20250609_211553.yaml
训练数据: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_211553/train_augmented.csv
验证数据: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_211553/valid_augmented.csv
测试数据: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv
缓存目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250609_211553
结果目录: result/DrugBAN3D_balanced_augment_20250609_211553

=== 完整配置参数详览 ===
📋 训练参数 (TRAIN):
  TRAIN:
    D_LEARNING_RATE: 0.0004   # 最优判别器学习率（来自最佳实验）
    G_LEARNING_RATE: 0.0002   # 最优生成器学习率（来自最佳实验）
    BATCH_SIZE: 48  # 最佳batch size（来自最佳实验）
    D_STEPS_PER_G_STEP: 1
    RESUME_CHECKPOINT: ""
    EPOCH: 100  # 充足的训练轮数
    GRADIENT_ACCUMULATE_STEPS: 2  # 梯度累积，有效batch size = 48*2 = 96
    GRADIENT_CLIP_NORM: 1.0  # 梯度裁剪阈值（来自最佳实验）
    WEIGHT_DECAY: 0.0004  # 最优权重衰减（来自最佳实验）
    LABEL_SMOOTHING: 0.05  # 标签平滑参数（来自最佳实验）
    POS_WEIGHT: 1.05  # 正样本权重（来自最佳实验）

🏗️ GNN配置:
  GNN:
    HIDDEN_DIM: 384  # 最优GNN隐藏维度
    NUM_LAYERS: 4    # 最优GNN层数
  
  BCN:
    HEADS: 8  # 最优注意力头数量

🔧 解码器配置:
  DECODER:
    IN_DIM: 384
    HIDDEN_DIM: 512  # 最优解码器隐藏维度
    OUT_DIM: 128  # 最优解码器输出维度
    BINARY: 1
    DROPOUT: 0.3  # 最优Dropout率，平衡过拟合和欠拟合
  
  ADAPT:
    LAMBDA: 0.1

📊 损失函数配置:
  USE_BIAS_CORRECTION: True  # 启用偏置校正，提升模型稳定性
  USE_FOCAL_LOSS: True  # 使用焦点损失处理类别不平衡
  FOCAL_LOSS_GAMMA: 1.0  # 最优gamma值，温和的焦点损失
  FOCAL_LOSS_ALPHA: 0.3  # 最优alpha值，平衡正负样本

🌐 3D空间特征配置:
  SPATIAL_3D:
    ENABLE_SPATIAL_FUSION: true      # 启用3D空间感知特征融合 - 重要性能提升
    ENABLE_MULTISCALE: true          # 启用多尺度特征提取 - 捕获不同距离的相互作用
    DISTANCE_SCALES: [2.0, 5.0, 8.0]  # 最优多尺度距离阈值(Å)
    SPATIAL_DROPOUT: 0.1             # 最优空间模块Dropout率
    CROSS_ATTENTION_HEADS: 8         # 最优交叉注意力头数
  
  # 损失函数配置 - 最优设置
  USE_FOCAL_LOSS: True  # 使用焦点损失处理类别不平衡

⚙️ 求解器配置:
  SOLVER:
    MAX_EPOCH: 100  # 充足的训练轮数
    BATCH_SIZE: 48  # 最优batch size（来自最佳实验）
    USE_MIXED_PRECISION: False  # 不使用混合精度训练，保持稳定性
    LR_SCHEDULER: True  # 启用学习率调度器（来自最佳实验）
    LR_SCHEDULER_TYPE: "plateau"  # 最优学习率调度器（来自最佳实验）
    LR_WARMUP_EPOCHS: 4  # 最优学习率预热轮数（来自最佳实验）
    GRADIENT_CLIP_NORM: 1.0  # 梯度裁剪阈值（来自最佳实验）
    SEED: 42  # 固定随机种子保证可重现性
  
  RESULT:

⏹️ 早停配置:
  USE_EARLY_STOPPING: True
  EARLY_STOPPING_PATIENCE: 15  # 最优早停耐心值，避免过早停止

=========================

训练开始时间: 2025年 06月 09日 星期一 21:23:18 CST
使用命令行指定的输出目录: result/DrugBAN3D_balanced_augment_20250609_211553
已保存当前配置到 result/DrugBAN3D_balanced_augment_20250609_211553/config/config_used.yaml
配置文件: result/DrugBAN3D_balanced_augment_20250609_211553/config/DrugBAN3D_augmented_20250609_211553.yaml
输出目录: result/DrugBAN3D_balanced_augment_20250609_211553
运行设备: cuda
数据加载器使用 16 个工作线程
使用分层采样的预划分数据集
数据集: 训练集 11996 样本, 验证集 2034 样本, 测试集 1044 样本
正样本比例: 训练集 31.89%, 验证集 32.25%, 测试集 32.28%
使用增强数据集进行训练...
加载标签文件: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_211553/train_augmented.csv, 包含 11996 条记录
找到 11996/11996 个对应的缓存文件
数据集初始化完成，总样本数: 11996
训练/验证 数据集初始化完成: 11996 个样本
创建数据加载器成功: 预期 250 批次，批次大小 48
加载标签文件: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_211553/valid_augmented.csv, 包含 2034 条记录
找到 2034/2034 个对应的缓存文件
数据集初始化完成，总样本数: 2034
训练/验证 数据集初始化完成: 2034 个样本
创建数据加载器成功: 预期 43 批次，批次大小 48
测试模式: 使用原始测试数据
测试标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv
缓存目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/cached_graphs
测试标签文件包含 1044 条记录
测试集标签分布: 正样本 337 (32.28%), 负样本 707 (67.72%)
读取测试标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv, 包含 1044 条记录
成功创建测试标签映射，包含 2088 个条目
测试模式：从标签文件获取 2088 个复合物ID
测试模式：只处理标签文件中的 2088 个样本
在缓存目录中找到 1039/2088 个测试样本缓存文件
数据集初始化完成，总样本数: 1039
测试 数据集初始化完成: 1039 个样本
创建数据加载器成功: 预期 22 批次，批次大小 48

==================================================
DrugBAN3D初始化 - 偏差校正模块: 启用
Dropout率: 0.3
GNN层数: 4
==================================================

优化器: Adam, 学习率: 0.0002, L2正则化强度: 0.0004
启用标签平滑，参数值: 0.05
启用类别加权，正样本权重: 1.050
启用梯度裁剪，阈值：1.0
使用state_dict保存模型，避免完整对象复制
使用plateau学习率调度器
运行设备: cuda
启用标签平滑，参数值: 0.05
启用类别加权，正样本权重: 1.0499999523162842
使用ReduceLROnPlateau学习率调度器，监控验证集AUROC
开始训练...
批次 0: 正样本 17, 负样本 31
批次 100: 正样本 20, 负样本 28
批次 200: 正样本 17, 负样本 31
本轮训练: 正样本 54 (37.50%), 负样本 90 (62.50%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.6822
处理批次 1/43, 累计样本数: 96, 批次损失: 0.6489
处理批次 2/43, 累计样本数: 144, 批次损失: 0.5617
处理批次 3/43, 累计样本数: 192, 批次损失: 0.7032
处理批次 4/43, 累计样本数: 240, 批次损失: 2.8048
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.6145, AUPRC=0.4071
当前学习率: 0.000200
保存最佳模型（轮次 1）到 result/DrugBAN3D_balanced_augment_20250609_211553/best_model.pth
Epoch 1/100 - 训练损失: 2.2249 - 验证AUROC: 0.6145 - 验证AUPRC: 0.4071
批次 0: 正样本 17, 负样本 31
批次 100: 正样本 15, 负样本 33
批次 200: 正样本 15, 负样本 33
本轮训练: 正样本 47 (32.64%), 负样本 97 (67.36%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.7163
处理批次 1/43, 累计样本数: 96, 批次损失: 0.5634
处理批次 2/43, 累计样本数: 144, 批次损失: 0.5011
处理批次 3/43, 累计样本数: 192, 批次损失: 0.6089
处理批次 4/43, 累计样本数: 240, 批次损失: 2.7750
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.7210, AUPRC=0.5125
当前学习率: 0.000200
保存最佳模型（轮次 2）到 result/DrugBAN3D_balanced_augment_20250609_211553/best_model.pth
Epoch 2/100 - 训练损失: 1.5959 - 验证AUROC: 0.7210 - 验证AUPRC: 0.5125
批次 0: 正样本 13, 负样本 35
批次 100: 正样本 14, 负样本 34
批次 200: 正样本 15, 负样本 33
本轮训练: 正样本 42 (29.17%), 负样本 102 (70.83%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 1.2555
处理批次 1/43, 累计样本数: 96, 批次损失: 1.0737
处理批次 2/43, 累计样本数: 144, 批次损失: 0.8092
处理批次 3/43, 累计样本数: 192, 批次损失: 1.4215
处理批次 4/43, 累计样本数: 240, 批次损失: 3.6238
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.6930, AUPRC=0.5102
当前学习率: 0.000200
Epoch 3/100 - 训练损失: 1.3213 - 验证AUROC: 0.6930 - 验证AUPRC: 0.5102
批次 0: 正样本 14, 负样本 34
批次 100: 正样本 20, 负样本 28
批次 200: 正样本 8, 负样本 40
本轮训练: 正样本 42 (29.17%), 负样本 102 (70.83%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 1.3082
处理批次 1/43, 累计样本数: 96, 批次损失: 0.7824
处理批次 2/43, 累计样本数: 144, 批次损失: 0.4378
处理批次 3/43, 累计样本数: 192, 批次损失: 0.7010
处理批次 4/43, 累计样本数: 240, 批次损失: 0.6866
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.7117, AUPRC=0.5233
当前学习率: 0.000200
Epoch 4/100 - 训练损失: 1.2770 - 验证AUROC: 0.7117 - 验证AUPRC: 0.5233
批次 0: 正样本 19, 负样本 29
批次 100: 正样本 13, 负样本 35
批次 200: 正样本 14, 负样本 34
本轮训练: 正样本 46 (31.94%), 负样本 98 (68.06%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.7113
处理批次 1/43, 累计样本数: 96, 批次损失: 0.6465
处理批次 2/43, 累计样本数: 144, 批次损失: 0.5843
处理批次 3/43, 累计样本数: 192, 批次损失: 0.7345
处理批次 4/43, 累计样本数: 240, 批次损失: 1.0746
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.7537, AUPRC=0.5598
当前学习率: 0.000200
保存最佳模型（轮次 5）到 result/DrugBAN3D_balanced_augment_20250609_211553/best_model.pth
Epoch 5/100 - 训练损失: 1.2376 - 验证AUROC: 0.7537 - 验证AUPRC: 0.5598
批次 0: 正样本 16, 负样本 32
批次 100: 正样本 15, 负样本 33
批次 200: 正样本 15, 负样本 33
本轮训练: 正样本 46 (31.94%), 负样本 98 (68.06%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.5992
处理批次 1/43, 累计样本数: 96, 批次损失: 0.8186
处理批次 2/43, 累计样本数: 144, 批次损失: 0.6525
处理批次 3/43, 累计样本数: 192, 批次损失: 0.6135
处理批次 4/43, 累计样本数: 240, 批次损失: 0.8875
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.7374, AUPRC=0.5365
当前学习率: 0.000200
Epoch 6/100 - 训练损失: 1.0646 - 验证AUROC: 0.7374 - 验证AUPRC: 0.5365
批次 0: 正样本 13, 负样本 35
批次 100: 正样本 17, 负样本 31
批次 200: 正样本 14, 负样本 34
本轮训练: 正样本 44 (30.56%), 负样本 100 (69.44%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.5127
处理批次 1/43, 累计样本数: 96, 批次损失: 0.5955
处理批次 2/43, 累计样本数: 144, 批次损失: 0.4733
处理批次 3/43, 累计样本数: 192, 批次损失: 0.5454
处理批次 4/43, 累计样本数: 240, 批次损失: 2.7312
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.7635, AUPRC=0.5812
当前学习率: 0.000200
保存最佳模型（轮次 7）到 result/DrugBAN3D_balanced_augment_20250609_211553/best_model.pth
Epoch 7/100 - 训练损失: 1.0784 - 验证AUROC: 0.7635 - 验证AUPRC: 0.5812
批次 0: 正样本 19, 负样本 29
批次 100: 正样本 18, 负样本 30
批次 200: 正样本 13, 负样本 35
本轮训练: 正样本 50 (34.72%), 负样本 94 (65.28%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 1.7044
处理批次 1/43, 累计样本数: 96, 批次损失: 0.8698
处理批次 2/43, 累计样本数: 144, 批次损失: 0.5649
处理批次 3/43, 累计样本数: 192, 批次损失: 0.5091
处理批次 4/43, 累计样本数: 240, 批次损失: 0.6289
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.7565, AUPRC=0.6076
当前学习率: 0.000200
Epoch 8/100 - 训练损失: 1.0089 - 验证AUROC: 0.7565 - 验证AUPRC: 0.6076
批次 0: 正样本 15, 负样本 33
批次 100: 正样本 14, 负样本 34
批次 200: 正样本 12, 负样本 36
本轮训练: 正样本 41 (28.47%), 负样本 103 (71.53%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 1.5559
处理批次 1/43, 累计样本数: 96, 批次损失: 1.0616
处理批次 2/43, 累计样本数: 144, 批次损失: 0.8088
处理批次 3/43, 累计样本数: 192, 批次损失: 0.7002
处理批次 4/43, 累计样本数: 240, 批次损失: 0.8263
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.7620, AUPRC=0.6087
当前学习率: 0.000200
Epoch 9/100 - 训练损失: 0.8933 - 验证AUROC: 0.7620 - 验证AUPRC: 0.6087
批次 0: 正样本 16, 负样本 32
批次 100: 正样本 16, 负样本 32
批次 200: 正样本 12, 负样本 36
本轮训练: 正样本 44 (30.56%), 负样本 100 (69.44%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.6281
处理批次 1/43, 累计样本数: 96, 批次损失: 0.6316
处理批次 2/43, 累计样本数: 144, 批次损失: 0.6486
处理批次 3/43, 累计样本数: 192, 批次损失: 0.6596
处理批次 4/43, 累计样本数: 240, 批次损失: 1.1339
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.7807, AUPRC=0.5982
当前学习率: 0.000200
保存最佳模型（轮次 10）到 result/DrugBAN3D_balanced_augment_20250609_211553/best_model.pth
Epoch 10/100 - 训练损失: 0.8813 - 验证AUROC: 0.7807 - 验证AUPRC: 0.5982
批次 0: 正样本 12, 负样本 36
批次 100: 正样本 12, 负样本 36
批次 200: 正样本 13, 负样本 35
本轮训练: 正样本 37 (25.69%), 负样本 107 (74.31%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.5220
处理批次 1/43, 累计样本数: 96, 批次损失: 0.4976
处理批次 2/43, 累计样本数: 144, 批次损失: 0.5953
处理批次 3/43, 累计样本数: 192, 批次损失: 0.5942
处理批次 4/43, 累计样本数: 240, 批次损失: 0.8134
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.7809, AUPRC=0.5991
当前学习率: 0.000200
保存最佳模型（轮次 11）到 result/DrugBAN3D_balanced_augment_20250609_211553/best_model.pth
Epoch 11/100 - 训练损失: 0.7970 - 验证AUROC: 0.7809 - 验证AUPRC: 0.5991
批次 0: 正样本 8, 负样本 40
批次 100: 正样本 17, 负样本 31
批次 200: 正样本 17, 负样本 31
本轮训练: 正样本 42 (29.17%), 负样本 102 (70.83%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.6867
处理批次 1/43, 累计样本数: 96, 批次损失: 0.6249
处理批次 2/43, 累计样本数: 144, 批次损失: 0.8744
处理批次 3/43, 累计样本数: 192, 批次损失: 0.6994
处理批次 4/43, 累计样本数: 240, 批次损失: 0.9075
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8080, AUPRC=0.6506
当前学习率: 0.000200
保存最佳模型（轮次 12）到 result/DrugBAN3D_balanced_augment_20250609_211553/best_model.pth
Epoch 12/100 - 训练损失: 0.6873 - 验证AUROC: 0.8080 - 验证AUPRC: 0.6506
批次 0: 正样本 14, 负样本 34
批次 100: 正样本 12, 负样本 36
批次 200: 正样本 14, 负样本 34
本轮训练: 正样本 40 (27.78%), 负样本 104 (72.22%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.4787
处理批次 1/43, 累计样本数: 96, 批次损失: 0.5196
处理批次 2/43, 累计样本数: 144, 批次损失: 0.6446
处理批次 3/43, 累计样本数: 192, 批次损失: 0.5020
处理批次 4/43, 累计样本数: 240, 批次损失: 0.7210
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8138, AUPRC=0.6560
当前学习率: 0.000200
保存最佳模型（轮次 13）到 result/DrugBAN3D_balanced_augment_20250609_211553/best_model.pth
Epoch 13/100 - 训练损失: 0.6253 - 验证AUROC: 0.8138 - 验证AUPRC: 0.6560
批次 0: 正样本 25, 负样本 23
批次 100: 正样本 20, 负样本 28
批次 200: 正样本 13, 负样本 35
本轮训练: 正样本 58 (40.28%), 负样本 86 (59.72%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.7604
处理批次 1/43, 累计样本数: 96, 批次损失: 0.7671
处理批次 2/43, 累计样本数: 144, 批次损失: 0.8052
处理批次 3/43, 累计样本数: 192, 批次损失: 0.6022
处理批次 4/43, 累计样本数: 240, 批次损失: 0.8018
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8032, AUPRC=0.6380
当前学习率: 0.000200
Epoch 14/100 - 训练损失: 0.5404 - 验证AUROC: 0.8032 - 验证AUPRC: 0.6380
批次 0: 正样本 16, 负样本 32
批次 100: 正样本 18, 负样本 30
批次 200: 正样本 11, 负样本 37
本轮训练: 正样本 45 (31.25%), 负样本 99 (68.75%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.5326
处理批次 1/43, 累计样本数: 96, 批次损失: 0.5704
处理批次 2/43, 累计样本数: 144, 批次损失: 0.5678
处理批次 3/43, 累计样本数: 192, 批次损失: 0.4648
处理批次 4/43, 累计样本数: 240, 批次损失: 0.6223
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8218, AUPRC=0.6705
当前学习率: 0.000200
保存最佳模型（轮次 15）到 result/DrugBAN3D_balanced_augment_20250609_211553/best_model.pth
Epoch 15/100 - 训练损失: 0.5065 - 验证AUROC: 0.8218 - 验证AUPRC: 0.6705
批次 0: 正样本 11, 负样本 37
批次 100: 正样本 10, 负样本 38
批次 200: 正样本 12, 负样本 36
本轮训练: 正样本 33 (22.92%), 负样本 111 (77.08%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.5533
处理批次 1/43, 累计样本数: 96, 批次损失: 0.7556
处理批次 2/43, 累计样本数: 144, 批次损失: 1.1203
处理批次 3/43, 累计样本数: 192, 批次损失: 0.4682
处理批次 4/43, 累计样本数: 240, 批次损失: 0.6684
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8496, AUPRC=0.7183
当前学习率: 0.000200
保存最佳模型（轮次 16）到 result/DrugBAN3D_balanced_augment_20250609_211553/best_model.pth
Epoch 16/100 - 训练损失: 0.4846 - 验证AUROC: 0.8496 - 验证AUPRC: 0.7183
批次 0: 正样本 17, 负样本 31
批次 100: 正样本 16, 负样本 32
批次 200: 正样本 16, 负样本 32
本轮训练: 正样本 49 (34.03%), 负样本 95 (65.97%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.5175
处理批次 1/43, 累计样本数: 96, 批次损失: 0.5604
处理批次 2/43, 累计样本数: 144, 批次损失: 0.7847
处理批次 3/43, 累计样本数: 192, 批次损失: 0.4167
处理批次 4/43, 累计样本数: 240, 批次损失: 0.6353
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8477, AUPRC=0.6972
当前学习率: 0.000200
Epoch 17/100 - 训练损失: 0.4675 - 验证AUROC: 0.8477 - 验证AUPRC: 0.6972
批次 0: 正样本 7, 负样本 41
批次 100: 正样本 11, 负样本 37
批次 200: 正样本 14, 负样本 34
本轮训练: 正样本 32 (22.22%), 负样本 112 (77.78%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.6358
处理批次 1/43, 累计样本数: 96, 批次损失: 0.5454
处理批次 2/43, 累计样本数: 144, 批次损失: 1.0219
处理批次 3/43, 累计样本数: 192, 批次损失: 0.4968
处理批次 4/43, 累计样本数: 240, 批次损失: 0.7971
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8302, AUPRC=0.6643
当前学习率: 0.000200
Epoch 18/100 - 训练损失: 0.4628 - 验证AUROC: 0.8302 - 验证AUPRC: 0.6643
批次 0: 正样本 13, 负样本 35
批次 100: 正样本 16, 负样本 32
批次 200: 正样本 17, 负样本 31
本轮训练: 正样本 46 (31.94%), 负样本 98 (68.06%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.5433
处理批次 1/43, 累计样本数: 96, 批次损失: 0.6278
处理批次 2/43, 累计样本数: 144, 批次损失: 1.0817
处理批次 3/43, 累计样本数: 192, 批次损失: 0.5632
处理批次 4/43, 累计样本数: 240, 批次损失: 0.6934
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8562, AUPRC=0.7350
当前学习率: 0.000200
保存最佳模型（轮次 19）到 result/DrugBAN3D_balanced_augment_20250609_211553/best_model.pth
Epoch 19/100 - 训练损失: 0.4547 - 验证AUROC: 0.8562 - 验证AUPRC: 0.7350
批次 0: 正样本 20, 负样本 28
批次 100: 正样本 15, 负样本 33
批次 200: 正样本 15, 负样本 33
本轮训练: 正样本 50 (34.72%), 负样本 94 (65.28%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.5104
处理批次 1/43, 累计样本数: 96, 批次损失: 0.6878
处理批次 2/43, 累计样本数: 144, 批次损失: 0.7720
处理批次 3/43, 累计样本数: 192, 批次损失: 0.5077
处理批次 4/43, 累计样本数: 240, 批次损失: 0.6345
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8442, AUPRC=0.7294
当前学习率: 0.000200
Epoch 20/100 - 训练损失: 0.4337 - 验证AUROC: 0.8442 - 验证AUPRC: 0.7294
批次 0: 正样本 13, 负样本 35
批次 100: 正样本 14, 负样本 34
批次 200: 正样本 10, 负样本 38
本轮训练: 正样本 37 (25.69%), 负样本 107 (74.31%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.5004
处理批次 1/43, 累计样本数: 96, 批次损失: 0.6192
处理批次 2/43, 累计样本数: 144, 批次损失: 0.9856
处理批次 3/43, 累计样本数: 192, 批次损失: 0.5288
处理批次 4/43, 累计样本数: 240, 批次损失: 0.7271
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8585, AUPRC=0.7290
当前学习率: 0.000200
保存最佳模型（轮次 21）到 result/DrugBAN3D_balanced_augment_20250609_211553/best_model.pth
Epoch 21/100 - 训练损失: 0.4221 - 验证AUROC: 0.8585 - 验证AUPRC: 0.7290
批次 0: 正样本 16, 负样本 32
批次 100: 正样本 17, 负样本 31
批次 200: 正样本 13, 负样本 35
本轮训练: 正样本 46 (31.94%), 负样本 98 (68.06%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.5934
处理批次 1/43, 累计样本数: 96, 批次损失: 0.6362
处理批次 2/43, 累计样本数: 144, 批次损失: 0.9371
处理批次 3/43, 累计样本数: 192, 批次损失: 0.5028
处理批次 4/43, 累计样本数: 240, 批次损失: 0.9050
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8406, AUPRC=0.6838
当前学习率: 0.000200
Epoch 22/100 - 训练损失: 0.4355 - 验证AUROC: 0.8406 - 验证AUPRC: 0.6838
批次 0: 正样本 23, 负样本 25
批次 100: 正样本 15, 负样本 33
批次 200: 正样本 16, 负样本 32
本轮训练: 正样本 54 (37.50%), 负样本 90 (62.50%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.5796
处理批次 1/43, 累计样本数: 96, 批次损失: 0.7216
处理批次 2/43, 累计样本数: 144, 批次损失: 1.0700
处理批次 3/43, 累计样本数: 192, 批次损失: 0.6242
处理批次 4/43, 累计样本数: 240, 批次损失: 0.8908
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8523, AUPRC=0.7212
当前学习率: 0.000200
Epoch 23/100 - 训练损失: 0.4283 - 验证AUROC: 0.8523 - 验证AUPRC: 0.7212
批次 0: 正样本 9, 负样本 39
批次 100: 正样本 17, 负样本 31
批次 200: 正样本 14, 负样本 34
本轮训练: 正样本 40 (27.78%), 负样本 104 (72.22%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.8009
处理批次 1/43, 累计样本数: 96, 批次损失: 0.5308
处理批次 2/43, 累计样本数: 144, 批次损失: 0.7045
处理批次 3/43, 累计样本数: 192, 批次损失: 0.5849
处理批次 4/43, 累计样本数: 240, 批次损失: 0.9051
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8441, AUPRC=0.7107
当前学习率: 0.000200
Epoch 24/100 - 训练损失: 0.4095 - 验证AUROC: 0.8441 - 验证AUPRC: 0.7107
批次 0: 正样本 14, 负样本 34
批次 100: 正样本 14, 负样本 34
批次 200: 正样本 15, 负样本 33
本轮训练: 正样本 43 (29.86%), 负样本 101 (70.14%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.4951
处理批次 1/43, 累计样本数: 96, 批次损失: 0.5941
处理批次 2/43, 累计样本数: 144, 批次损失: 0.8185
处理批次 3/43, 累计样本数: 192, 批次损失: 0.7732
处理批次 4/43, 累计样本数: 240, 批次损失: 0.8848
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8695, AUPRC=0.7411
当前学习率: 0.000200
保存最佳模型（轮次 25）到 result/DrugBAN3D_balanced_augment_20250609_211553/best_model.pth
Epoch 25/100 - 训练损失: 0.4308 - 验证AUROC: 0.8695 - 验证AUPRC: 0.7411
批次 0: 正样本 12, 负样本 36
批次 100: 正样本 12, 负样本 36
批次 200: 正样本 20, 负样本 28
本轮训练: 正样本 44 (30.56%), 负样本 100 (69.44%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.3973
处理批次 1/43, 累计样本数: 96, 批次损失: 0.5368
处理批次 2/43, 累计样本数: 144, 批次损失: 0.7170
处理批次 3/43, 累计样本数: 192, 批次损失: 0.4420
处理批次 4/43, 累计样本数: 240, 批次损失: 0.9703
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8697, AUPRC=0.7582
当前学习率: 0.000200
保存最佳模型（轮次 26）到 result/DrugBAN3D_balanced_augment_20250609_211553/best_model.pth
Epoch 26/100 - 训练损失: 0.4303 - 验证AUROC: 0.8697 - 验证AUPRC: 0.7582
批次 0: 正样本 15, 负样本 33
批次 100: 正样本 15, 负样本 33
批次 200: 正样本 19, 负样本 29
本轮训练: 正样本 49 (34.03%), 负样本 95 (65.97%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.4971
处理批次 1/43, 累计样本数: 96, 批次损失: 0.5473
处理批次 2/43, 累计样本数: 144, 批次损失: 0.7540
处理批次 3/43, 累计样本数: 192, 批次损失: 2.6303
处理批次 4/43, 累计样本数: 240, 批次损失: 0.7291
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8599, AUPRC=0.7513
当前学习率: 0.000200
Epoch 27/100 - 训练损失: 0.3961 - 验证AUROC: 0.8599 - 验证AUPRC: 0.7513
批次 0: 正样本 15, 负样本 33
批次 100: 正样本 18, 负样本 30
批次 200: 正样本 15, 负样本 33
本轮训练: 正样本 48 (33.33%), 负样本 96 (66.67%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.4663
处理批次 1/43, 累计样本数: 96, 批次损失: 0.5015
处理批次 2/43, 累计样本数: 144, 批次损失: 0.7442
处理批次 3/43, 累计样本数: 192, 批次损失: 0.4724
处理批次 4/43, 累计样本数: 240, 批次损失: 0.7174
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8635, AUPRC=0.7651
当前学习率: 0.000200
Epoch 28/100 - 训练损失: 0.4280 - 验证AUROC: 0.8635 - 验证AUPRC: 0.7651
批次 0: 正样本 6, 负样本 42
批次 100: 正样本 9, 负样本 39
批次 200: 正样本 17, 负样本 31
本轮训练: 正样本 32 (22.22%), 负样本 112 (77.78%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.7338
处理批次 1/43, 累计样本数: 96, 批次损失: 0.5932
处理批次 2/43, 累计样本数: 144, 批次损失: 0.8460
处理批次 3/43, 累计样本数: 192, 批次损失: 0.5135
处理批次 4/43, 累计样本数: 240, 批次损失: 0.9825
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8597, AUPRC=0.7473
当前学习率: 0.000200
Epoch 29/100 - 训练损失: 0.4176 - 验证AUROC: 0.8597 - 验证AUPRC: 0.7473
批次 0: 正样本 16, 负样本 32
批次 100: 正样本 16, 负样本 32
批次 200: 正样本 18, 负样本 30
本轮训练: 正样本 50 (34.72%), 负样本 94 (65.28%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.5874
处理批次 1/43, 累计样本数: 96, 批次损失: 0.5629
处理批次 2/43, 累计样本数: 144, 批次损失: 0.9582
处理批次 3/43, 累计样本数: 192, 批次损失: 0.6605
处理批次 4/43, 累计样本数: 240, 批次损失: 0.7292
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8630, AUPRC=0.7294
Epoch 00030: reducing learning rate of group 0 to 1.0000e-04.
当前学习率: 0.000100
Epoch 30/100 - 训练损失: 0.4102 - 验证AUROC: 0.8630 - 验证AUPRC: 0.7294
批次 0: 正样本 12, 负样本 36
批次 100: 正样本 22, 负样本 26
批次 200: 正样本 15, 负样本 33
本轮训练: 正样本 49 (34.03%), 负样本 95 (65.97%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.6845
处理批次 1/43, 累计样本数: 96, 批次损失: 0.5861
处理批次 2/43, 累计样本数: 144, 批次损失: 0.8416
处理批次 3/43, 累计样本数: 192, 批次损失: 0.5523
处理批次 4/43, 累计样本数: 240, 批次损失: 0.7205
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8845, AUPRC=0.7870
当前学习率: 0.000100
保存最佳模型（轮次 31）到 result/DrugBAN3D_balanced_augment_20250609_211553/best_model.pth
Epoch 31/100 - 训练损失: 0.3670 - 验证AUROC: 0.8845 - 验证AUPRC: 0.7870
批次 0: 正样本 13, 负样本 35
批次 100: 正样本 11, 负样本 37
批次 200: 正样本 18, 负样本 30
本轮训练: 正样本 42 (29.17%), 负样本 102 (70.83%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.9893
处理批次 1/43, 累计样本数: 96, 批次损失: 0.5573
处理批次 2/43, 累计样本数: 144, 批次损失: 0.9660
处理批次 3/43, 累计样本数: 192, 批次损失: 0.5537
处理批次 4/43, 累计样本数: 240, 批次损失: 0.8099
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8653, AUPRC=0.7520
当前学习率: 0.000100
Epoch 32/100 - 训练损失: 0.3619 - 验证AUROC: 0.8653 - 验证AUPRC: 0.7520
批次 0: 正样本 15, 负样本 33
批次 100: 正样本 12, 负样本 36
批次 200: 正样本 13, 负样本 35
本轮训练: 正样本 40 (27.78%), 负样本 104 (72.22%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.7848
处理批次 1/43, 累计样本数: 96, 批次损失: 0.5348
处理批次 2/43, 累计样本数: 144, 批次损失: 1.0255
处理批次 3/43, 累计样本数: 192, 批次损失: 0.5697
处理批次 4/43, 累计样本数: 240, 批次损失: 0.8759
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8658, AUPRC=0.7545
当前学习率: 0.000100
Epoch 33/100 - 训练损失: 0.3599 - 验证AUROC: 0.8658 - 验证AUPRC: 0.7545
批次 0: 正样本 13, 负样本 35
批次 100: 正样本 20, 负样本 28
批次 200: 正样本 10, 负样本 38
本轮训练: 正样本 43 (29.86%), 负样本 101 (70.14%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.7083
处理批次 1/43, 累计样本数: 96, 批次损失: 0.5028
处理批次 2/43, 累计样本数: 144, 批次损失: 1.0919
处理批次 3/43, 累计样本数: 192, 批次损失: 0.5435
处理批次 4/43, 累计样本数: 240, 批次损失: 0.9432
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8657, AUPRC=0.7506
当前学习率: 0.000100
Epoch 34/100 - 训练损失: 0.3586 - 验证AUROC: 0.8657 - 验证AUPRC: 0.7506
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 15, 负样本 33
批次 200: 正样本 12, 负样本 36
本轮训练: 正样本 45 (31.25%), 负样本 99 (68.75%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.5914
处理批次 1/43, 累计样本数: 96, 批次损失: 0.5659
处理批次 2/43, 累计样本数: 144, 批次损失: 0.9444
处理批次 3/43, 累计样本数: 192, 批次损失: 0.7861
处理批次 4/43, 累计样本数: 240, 批次损失: 0.9720
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8736, AUPRC=0.7796
当前学习率: 0.000100
Epoch 35/100 - 训练损失: 0.3746 - 验证AUROC: 0.8736 - 验证AUPRC: 0.7796
批次 0: 正样本 16, 负样本 32
批次 100: 正样本 17, 负样本 31
批次 200: 正样本 23, 负样本 25
本轮训练: 正样本 56 (38.89%), 负样本 88 (61.11%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.5554
处理批次 1/43, 累计样本数: 96, 批次损失: 0.5105
处理批次 2/43, 累计样本数: 144, 批次损失: 0.7764
处理批次 3/43, 累计样本数: 192, 批次损失: 0.4428
处理批次 4/43, 累计样本数: 240, 批次损失: 0.7235
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8856, AUPRC=0.7969
当前学习率: 0.000100
保存最佳模型（轮次 36）到 result/DrugBAN3D_balanced_augment_20250609_211553/best_model.pth
Epoch 36/100 - 训练损失: 0.3813 - 验证AUROC: 0.8856 - 验证AUPRC: 0.7969
批次 0: 正样本 14, 负样本 34
批次 100: 正样本 9, 负样本 39
批次 200: 正样本 16, 负样本 32
本轮训练: 正样本 39 (27.08%), 负样本 105 (72.92%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.6972
处理批次 1/43, 累计样本数: 96, 批次损失: 0.5932
处理批次 2/43, 累计样本数: 144, 批次损失: 0.7456
处理批次 3/43, 累计样本数: 192, 批次损失: 0.4184
处理批次 4/43, 累计样本数: 240, 批次损失: 0.9313
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8717, AUPRC=0.7732
当前学习率: 0.000100
Epoch 37/100 - 训练损失: 0.3826 - 验证AUROC: 0.8717 - 验证AUPRC: 0.7732
批次 0: 正样本 17, 负样本 31
批次 100: 正样本 19, 负样本 29
批次 200: 正样本 18, 负样本 30
本轮训练: 正样本 54 (37.50%), 负样本 90 (62.50%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.6654
处理批次 1/43, 累计样本数: 96, 批次损失: 0.5668
处理批次 2/43, 累计样本数: 144, 批次损失: 0.8555
处理批次 3/43, 累计样本数: 192, 批次损失: 0.4383
处理批次 4/43, 累计样本数: 240, 批次损失: 1.0276
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8820, AUPRC=0.7840
当前学习率: 0.000100
Epoch 38/100 - 训练损失: 0.3690 - 验证AUROC: 0.8820 - 验证AUPRC: 0.7840
批次 0: 正样本 17, 负样本 31
批次 100: 正样本 18, 负样本 30
批次 200: 正样本 21, 负样本 27
本轮训练: 正样本 56 (38.89%), 负样本 88 (61.11%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.6939
处理批次 1/43, 累计样本数: 96, 批次损失: 0.5542
处理批次 2/43, 累计样本数: 144, 批次损失: 0.7758
处理批次 3/43, 累计样本数: 192, 批次损失: 0.4755
处理批次 4/43, 累计样本数: 240, 批次损失: 1.1288
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8766, AUPRC=0.7660
当前学习率: 0.000100
Epoch 39/100 - 训练损失: 0.3785 - 验证AUROC: 0.8766 - 验证AUPRC: 0.7660
批次 0: 正样本 16, 负样本 32
批次 100: 正样本 15, 负样本 33
批次 200: 正样本 18, 负样本 30
本轮训练: 正样本 49 (34.03%), 负样本 95 (65.97%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.5047
处理批次 1/43, 累计样本数: 96, 批次损失: 0.6065
处理批次 2/43, 累计样本数: 144, 批次损失: 0.8685
处理批次 3/43, 累计样本数: 192, 批次损失: 0.4269
处理批次 4/43, 累计样本数: 240, 批次损失: 0.8785
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8821, AUPRC=0.7783
当前学习率: 0.000100
Epoch 40/100 - 训练损失: 0.3544 - 验证AUROC: 0.8821 - 验证AUPRC: 0.7783
批次 0: 正样本 10, 负样本 38
批次 100: 正样本 19, 负样本 29
批次 200: 正样本 12, 负样本 36
本轮训练: 正样本 41 (28.47%), 负样本 103 (71.53%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.7843
处理批次 1/43, 累计样本数: 96, 批次损失: 0.7822
处理批次 2/43, 累计样本数: 144, 批次损失: 1.0787
处理批次 3/43, 累计样本数: 192, 批次损失: 0.4640
处理批次 4/43, 累计样本数: 240, 批次损失: 0.9189
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8820, AUPRC=0.7825
Epoch 00041: reducing learning rate of group 0 to 5.0000e-05.
当前学习率: 0.000050
Epoch 41/100 - 训练损失: 0.3565 - 验证AUROC: 0.8820 - 验证AUPRC: 0.7825
批次 0: 正样本 19, 负样本 29
批次 100: 正样本 15, 负样本 33
批次 200: 正样本 12, 负样本 36
本轮训练: 正样本 46 (31.94%), 负样本 98 (68.06%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.7088
处理批次 1/43, 累计样本数: 96, 批次损失: 0.6178
处理批次 2/43, 累计样本数: 144, 批次损失: 0.9306
处理批次 3/43, 累计样本数: 192, 批次损失: 0.3678
处理批次 4/43, 累计样本数: 240, 批次损失: 1.0081
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8901, AUPRC=0.7972
当前学习率: 0.000050
保存最佳模型（轮次 42）到 result/DrugBAN3D_balanced_augment_20250609_211553/best_model.pth
Epoch 42/100 - 训练损失: 0.3400 - 验证AUROC: 0.8901 - 验证AUPRC: 0.7972
批次 0: 正样本 22, 负样本 26
批次 100: 正样本 17, 负样本 31
批次 200: 正样本 15, 负样本 33
本轮训练: 正样本 54 (37.50%), 负样本 90 (62.50%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.8186
处理批次 1/43, 累计样本数: 96, 批次损失: 0.5753
处理批次 2/43, 累计样本数: 144, 批次损失: 0.8262
处理批次 3/43, 累计样本数: 192, 批次损失: 0.4018
处理批次 4/43, 累计样本数: 240, 批次损失: 1.0330
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8764, AUPRC=0.7979
当前学习率: 0.000050
Epoch 43/100 - 训练损失: 0.3231 - 验证AUROC: 0.8764 - 验证AUPRC: 0.7979
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 14, 负样本 34
批次 200: 正样本 13, 负样本 35
本轮训练: 正样本 45 (31.25%), 负样本 99 (68.75%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.6790
处理批次 1/43, 累计样本数: 96, 批次损失: 0.7137
处理批次 2/43, 累计样本数: 144, 批次损失: 1.1466
处理批次 3/43, 累计样本数: 192, 批次损失: 0.5082
处理批次 4/43, 累计样本数: 240, 批次损失: 1.0901
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8857, AUPRC=0.7909
当前学习率: 0.000050
Epoch 44/100 - 训练损失: 0.3373 - 验证AUROC: 0.8857 - 验证AUPRC: 0.7909
批次 0: 正样本 19, 负样本 29
批次 100: 正样本 11, 负样本 37
批次 200: 正样本 17, 负样本 31
本轮训练: 正样本 47 (32.64%), 负样本 97 (67.36%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.6318
处理批次 1/43, 累计样本数: 96, 批次损失: 0.6906
处理批次 2/43, 累计样本数: 144, 批次损失: 0.7911
处理批次 3/43, 累计样本数: 192, 批次损失: 0.3975
处理批次 4/43, 累计样本数: 240, 批次损失: 1.3077
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8930, AUPRC=0.7946
当前学习率: 0.000050
保存最佳模型（轮次 45）到 result/DrugBAN3D_balanced_augment_20250609_211553/best_model.pth
Epoch 45/100 - 训练损失: 0.3204 - 验证AUROC: 0.8930 - 验证AUPRC: 0.7946
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 14, 负样本 34
批次 200: 正样本 15, 负样本 33
本轮训练: 正样本 47 (32.64%), 负样本 97 (67.36%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.6543
处理批次 1/43, 累计样本数: 96, 批次损失: 0.7300
处理批次 2/43, 累计样本数: 144, 批次损失: 1.0801
处理批次 3/43, 累计样本数: 192, 批次损失: 0.4248
处理批次 4/43, 累计样本数: 240, 批次损失: 1.1950
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8874, AUPRC=0.7769
当前学习率: 0.000050
Epoch 46/100 - 训练损失: 0.3106 - 验证AUROC: 0.8874 - 验证AUPRC: 0.7769
批次 0: 正样本 11, 负样本 37
批次 100: 正样本 17, 负样本 31
批次 200: 正样本 19, 负样本 29
本轮训练: 正样本 47 (32.64%), 负样本 97 (67.36%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.8441
处理批次 1/43, 累计样本数: 96, 批次损失: 0.6385
处理批次 2/43, 累计样本数: 144, 批次损失: 0.8720
处理批次 3/43, 累计样本数: 192, 批次损失: 0.5179
处理批次 4/43, 累计样本数: 240, 批次损失: 1.2656
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8877, AUPRC=0.7919
当前学习率: 0.000050
Epoch 47/100 - 训练损失: 0.3288 - 验证AUROC: 0.8877 - 验证AUPRC: 0.7919
批次 0: 正样本 17, 负样本 31
批次 100: 正样本 14, 负样本 34
批次 200: 正样本 14, 负样本 34
本轮训练: 正样本 45 (31.25%), 负样本 99 (68.75%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.9453
处理批次 1/43, 累计样本数: 96, 批次损失: 0.6848
处理批次 2/43, 累计样本数: 144, 批次损失: 1.1795
处理批次 3/43, 累计样本数: 192, 批次损失: 0.5562
处理批次 4/43, 累计样本数: 240, 批次损失: 1.0008
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8781, AUPRC=0.7821
当前学习率: 0.000050
Epoch 48/100 - 训练损失: 0.3320 - 验证AUROC: 0.8781 - 验证AUPRC: 0.7821
批次 0: 正样本 19, 负样本 29
批次 100: 正样本 14, 负样本 34
批次 200: 正样本 16, 负样本 32
本轮训练: 正样本 49 (34.03%), 负样本 95 (65.97%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.7793
处理批次 1/43, 累计样本数: 96, 批次损失: 0.7759
处理批次 2/43, 累计样本数: 144, 批次损失: 0.7472
处理批次 3/43, 累计样本数: 192, 批次损失: 0.4620
处理批次 4/43, 累计样本数: 240, 批次损失: 1.0851
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8860, AUPRC=0.7972
当前学习率: 0.000050
Epoch 49/100 - 训练损失: 0.3229 - 验证AUROC: 0.8860 - 验证AUPRC: 0.7972
批次 0: 正样本 17, 负样本 31
批次 100: 正样本 14, 负样本 34
批次 200: 正样本 18, 负样本 30
本轮训练: 正样本 49 (34.03%), 负样本 95 (65.97%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 1.3688
处理批次 1/43, 累计样本数: 96, 批次损失: 0.6863
处理批次 2/43, 累计样本数: 144, 批次损失: 1.0230
处理批次 3/43, 累计样本数: 192, 批次损失: 0.4003
处理批次 4/43, 累计样本数: 240, 批次损失: 0.9904
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8827, AUPRC=0.7785
Epoch 00050: reducing learning rate of group 0 to 2.5000e-05.
当前学习率: 0.000025
Epoch 50/100 - 训练损失: 0.3305 - 验证AUROC: 0.8827 - 验证AUPRC: 0.7785
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 17, 负样本 31
批次 200: 正样本 16, 负样本 32
本轮训练: 正样本 51 (35.42%), 负样本 93 (64.58%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.8760
处理批次 1/43, 累计样本数: 96, 批次损失: 0.6645
处理批次 2/43, 累计样本数: 144, 批次损失: 0.9253
处理批次 3/43, 累计样本数: 192, 批次损失: 0.3456
处理批次 4/43, 累计样本数: 240, 批次损失: 1.2714
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8925, AUPRC=0.7991
当前学习率: 0.000025
Epoch 51/100 - 训练损失: 0.2952 - 验证AUROC: 0.8925 - 验证AUPRC: 0.7991
批次 0: 正样本 11, 负样本 37
批次 100: 正样本 18, 负样本 30
批次 200: 正样本 12, 负样本 36
本轮训练: 正样本 41 (28.47%), 负样本 103 (71.53%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.9249
处理批次 1/43, 累计样本数: 96, 批次损失: 0.6443
处理批次 2/43, 累计样本数: 144, 批次损失: 1.0517
处理批次 3/43, 累计样本数: 192, 批次损失: 0.4369
处理批次 4/43, 累计样本数: 240, 批次损失: 1.3131
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8932, AUPRC=0.7981
当前学习率: 0.000025
保存最佳模型（轮次 52）到 result/DrugBAN3D_balanced_augment_20250609_211553/best_model.pth
Epoch 52/100 - 训练损失: 0.2996 - 验证AUROC: 0.8932 - 验证AUPRC: 0.7981
批次 0: 正样本 14, 负样本 34
批次 100: 正样本 17, 负样本 31
批次 200: 正样本 14, 负样本 34
本轮训练: 正样本 45 (31.25%), 负样本 99 (68.75%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.7728
处理批次 1/43, 累计样本数: 96, 批次损失: 0.5122
处理批次 2/43, 累计样本数: 144, 批次损失: 0.7821
处理批次 3/43, 累计样本数: 192, 批次损失: 0.3578
处理批次 4/43, 累计样本数: 240, 批次损失: 1.0847
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8969, AUPRC=0.8037
当前学习率: 0.000025
保存最佳模型（轮次 53）到 result/DrugBAN3D_balanced_augment_20250609_211553/best_model.pth
Epoch 53/100 - 训练损失: 0.2922 - 验证AUROC: 0.8969 - 验证AUPRC: 0.8037
批次 0: 正样本 11, 负样本 37
批次 100: 正样本 14, 负样本 34
批次 200: 正样本 21, 负样本 27
本轮训练: 正样本 46 (31.94%), 负样本 98 (68.06%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 1.0413
处理批次 1/43, 累计样本数: 96, 批次损失: 0.7481
处理批次 2/43, 累计样本数: 144, 批次损失: 1.1538
处理批次 3/43, 累计样本数: 192, 批次损失: 0.4155
处理批次 4/43, 累计样本数: 240, 批次损失: 2.9866
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8942, AUPRC=0.7964
当前学习率: 0.000025
Epoch 54/100 - 训练损失: 0.2894 - 验证AUROC: 0.8942 - 验证AUPRC: 0.7964
批次 0: 正样本 16, 负样本 32
批次 100: 正样本 21, 负样本 27
批次 200: 正样本 14, 负样本 34
本轮训练: 正样本 51 (35.42%), 负样本 93 (64.58%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.9621
处理批次 1/43, 累计样本数: 96, 批次损失: 0.7220
处理批次 2/43, 累计样本数: 144, 批次损失: 0.9875
处理批次 3/43, 累计样本数: 192, 批次损失: 0.8089
处理批次 4/43, 累计样本数: 240, 批次损失: 1.5393
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8913, AUPRC=0.7940
当前学习率: 0.000025
Epoch 55/100 - 训练损失: 0.2895 - 验证AUROC: 0.8913 - 验证AUPRC: 0.7940
批次 0: 正样本 16, 负样本 32
批次 100: 正样本 13, 负样本 35
批次 200: 正样本 17, 负样本 31
本轮训练: 正样本 46 (31.94%), 负样本 98 (68.06%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 1.0482
处理批次 1/43, 累计样本数: 96, 批次损失: 0.7546
处理批次 2/43, 累计样本数: 144, 批次损失: 1.0522
处理批次 3/43, 累计样本数: 192, 批次损失: 0.6158
处理批次 4/43, 累计样本数: 240, 批次损失: 1.2996
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8980, AUPRC=0.8067
当前学习率: 0.000025
保存最佳模型（轮次 56）到 result/DrugBAN3D_balanced_augment_20250609_211553/best_model.pth
Epoch 56/100 - 训练损失: 0.2898 - 验证AUROC: 0.8980 - 验证AUPRC: 0.8067
批次 0: 正样本 21, 负样本 27
批次 100: 正样本 18, 负样本 30
批次 200: 正样本 20, 负样本 28
本轮训练: 正样本 59 (40.97%), 负样本 85 (59.03%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.8249
处理批次 1/43, 累计样本数: 96, 批次损失: 0.6677
处理批次 2/43, 累计样本数: 144, 批次损失: 1.0296
处理批次 3/43, 累计样本数: 192, 批次损失: 0.3870
处理批次 4/43, 累计样本数: 240, 批次损失: 1.2156
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8991, AUPRC=0.8077
当前学习率: 0.000025
保存最佳模型（轮次 57）到 result/DrugBAN3D_balanced_augment_20250609_211553/best_model.pth
Epoch 57/100 - 训练损失: 0.2716 - 验证AUROC: 0.8991 - 验证AUPRC: 0.8077
批次 0: 正样本 17, 负样本 31
批次 100: 正样本 11, 负样本 37
批次 200: 正样本 14, 负样本 34
本轮训练: 正样本 42 (29.17%), 负样本 102 (70.83%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.7778
处理批次 1/43, 累计样本数: 96, 批次损失: 0.7159
处理批次 2/43, 累计样本数: 144, 批次损失: 0.9856
处理批次 3/43, 累计样本数: 192, 批次损失: 0.4010
处理批次 4/43, 累计样本数: 240, 批次损失: 1.0386
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8987, AUPRC=0.8062
当前学习率: 0.000025
Epoch 58/100 - 训练损失: 0.2799 - 验证AUROC: 0.8987 - 验证AUPRC: 0.8062
批次 0: 正样本 21, 负样本 27
批次 100: 正样本 18, 负样本 30
批次 200: 正样本 17, 负样本 31
本轮训练: 正样本 56 (38.89%), 负样本 88 (61.11%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.8109
处理批次 1/43, 累计样本数: 96, 批次损失: 0.5692
处理批次 2/43, 累计样本数: 144, 批次损失: 0.9597
处理批次 3/43, 累计样本数: 192, 批次损失: 0.3160
处理批次 4/43, 累计样本数: 240, 批次损失: 1.0083
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.9009, AUPRC=0.8111
当前学习率: 0.000025
保存最佳模型（轮次 59）到 result/DrugBAN3D_balanced_augment_20250609_211553/best_model.pth
Epoch 59/100 - 训练损失: 0.2736 - 验证AUROC: 0.9009 - 验证AUPRC: 0.8111
批次 0: 正样本 17, 负样本 31
批次 100: 正样本 14, 负样本 34
批次 200: 正样本 17, 负样本 31
本轮训练: 正样本 48 (33.33%), 负样本 96 (66.67%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.8463
处理批次 1/43, 累计样本数: 96, 批次损失: 0.7584
处理批次 2/43, 累计样本数: 144, 批次损失: 0.8933
处理批次 3/43, 累计样本数: 192, 批次损失: 0.7339
处理批次 4/43, 累计样本数: 240, 批次损失: 1.2053
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8924, AUPRC=0.7927
当前学习率: 0.000025
Epoch 60/100 - 训练损失: 0.2785 - 验证AUROC: 0.8924 - 验证AUPRC: 0.7927
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 17, 负样本 31
批次 200: 正样本 21, 负样本 27
本轮训练: 正样本 56 (38.89%), 负样本 88 (61.11%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.9235
处理批次 1/43, 累计样本数: 96, 批次损失: 0.7456
处理批次 2/43, 累计样本数: 144, 批次损失: 0.6559
处理批次 3/43, 累计样本数: 192, 批次损失: 0.5100
处理批次 4/43, 累计样本数: 240, 批次损失: 3.1719
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8877, AUPRC=0.7922
当前学习率: 0.000025
Epoch 61/100 - 训练损失: 0.2780 - 验证AUROC: 0.8877 - 验证AUPRC: 0.7922
批次 0: 正样本 15, 负样本 33
批次 100: 正样本 10, 负样本 38
批次 200: 正样本 17, 负样本 31
本轮训练: 正样本 42 (29.17%), 负样本 102 (70.83%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.7552
处理批次 1/43, 累计样本数: 96, 批次损失: 0.7568
处理批次 2/43, 累计样本数: 144, 批次损失: 0.9988
处理批次 3/43, 累计样本数: 192, 批次损失: 0.5942
处理批次 4/43, 累计样本数: 240, 批次损失: 3.0001
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8954, AUPRC=0.8030
当前学习率: 0.000025
Epoch 62/100 - 训练损失: 0.2936 - 验证AUROC: 0.8954 - 验证AUPRC: 0.8030
批次 0: 正样本 16, 负样本 32
批次 100: 正样本 15, 负样本 33
批次 200: 正样本 17, 负样本 31
本轮训练: 正样本 48 (33.33%), 负样本 96 (66.67%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.8718
处理批次 1/43, 累计样本数: 96, 批次损失: 0.5968
处理批次 2/43, 累计样本数: 144, 批次损失: 2.7854
处理批次 3/43, 累计样本数: 192, 批次损失: 0.6092
处理批次 4/43, 累计样本数: 240, 批次损失: 1.0824
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8924, AUPRC=0.8065
当前学习率: 0.000025
Epoch 63/100 - 训练损失: 0.2888 - 验证AUROC: 0.8924 - 验证AUPRC: 0.8065
批次 0: 正样本 13, 负样本 35
批次 100: 正样本 11, 负样本 37
批次 200: 正样本 14, 负样本 34
本轮训练: 正样本 38 (26.39%), 负样本 106 (73.61%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 1.1205
处理批次 1/43, 累计样本数: 96, 批次损失: 0.9358
处理批次 2/43, 累计样本数: 144, 批次损失: 1.0877
处理批次 3/43, 累计样本数: 192, 批次损失: 0.4174
处理批次 4/43, 累计样本数: 240, 批次损失: 1.6107
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8856, AUPRC=0.7776
Epoch 00064: reducing learning rate of group 0 to 1.2500e-05.
当前学习率: 0.000013
Epoch 64/100 - 训练损失: 0.2916 - 验证AUROC: 0.8856 - 验证AUPRC: 0.7776
批次 0: 正样本 13, 负样本 35
批次 100: 正样本 14, 负样本 34
批次 200: 正样本 19, 负样本 29
本轮训练: 正样本 46 (31.94%), 负样本 98 (68.06%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 1.1292
处理批次 1/43, 累计样本数: 96, 批次损失: 0.6784
处理批次 2/43, 累计样本数: 144, 批次损失: 2.9263
处理批次 3/43, 累计样本数: 192, 批次损失: 0.4183
处理批次 4/43, 累计样本数: 240, 批次损失: 1.1474
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8933, AUPRC=0.7978
当前学习率: 0.000013
Epoch 65/100 - 训练损失: 0.2770 - 验证AUROC: 0.8933 - 验证AUPRC: 0.7978
批次 0: 正样本 12, 负样本 36
批次 100: 正样本 19, 负样本 29
批次 200: 正样本 16, 负样本 32
本轮训练: 正样本 47 (32.64%), 负样本 97 (67.36%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 1.2368
处理批次 1/43, 累计样本数: 96, 批次损失: 0.8792
处理批次 2/43, 累计样本数: 144, 批次损失: 2.8168
处理批次 3/43, 累计样本数: 192, 批次损失: 0.3800
处理批次 4/43, 累计样本数: 240, 批次损失: 1.1352
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8976, AUPRC=0.8021
当前学习率: 0.000013
Epoch 66/100 - 训练损失: 0.2711 - 验证AUROC: 0.8976 - 验证AUPRC: 0.8021
批次 0: 正样本 13, 负样本 35
批次 100: 正样本 7, 负样本 41
批次 200: 正样本 19, 负样本 29
本轮训练: 正样本 39 (27.08%), 负样本 105 (72.92%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 1.0652
处理批次 1/43, 累计样本数: 96, 批次损失: 0.8050
处理批次 2/43, 累计样本数: 144, 批次损失: 1.0373
处理批次 3/43, 累计样本数: 192, 批次损失: 0.3899
处理批次 4/43, 累计样本数: 240, 批次损失: 0.9483
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8944, AUPRC=0.7926
当前学习率: 0.000013
Epoch 67/100 - 训练损失: 0.2644 - 验证AUROC: 0.8944 - 验证AUPRC: 0.7926
批次 0: 正样本 13, 负样本 35
批次 100: 正样本 16, 负样本 32
批次 200: 正样本 11, 负样本 37
本轮训练: 正样本 40 (27.78%), 负样本 104 (72.22%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.8791
处理批次 1/43, 累计样本数: 96, 批次损失: 0.7814
处理批次 2/43, 累计样本数: 144, 批次损失: 0.9581
处理批次 3/43, 累计样本数: 192, 批次损失: 0.4193
处理批次 4/43, 累计样本数: 240, 批次损失: 1.2678
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8947, AUPRC=0.8019
当前学习率: 0.000013
Epoch 68/100 - 训练损失: 0.2690 - 验证AUROC: 0.8947 - 验证AUPRC: 0.8019
批次 0: 正样本 13, 负样本 35
批次 100: 正样本 13, 负样本 35
批次 200: 正样本 17, 负样本 31
本轮训练: 正样本 43 (29.86%), 负样本 101 (70.14%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.7901
处理批次 1/43, 累计样本数: 96, 批次损失: 0.7358
处理批次 2/43, 累计样本数: 144, 批次损失: 2.7785
处理批次 3/43, 累计样本数: 192, 批次损失: 0.4016
处理批次 4/43, 累计样本数: 240, 批次损失: 1.2655
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8994, AUPRC=0.8063
Epoch 00069: reducing learning rate of group 0 to 6.2500e-06.
当前学习率: 0.000006
Epoch 69/100 - 训练损失: 0.2636 - 验证AUROC: 0.8994 - 验证AUPRC: 0.8063
批次 0: 正样本 19, 负样本 29
批次 100: 正样本 8, 负样本 40
批次 200: 正样本 19, 负样本 29
本轮训练: 正样本 46 (31.94%), 负样本 98 (68.06%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.8605
处理批次 1/43, 累计样本数: 96, 批次损失: 0.7393
处理批次 2/43, 累计样本数: 144, 批次损失: 0.9612
处理批次 3/43, 累计样本数: 192, 批次损失: 0.4331
处理批次 4/43, 累计样本数: 240, 批次损失: 1.1937
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8981, AUPRC=0.8105
当前学习率: 0.000006
Epoch 70/100 - 训练损失: 0.2470 - 验证AUROC: 0.8981 - 验证AUPRC: 0.8105
批次 0: 正样本 13, 负样本 35
批次 100: 正样本 12, 负样本 36
批次 200: 正样本 19, 负样本 29
本轮训练: 正样本 44 (30.56%), 负样本 100 (69.44%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.9106
处理批次 1/43, 累计样本数: 96, 批次损失: 0.6938
处理批次 2/43, 累计样本数: 144, 批次损失: 2.7610
处理批次 3/43, 累计样本数: 192, 批次损失: 0.3750
处理批次 4/43, 累计样本数: 240, 批次损失: 1.2218
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8988, AUPRC=0.8081
当前学习率: 0.000006
Epoch 71/100 - 训练损失: 0.2500 - 验证AUROC: 0.8988 - 验证AUPRC: 0.8081
批次 0: 正样本 13, 负样本 35
批次 100: 正样本 19, 负样本 29
批次 200: 正样本 14, 负样本 34
本轮训练: 正样本 46 (31.94%), 负样本 98 (68.06%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 1.0250
处理批次 1/43, 累计样本数: 96, 批次损失: 0.7086
处理批次 2/43, 累计样本数: 144, 批次损失: 2.8379
处理批次 3/43, 累计样本数: 192, 批次损失: 0.3744
处理批次 4/43, 累计样本数: 240, 批次损失: 1.2279
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8999, AUPRC=0.8118
当前学习率: 0.000006
Epoch 72/100 - 训练损失: 0.2442 - 验证AUROC: 0.8999 - 验证AUPRC: 0.8118
批次 0: 正样本 12, 负样本 36
批次 100: 正样本 19, 负样本 29
批次 200: 正样本 15, 负样本 33
本轮训练: 正样本 46 (31.94%), 负样本 98 (68.06%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 1.0089
处理批次 1/43, 累计样本数: 96, 批次损失: 0.6817
处理批次 2/43, 累计样本数: 144, 批次损失: 2.7311
处理批次 3/43, 累计样本数: 192, 批次损失: 0.3570
处理批次 4/43, 累计样本数: 240, 批次损失: 1.3803
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8995, AUPRC=0.8091
当前学习率: 0.000006
Epoch 73/100 - 训练损失: 0.2500 - 验证AUROC: 0.8995 - 验证AUPRC: 0.8091
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 15, 负样本 33
批次 200: 正样本 12, 负样本 36
本轮训练: 正样本 45 (31.25%), 负样本 99 (68.75%)
验证数据集大小: 43 批次
开始进行val评估...
处理批次 0/43, 累计样本数: 48, 批次损失: 0.8039
处理批次 1/43, 累计样本数: 96, 批次损失: 0.6998
处理批次 2/43, 累计样本数: 144, 批次损失: 2.7934
处理批次 3/43, 累计样本数: 192, 批次损失: 0.3656
处理批次 4/43, 累计样本数: 240, 批次损失: 1.3340
测试完成: 处理了 43/43 批次, 2034 个样本
错误批次数: 0
预测标签统计: 正样本数=656, 负样本数=1378
成功计算评估指标: AUROC=0.8961, AUPRC=0.8030
Epoch 00074: reducing learning rate of group 0 to 3.1250e-06.
当前学习率: 0.000003
早停触发！连续15轮验证集性能未提升
测试数据集大小: 22 批次
成功加载最佳模型状态（来自Epoch 59）
开始进行test评估...
处理批次 0/22, 累计样本数: 48, 批次损失: 0.6293
处理批次 1/22, 累计样本数: 96, 批次损失: 0.9637
处理批次 2/22, 累计样本数: 144, 批次损失: 0.8373
处理批次 3/22, 累计样本数: 192, 批次损失: 1.1345
处理批次 4/22, 累计样本数: 240, 批次损失: 1.0041
测试完成: 处理了 22/22 批次, 1039 个样本
错误批次数: 0
预测标签统计: 正样本数=336, 负样本数=703
成功计算评估指标: AUROC=0.8879, AUPRC=0.7843
最佳阈值: 0.0965, 对应的F1分数: 0.8136
混淆矩阵:
[[506 197]
 [ 41 295]]
详细测试结果: AUROC=0.8879, AUPRC=0.7843, F1=0.8136, 敏感度=0.7198, 特异度=0.8780, 准确率=0.7709, 精确度=0.5996
训练完成！最佳模型来自Epoch 59 - AUROC: 0.8879 - F1: 0.8136
结果已保存到: result/DrugBAN3D_balanced_augment_20250609_211553
训练完成时间: 2025年 06月 09日 星期一 23:54:02 CST
=== 训练总结 ===
训练成功完成！
结果保存在: result/DrugBAN3D_balanced_augment_20250609_211553
配置文件: result/DrugBAN3D_balanced_augment_20250609_211553/config/DrugBAN3D_augmented_20250609_211553.yaml
日志文件: result/DrugBAN3D_balanced_augment_20250609_211553/logs/train.log
保存的模型文件:
  result/DrugBAN3D_balanced_augment_20250609_211553/best_model.pth
