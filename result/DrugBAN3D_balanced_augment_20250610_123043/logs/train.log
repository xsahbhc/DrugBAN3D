
================================================================================
DrugBAN 数据增强与标签生成流程
================================================================================
开始时间: 2025-06-10 12:33:35
原始缓存目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/cached_graphs
增强缓存目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250610_123043
原始标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/labels.csv
训练标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/train_stratified.csv
验证标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/val_stratified.csv
测试标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv
增强标签目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250610_123043
是否增强测试集: 否
================================================================================

步骤1：执行数据增强...
读取标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/labels.csv
总样本数: 10436, 正样本数: 3369 (32.28%), 负样本数: 7067 (67.72%)
使用的增强类型: ['smart_conformational', 'binding_aware', 'adaptive_rotate']
正样本增强数量: 每个样本1.0次
负样本增强数量: 每个样本0.0次

数据增强完成! 耗时: 186.03秒
成功: 10398/10436 (99.64%)
失败记录已保存到 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250610_123043/augment_failures.txt
生成的文件总数: 13758
  原始文件数: 10398
  增强文件数: 3360
增强后样本总数: 13805 (期望值)
  正样本数: 6738 (48.81%)
  负样本数: 7067 (51.19%)
分布保持: 原始32.28% → 增强后48.81% (分布改变)

================================================================================
步骤2：为增强数据生成标签文件...
读取原始标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/labels.csv
原始标签文件包含 10436 条记录
使用预划分的测试集标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv
测试集包含 1044 条记录
测试集正样本率: 32.28%
正在从缓存目录 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250610_123043 中读取增强数据...
找到 13758 个缓存文件
从缓存文件中提取标签信息...
增强标签已保存至 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250610_123043/augmented_labels.csv，包含 13758 条记录
正样本: 6720 (48.84%), 负样本: 7038 (51.16%)
数据集划分: 训练集 7955 分子, 验证集 1404 分子, 测试集 1044 分子
验证集当前正样本率: 48.63%, 目标正样本率: 32.28%
调整验证集: 从902个正样本中抽样454个
调整后验证集正样本率: 32.27%
训练标签已保存至 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250610_123043/train_augmented.csv，包含 10528 条记录
验证标签已保存至 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250610_123043/valid_augmented.csv，包含 1407 条记录
测试标签已保存至 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250610_123043/test_augmented.csv，包含 1044 条记录
训练集: 总样本 10528, 正样本率 48.88%
验证集: 总样本 1407, 正样本率 32.27%
测试集: 总样本 1044, 正样本率 32.28%

================================================================================
数据增强与标签生成完成!
增强后的缓存文件保存在: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250610_123043
增强后的标签文件保存在: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250610_123043
结束时间: 2025-06-10 12:36:53
================================================================================

=== 详细配置信息 ===
配置文件: result/DrugBAN3D_balanced_augment_20250610_123043/config/DrugBAN3D_augmented_20250610_123043.yaml
训练数据: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250610_123043/train_augmented.csv
验证数据: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250610_123043/valid_augmented.csv
测试数据: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv
缓存目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250610_123043
结果目录: result/DrugBAN3D_balanced_augment_20250610_123043

=== 完整配置参数详览 ===
📋 训练参数 (TRAIN):
  TRAIN:
    D_LEARNING_RATE: 0.0004   # 最优判别器学习率（来自最佳实验）
    G_LEARNING_RATE: 0.0002   # 最优生成器学习率（来自最佳实验）
    BATCH_SIZE: 48  # 最佳batch size（来自最佳实验）
    D_STEPS_PER_G_STEP: 1
    RESUME_CHECKPOINT: ""
    EPOCH: 100  # 充足的训练轮数
    GRADIENT_ACCUMULATE_STEPS: 2  # 梯度累积，有效batch size = 48*2 = 96
    GRADIENT_CLIP_NORM: 1.0  # 梯度裁剪阈值（来自最佳实验）
    WEIGHT_DECAY: 0.0004  # 最优权重衰减（来自最佳实验）
    LABEL_SMOOTHING: 0.05  # 标签平滑参数（来自最佳实验）
    POS_WEIGHT: 1.05  # 正样本权重（来自最佳实验）

🏗️ GNN配置:
  GNN:
    HIDDEN_DIM: 384  # 最优GNN隐藏维度
    NUM_LAYERS: 4    # 最优GNN层数
  
  BCN:
    HEADS: 8  # 最优注意力头数量

🔧 解码器配置:
  DECODER:
    IN_DIM: 384
    HIDDEN_DIM: 512  # 最优解码器隐藏维度
    OUT_DIM: 128  # 最优解码器输出维度
    BINARY: 1
    DROPOUT: 0.3  # 最优Dropout率，平衡过拟合和欠拟合
  
  ADAPT:
    LAMBDA: 0.1

📊 损失函数配置:
  USE_BIAS_CORRECTION: True  # 启用偏置校正，提升模型稳定性
  USE_FOCAL_LOSS: True  # 使用焦点损失处理类别不平衡
  FOCAL_LOSS_GAMMA: 1.0  # 最优gamma值，温和的焦点损失
  FOCAL_LOSS_ALPHA: 0.3  # 最优alpha值，平衡正负样本

🌐 3D空间特征配置:
  SPATIAL_3D:
    ENABLE_SPATIAL_FUSION: true      # 启用3D空间感知特征融合 - 重要性能提升
    ENABLE_MULTISCALE: true          # 启用多尺度特征提取 - 捕获不同距离的相互作用
    DISTANCE_SCALES: [2.0, 5.0, 8.0]  # 最优多尺度距离阈值(Å)
    SPATIAL_DROPOUT: 0.1             # 最优空间模块Dropout率
    CROSS_ATTENTION_HEADS: 8         # 最优交叉注意力头数
  
  # 损失函数配置 - 最优设置
  USE_FOCAL_LOSS: True  # 使用焦点损失处理类别不平衡

⚙️ 求解器配置:
  SOLVER:
    MAX_EPOCH: 100  # 充足的训练轮数
    BATCH_SIZE: 48  # 最优batch size（来自最佳实验）
    USE_MIXED_PRECISION: False  # 不使用混合精度训练，保持稳定性
    LR_SCHEDULER: True  # 启用学习率调度器（来自最佳实验）
    LR_SCHEDULER_TYPE: "plateau"  # 最优学习率调度器（来自最佳实验）
    LR_WARMUP_EPOCHS: 4  # 最优学习率预热轮数（来自最佳实验）
    GRADIENT_CLIP_NORM: 1.0  # 梯度裁剪阈值（来自最佳实验）
    SEED: 42  # 固定随机种子保证可重现性
  
  RESULT:

⏹️ 早停配置:
  USE_EARLY_STOPPING: True
  EARLY_STOPPING_PATIENCE: 15  # 最优早停耐心值，避免过早停止

=========================

训练开始时间: 2025年 06月 10日 星期二 12:37:26 CST
使用命令行指定的输出目录: result/DrugBAN3D_balanced_augment_20250610_123043
已保存当前配置到 result/DrugBAN3D_balanced_augment_20250610_123043/config/config_used.yaml
配置文件: result/DrugBAN3D_balanced_augment_20250610_123043/config/DrugBAN3D_augmented_20250610_123043.yaml
输出目录: result/DrugBAN3D_balanced_augment_20250610_123043
运行设备: cuda
数据加载器使用 16 个工作线程
使用分层采样的预划分数据集
数据集: 训练集 10528 样本, 验证集 1407 样本, 测试集 1044 样本
正样本比例: 训练集 48.88%, 验证集 32.27%, 测试集 32.28%
使用增强数据集进行训练...
加载标签文件: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250610_123043/train_augmented.csv, 包含 10528 条记录
找到 10528/10528 个对应的缓存文件
数据集初始化完成，总样本数: 10528
训练/验证 数据集初始化完成: 10528 个样本
创建数据加载器成功: 预期 220 批次，批次大小 48
加载标签文件: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250610_123043/valid_augmented.csv, 包含 1407 条记录
找到 1407/1407 个对应的缓存文件
数据集初始化完成，总样本数: 1407
训练/验证 数据集初始化完成: 1407 个样本
创建数据加载器成功: 预期 30 批次，批次大小 48
测试模式: 使用原始测试数据
测试标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv
缓存目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/cached_graphs
测试标签文件包含 1044 条记录
测试集标签分布: 正样本 337 (32.28%), 负样本 707 (67.72%)
读取测试标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv, 包含 1044 条记录
成功创建测试标签映射，包含 2088 个条目
测试模式：从标签文件获取 2088 个复合物ID
测试模式：只处理标签文件中的 2088 个样本
在缓存目录中找到 1039/2088 个测试样本缓存文件
数据集初始化完成，总样本数: 1039
测试 数据集初始化完成: 1039 个样本
创建数据加载器成功: 预期 22 批次，批次大小 48

==================================================
DrugBAN3D初始化 - 偏差校正模块: 启用
Dropout率: 0.3
GNN层数: 4
==================================================

优化器: Adam, 学习率: 0.0002, L2正则化强度: 0.0004
启用标签平滑，参数值: 0.05
启用类别加权，正样本权重: 1.050
启用梯度裁剪，阈值：1.0
使用state_dict保存模型，避免完整对象复制
使用plateau学习率调度器
运行设备: cuda
启用标签平滑，参数值: 0.05
启用类别加权，正样本权重: 1.0499999523162842
使用ReduceLROnPlateau学习率调度器，监控验证集AUROC
开始训练...
批次 0: 正样本 26, 负样本 22
批次 100: 正样本 18, 负样本 30
批次 200: 正样本 28, 负样本 20
本轮训练: 正样本 72 (50.00%), 负样本 72 (50.00%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.7372
处理批次 1/30, 累计样本数: 96, 批次损失: 0.5973
处理批次 2/30, 累计样本数: 144, 批次损失: 0.6555
处理批次 3/30, 累计样本数: 192, 批次损失: 0.5974
处理批次 4/30, 累计样本数: 240, 批次损失: 0.6055
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.6482, AUPRC=0.4444
当前学习率: 0.000200
保存最佳模型（轮次 1）到 result/DrugBAN3D_balanced_augment_20250610_123043/best_model.pth
Epoch 1/100 - 训练损失: 2.4572 - 验证AUROC: 0.6482 - 验证AUPRC: 0.4444
批次 0: 正样本 20, 负样本 28
批次 100: 正样本 20, 负样本 28
批次 200: 正样本 20, 负样本 28
本轮训练: 正样本 60 (41.67%), 负样本 84 (58.33%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 5.0283
处理批次 1/30, 累计样本数: 96, 批次损失: 1.0615
处理批次 2/30, 累计样本数: 144, 批次损失: 0.8047
处理批次 3/30, 累计样本数: 192, 批次损失: 0.9418
处理批次 4/30, 累计样本数: 240, 批次损失: 0.8008
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.6445, AUPRC=0.4873
当前学习率: 0.000200
Epoch 2/100 - 训练损失: 1.6128 - 验证AUROC: 0.6445 - 验证AUPRC: 0.4873
批次 0: 正样本 26, 负样本 22
批次 100: 正样本 23, 负样本 25
批次 200: 正样本 27, 负样本 21
本轮训练: 正样本 76 (52.78%), 负样本 68 (47.22%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.6823
处理批次 1/30, 累计样本数: 96, 批次损失: 0.5988
处理批次 2/30, 累计样本数: 144, 批次损失: 0.6358
处理批次 3/30, 累计样本数: 192, 批次损失: 0.7115
处理批次 4/30, 累计样本数: 240, 批次损失: 0.5756
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.7482, AUPRC=0.5400
当前学习率: 0.000200
保存最佳模型（轮次 3）到 result/DrugBAN3D_balanced_augment_20250610_123043/best_model.pth
Epoch 3/100 - 训练损失: 1.4102 - 验证AUROC: 0.7482 - 验证AUPRC: 0.5400
批次 0: 正样本 24, 负样本 24
批次 100: 正样本 27, 负样本 21
批次 200: 正样本 23, 负样本 25
本轮训练: 正样本 74 (51.39%), 负样本 70 (48.61%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.6700
处理批次 1/30, 累计样本数: 96, 批次损失: 0.5468
处理批次 2/30, 累计样本数: 144, 批次损失: 0.9199
处理批次 3/30, 累计样本数: 192, 批次损失: 0.6269
处理批次 4/30, 累计样本数: 240, 批次损失: 0.8421
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.7590, AUPRC=0.5354
当前学习率: 0.000200
保存最佳模型（轮次 4）到 result/DrugBAN3D_balanced_augment_20250610_123043/best_model.pth
Epoch 4/100 - 训练损失: 1.4099 - 验证AUROC: 0.7590 - 验证AUPRC: 0.5354
批次 0: 正样本 20, 负样本 28
批次 100: 正样本 25, 负样本 23
批次 200: 正样本 19, 负样本 29
本轮训练: 正样本 64 (44.44%), 负样本 80 (55.56%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 4.6409
处理批次 1/30, 累计样本数: 96, 批次损失: 0.5983
处理批次 2/30, 累计样本数: 144, 批次损失: 0.6046
处理批次 3/30, 累计样本数: 192, 批次损失: 0.7959
处理批次 4/30, 累计样本数: 240, 批次损失: 0.6325
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.7968, AUPRC=0.6354
当前学习率: 0.000200
保存最佳模型（轮次 5）到 result/DrugBAN3D_balanced_augment_20250610_123043/best_model.pth
Epoch 5/100 - 训练损失: 1.2832 - 验证AUROC: 0.7968 - 验证AUPRC: 0.6354
批次 0: 正样本 23, 负样本 25
批次 100: 正样本 26, 负样本 22
批次 200: 正样本 22, 负样本 26
本轮训练: 正样本 71 (49.31%), 负样本 73 (50.69%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.5766
处理批次 1/30, 累计样本数: 96, 批次损失: 0.6483
处理批次 2/30, 累计样本数: 144, 批次损失: 0.7217
处理批次 3/30, 累计样本数: 192, 批次损失: 0.9184
处理批次 4/30, 累计样本数: 240, 批次损失: 0.7900
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.7723, AUPRC=0.5960
当前学习率: 0.000200
Epoch 6/100 - 训练损失: 1.3582 - 验证AUROC: 0.7723 - 验证AUPRC: 0.5960
批次 0: 正样本 27, 负样本 21
批次 100: 正样本 20, 负样本 28
批次 200: 正样本 22, 负样本 26
本轮训练: 正样本 69 (47.92%), 负样本 75 (52.08%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.6633
处理批次 1/30, 累计样本数: 96, 批次损失: 0.5871
处理批次 2/30, 累计样本数: 144, 批次损失: 0.6671
处理批次 3/30, 累计样本数: 192, 批次损失: 0.7053
处理批次 4/30, 累计样本数: 240, 批次损失: 0.6047
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.7746, AUPRC=0.6218
当前学习率: 0.000200
Epoch 7/100 - 训练损失: 1.2257 - 验证AUROC: 0.7746 - 验证AUPRC: 0.6218
批次 0: 正样本 24, 负样本 24
批次 100: 正样本 25, 负样本 23
批次 200: 正样本 21, 负样本 27
本轮训练: 正样本 70 (48.61%), 负样本 74 (51.39%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.5718
处理批次 1/30, 累计样本数: 96, 批次损失: 0.5705
处理批次 2/30, 累计样本数: 144, 批次损失: 0.6216
处理批次 3/30, 累计样本数: 192, 批次损失: 0.7184
处理批次 4/30, 累计样本数: 240, 批次损失: 0.5723
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.8193, AUPRC=0.6532
当前学习率: 0.000200
保存最佳模型（轮次 8）到 result/DrugBAN3D_balanced_augment_20250610_123043/best_model.pth
Epoch 8/100 - 训练损失: 1.1025 - 验证AUROC: 0.8193 - 验证AUPRC: 0.6532
批次 0: 正样本 16, 负样本 32
批次 100: 正样本 22, 负样本 26
批次 200: 正样本 24, 负样本 24
本轮训练: 正样本 62 (43.06%), 负样本 82 (56.94%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.7112
处理批次 1/30, 累计样本数: 96, 批次损失: 0.6038
处理批次 2/30, 累计样本数: 144, 批次损失: 0.6033
处理批次 3/30, 累计样本数: 192, 批次损失: 0.9349
处理批次 4/30, 累计样本数: 240, 批次损失: 0.7085
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.8083, AUPRC=0.6159
当前学习率: 0.000200
Epoch 9/100 - 训练损失: 0.9586 - 验证AUROC: 0.8083 - 验证AUPRC: 0.6159
批次 0: 正样本 21, 负样本 27
批次 100: 正样本 25, 负样本 23
批次 200: 正样本 25, 负样本 23
本轮训练: 正样本 71 (49.31%), 负样本 73 (50.69%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.5486
处理批次 1/30, 累计样本数: 96, 批次损失: 0.7236
处理批次 2/30, 累计样本数: 144, 批次损失: 0.9486
处理批次 3/30, 累计样本数: 192, 批次损失: 0.7545
处理批次 4/30, 累计样本数: 240, 批次损失: 0.6593
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.7530, AUPRC=0.6125
当前学习率: 0.000200
Epoch 10/100 - 训练损失: 0.9613 - 验证AUROC: 0.7530 - 验证AUPRC: 0.6125
批次 0: 正样本 22, 负样本 26
批次 100: 正样本 26, 负样本 22
批次 200: 正样本 18, 负样本 30
本轮训练: 正样本 66 (45.83%), 负样本 78 (54.17%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.6589
处理批次 1/30, 累计样本数: 96, 批次损失: 0.6642
处理批次 2/30, 累计样本数: 144, 批次损失: 0.6093
处理批次 3/30, 累计样本数: 192, 批次损失: 0.9440
处理批次 4/30, 累计样本数: 240, 批次损失: 0.5973
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.8458, AUPRC=0.6878
当前学习率: 0.000200
保存最佳模型（轮次 11）到 result/DrugBAN3D_balanced_augment_20250610_123043/best_model.pth
Epoch 11/100 - 训练损失: 0.8326 - 验证AUROC: 0.8458 - 验证AUPRC: 0.6878
批次 0: 正样本 20, 负样本 28
批次 100: 正样本 29, 负样本 19
批次 200: 正样本 23, 负样本 25
本轮训练: 正样本 72 (50.00%), 负样本 72 (50.00%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.7763
处理批次 1/30, 累计样本数: 96, 批次损失: 0.6292
处理批次 2/30, 累计样本数: 144, 批次损失: 0.7020
处理批次 3/30, 累计样本数: 192, 批次损失: 0.8815
处理批次 4/30, 累计样本数: 240, 批次损失: 0.9168
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.8359, AUPRC=0.6807
当前学习率: 0.000200
Epoch 12/100 - 训练损失: 0.7472 - 验证AUROC: 0.8359 - 验证AUPRC: 0.6807
批次 0: 正样本 26, 负样本 22
批次 100: 正样本 23, 负样本 25
批次 200: 正样本 24, 负样本 24
本轮训练: 正样本 73 (50.69%), 负样本 71 (49.31%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.7427
处理批次 1/30, 累计样本数: 96, 批次损失: 0.5891
处理批次 2/30, 累计样本数: 144, 批次损失: 0.6504
处理批次 3/30, 累计样本数: 192, 批次损失: 0.6585
处理批次 4/30, 累计样本数: 240, 批次损失: 0.6754
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.8546, AUPRC=0.7297
当前学习率: 0.000200
保存最佳模型（轮次 13）到 result/DrugBAN3D_balanced_augment_20250610_123043/best_model.pth
Epoch 13/100 - 训练损失: 0.7161 - 验证AUROC: 0.8546 - 验证AUPRC: 0.7297
批次 0: 正样本 28, 负样本 20
批次 100: 正样本 23, 负样本 25
批次 200: 正样本 16, 负样本 32
本轮训练: 正样本 67 (46.53%), 负样本 77 (53.47%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.8145
处理批次 1/30, 累计样本数: 96, 批次损失: 0.6768
处理批次 2/30, 累计样本数: 144, 批次损失: 0.7472
处理批次 3/30, 累计样本数: 192, 批次损失: 0.8690
处理批次 4/30, 累计样本数: 240, 批次损失: 0.6599
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.8603, AUPRC=0.7533
当前学习率: 0.000200
保存最佳模型（轮次 14）到 result/DrugBAN3D_balanced_augment_20250610_123043/best_model.pth
Epoch 14/100 - 训练损失: 0.6545 - 验证AUROC: 0.8603 - 验证AUPRC: 0.7533
批次 0: 正样本 19, 负样本 29
批次 100: 正样本 32, 负样本 16
批次 200: 正样本 20, 负样本 28
本轮训练: 正样本 71 (49.31%), 负样本 73 (50.69%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.5660
处理批次 1/30, 累计样本数: 96, 批次损失: 0.6112
处理批次 2/30, 累计样本数: 144, 批次损失: 0.6080
处理批次 3/30, 累计样本数: 192, 批次损失: 0.6774
处理批次 4/30, 累计样本数: 240, 批次损失: 0.7478
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.8468, AUPRC=0.7044
当前学习率: 0.000200
Epoch 15/100 - 训练损失: 0.6327 - 验证AUROC: 0.8468 - 验证AUPRC: 0.7044
批次 0: 正样本 28, 负样本 20
批次 100: 正样本 21, 负样本 27
批次 200: 正样本 24, 负样本 24
本轮训练: 正样本 73 (50.69%), 负样本 71 (49.31%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.7048
处理批次 1/30, 累计样本数: 96, 批次损失: 0.8070
处理批次 2/30, 累计样本数: 144, 批次损失: 0.5597
处理批次 3/30, 累计样本数: 192, 批次损失: 0.7010
处理批次 4/30, 累计样本数: 240, 批次损失: 0.6162
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.8625, AUPRC=0.7370
当前学习率: 0.000200
保存最佳模型（轮次 16）到 result/DrugBAN3D_balanced_augment_20250610_123043/best_model.pth
Epoch 16/100 - 训练损失: 0.5861 - 验证AUROC: 0.8625 - 验证AUPRC: 0.7370
批次 0: 正样本 20, 负样本 28
批次 100: 正样本 23, 负样本 25
批次 200: 正样本 19, 负样本 29
本轮训练: 正样本 62 (43.06%), 负样本 82 (56.94%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.7226
处理批次 1/30, 累计样本数: 96, 批次损失: 0.6219
处理批次 2/30, 累计样本数: 144, 批次损失: 0.5615
处理批次 3/30, 累计样本数: 192, 批次损失: 0.8565
处理批次 4/30, 累计样本数: 240, 批次损失: 0.5818
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.8664, AUPRC=0.7384
当前学习率: 0.000200
保存最佳模型（轮次 17）到 result/DrugBAN3D_balanced_augment_20250610_123043/best_model.pth
Epoch 17/100 - 训练损失: 0.5976 - 验证AUROC: 0.8664 - 验证AUPRC: 0.7384
批次 0: 正样本 19, 负样本 29
批次 100: 正样本 31, 负样本 17
批次 200: 正样本 20, 负样本 28
本轮训练: 正样本 70 (48.61%), 负样本 74 (51.39%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.9036
处理批次 1/30, 累计样本数: 96, 批次损失: 0.9543
处理批次 2/30, 累计样本数: 144, 批次损失: 0.6625
处理批次 3/30, 累计样本数: 192, 批次损失: 1.0234
处理批次 4/30, 累计样本数: 240, 批次损失: 0.6279
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.8624, AUPRC=0.7320
当前学习率: 0.000200
Epoch 18/100 - 训练损失: 0.5328 - 验证AUROC: 0.8624 - 验证AUPRC: 0.7320
批次 0: 正样本 24, 负样本 24
批次 100: 正样本 23, 负样本 25
批次 200: 正样本 21, 负样本 27
本轮训练: 正样本 68 (47.22%), 负样本 76 (52.78%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.7964
处理批次 1/30, 累计样本数: 96, 批次损失: 0.9788
处理批次 2/30, 累计样本数: 144, 批次损失: 0.6949
处理批次 3/30, 累计样本数: 192, 批次损失: 1.0623
处理批次 4/30, 累计样本数: 240, 批次损失: 0.7650
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.8542, AUPRC=0.7148
当前学习率: 0.000200
Epoch 19/100 - 训练损失: 0.5014 - 验证AUROC: 0.8542 - 验证AUPRC: 0.7148
批次 0: 正样本 25, 负样本 23
批次 100: 正样本 24, 负样本 24
批次 200: 正样本 26, 负样本 22
本轮训练: 正样本 75 (52.08%), 负样本 69 (47.92%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.8523
处理批次 1/30, 累计样本数: 96, 批次损失: 0.8043
处理批次 2/30, 累计样本数: 144, 批次损失: 0.6594
处理批次 3/30, 累计样本数: 192, 批次损失: 1.5486
处理批次 4/30, 累计样本数: 240, 批次损失: 0.6754
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.8717, AUPRC=0.7471
当前学习率: 0.000200
保存最佳模型（轮次 20）到 result/DrugBAN3D_balanced_augment_20250610_123043/best_model.pth
Epoch 20/100 - 训练损失: 0.4993 - 验证AUROC: 0.8717 - 验证AUPRC: 0.7471
批次 0: 正样本 23, 负样本 25
批次 100: 正样本 29, 负样本 19
批次 200: 正样本 27, 负样本 21
本轮训练: 正样本 79 (54.86%), 负样本 65 (45.14%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.9482
处理批次 1/30, 累计样本数: 96, 批次损失: 0.6961
处理批次 2/30, 累计样本数: 144, 批次损失: 0.6235
处理批次 3/30, 累计样本数: 192, 批次损失: 0.9335
处理批次 4/30, 累计样本数: 240, 批次损失: 0.5726
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.8819, AUPRC=0.7678
当前学习率: 0.000200
保存最佳模型（轮次 21）到 result/DrugBAN3D_balanced_augment_20250610_123043/best_model.pth
Epoch 21/100 - 训练损失: 0.4975 - 验证AUROC: 0.8819 - 验证AUPRC: 0.7678
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 26, 负样本 22
批次 200: 正样本 19, 负样本 29
本轮训练: 正样本 63 (43.75%), 负样本 81 (56.25%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.8396
处理批次 1/30, 累计样本数: 96, 批次损失: 0.7426
处理批次 2/30, 累计样本数: 144, 批次损失: 0.6466
处理批次 3/30, 累计样本数: 192, 批次损失: 1.2802
处理批次 4/30, 累计样本数: 240, 批次损失: 0.8122
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.8770, AUPRC=0.7685
当前学习率: 0.000200
Epoch 22/100 - 训练损失: 0.4464 - 验证AUROC: 0.8770 - 验证AUPRC: 0.7685
批次 0: 正样本 25, 负样本 23
批次 100: 正样本 23, 负样本 25
批次 200: 正样本 17, 负样本 31
本轮训练: 正样本 65 (45.14%), 负样本 79 (54.86%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.8161
处理批次 1/30, 累计样本数: 96, 批次损失: 0.7627
处理批次 2/30, 累计样本数: 144, 批次损失: 0.6550
处理批次 3/30, 累计样本数: 192, 批次损失: 1.2238
处理批次 4/30, 累计样本数: 240, 批次损失: 0.5899
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.8833, AUPRC=0.7786
当前学习率: 0.000200
保存最佳模型（轮次 23）到 result/DrugBAN3D_balanced_augment_20250610_123043/best_model.pth
Epoch 23/100 - 训练损失: 0.5048 - 验证AUROC: 0.8833 - 验证AUPRC: 0.7786
批次 0: 正样本 24, 负样本 24
批次 100: 正样本 20, 负样本 28
批次 200: 正样本 28, 负样本 20
本轮训练: 正样本 72 (50.00%), 负样本 72 (50.00%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.7791
处理批次 1/30, 累计样本数: 96, 批次损失: 0.7356
处理批次 2/30, 累计样本数: 144, 批次损失: 0.5557
处理批次 3/30, 累计样本数: 192, 批次损失: 0.6967
处理批次 4/30, 累计样本数: 240, 批次损失: 0.5636
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.8888, AUPRC=0.7980
当前学习率: 0.000200
保存最佳模型（轮次 24）到 result/DrugBAN3D_balanced_augment_20250610_123043/best_model.pth
Epoch 24/100 - 训练损失: 0.4480 - 验证AUROC: 0.8888 - 验证AUPRC: 0.7980
批次 0: 正样本 21, 负样本 27
批次 100: 正样本 28, 负样本 20
批次 200: 正样本 25, 负样本 23
本轮训练: 正样本 74 (51.39%), 负样本 70 (48.61%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.8485
处理批次 1/30, 累计样本数: 96, 批次损失: 0.6317
处理批次 2/30, 累计样本数: 144, 批次损失: 0.6030
处理批次 3/30, 累计样本数: 192, 批次损失: 1.2427
处理批次 4/30, 累计样本数: 240, 批次损失: 0.5303
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.8865, AUPRC=0.7860
当前学习率: 0.000200
Epoch 25/100 - 训练损失: 0.4213 - 验证AUROC: 0.8865 - 验证AUPRC: 0.7860
批次 0: 正样本 21, 负样本 27
批次 100: 正样本 18, 负样本 30
批次 200: 正样本 21, 负样本 27
本轮训练: 正样本 60 (41.67%), 负样本 84 (58.33%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.0405
处理批次 1/30, 累计样本数: 96, 批次损失: 0.6711
处理批次 2/30, 累计样本数: 144, 批次损失: 0.6854
处理批次 3/30, 累计样本数: 192, 批次损失: 1.0584
处理批次 4/30, 累计样本数: 240, 批次损失: 0.6201
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.8763, AUPRC=0.7680
当前学习率: 0.000200
Epoch 26/100 - 训练损失: 0.4233 - 验证AUROC: 0.8763 - 验证AUPRC: 0.7680
批次 0: 正样本 28, 负样本 20
批次 100: 正样本 27, 负样本 21
批次 200: 正样本 24, 负样本 24
本轮训练: 正样本 79 (54.86%), 负样本 65 (45.14%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.0317
处理批次 1/30, 累计样本数: 96, 批次损失: 0.7584
处理批次 2/30, 累计样本数: 144, 批次损失: 0.6122
处理批次 3/30, 累计样本数: 192, 批次损失: 1.4431
处理批次 4/30, 累计样本数: 240, 批次损失: 0.5526
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.8923, AUPRC=0.7921
当前学习率: 0.000200
保存最佳模型（轮次 27）到 result/DrugBAN3D_balanced_augment_20250610_123043/best_model.pth
Epoch 27/100 - 训练损失: 0.4266 - 验证AUROC: 0.8923 - 验证AUPRC: 0.7921
批次 0: 正样本 26, 负样本 22
批次 100: 正样本 23, 负样本 25
批次 200: 正样本 20, 负样本 28
本轮训练: 正样本 69 (47.92%), 负样本 75 (52.08%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.8689
处理批次 1/30, 累计样本数: 96, 批次损失: 0.5827
处理批次 2/30, 累计样本数: 144, 批次损失: 0.5831
处理批次 3/30, 累计样本数: 192, 批次损失: 1.5486
处理批次 4/30, 累计样本数: 240, 批次损失: 0.5653
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.8783, AUPRC=0.7754
当前学习率: 0.000200
Epoch 28/100 - 训练损失: 0.4013 - 验证AUROC: 0.8783 - 验证AUPRC: 0.7754
批次 0: 正样本 22, 负样本 26
批次 100: 正样本 25, 负样本 23
批次 200: 正样本 20, 负样本 28
本轮训练: 正样本 67 (46.53%), 负样本 77 (53.47%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.8406
处理批次 1/30, 累计样本数: 96, 批次损失: 0.7702
处理批次 2/30, 累计样本数: 144, 批次损失: 0.5998
处理批次 3/30, 累计样本数: 192, 批次损失: 2.2990
处理批次 4/30, 累计样本数: 240, 批次损失: 0.6855
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.8909, AUPRC=0.8029
当前学习率: 0.000200
Epoch 29/100 - 训练损失: 0.3865 - 验证AUROC: 0.8909 - 验证AUPRC: 0.8029
批次 0: 正样本 29, 负样本 19
批次 100: 正样本 22, 负样本 26
批次 200: 正样本 26, 负样本 22
本轮训练: 正样本 77 (53.47%), 负样本 67 (46.53%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.0202
处理批次 1/30, 累计样本数: 96, 批次损失: 0.8100
处理批次 2/30, 累计样本数: 144, 批次损失: 0.8315
处理批次 3/30, 累计样本数: 192, 批次损失: 1.6233
处理批次 4/30, 累计样本数: 240, 批次损失: 0.7318
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.8787, AUPRC=0.7668
当前学习率: 0.000200
Epoch 30/100 - 训练损失: 0.4285 - 验证AUROC: 0.8787 - 验证AUPRC: 0.7668
批次 0: 正样本 21, 负样本 27
批次 100: 正样本 31, 负样本 17
批次 200: 正样本 25, 负样本 23
本轮训练: 正样本 77 (53.47%), 负样本 67 (46.53%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.7995
处理批次 1/30, 累计样本数: 96, 批次损失: 0.7452
处理批次 2/30, 累计样本数: 144, 批次损失: 0.7403
处理批次 3/30, 累计样本数: 192, 批次损失: 2.2047
处理批次 4/30, 累计样本数: 240, 批次损失: 0.7336
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.8969, AUPRC=0.7991
当前学习率: 0.000200
保存最佳模型（轮次 31）到 result/DrugBAN3D_balanced_augment_20250610_123043/best_model.pth
Epoch 31/100 - 训练损失: 0.3608 - 验证AUROC: 0.8969 - 验证AUPRC: 0.7991
批次 0: 正样本 28, 负样本 20
批次 100: 正样本 20, 负样本 28
批次 200: 正样本 24, 负样本 24
本轮训练: 正样本 72 (50.00%), 负样本 72 (50.00%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.0677
处理批次 1/30, 累计样本数: 96, 批次损失: 0.7269
处理批次 2/30, 累计样本数: 144, 批次损失: 0.7689
处理批次 3/30, 累计样本数: 192, 批次损失: 2.1404
处理批次 4/30, 累计样本数: 240, 批次损失: 0.5605
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.8829, AUPRC=0.7787
当前学习率: 0.000200
Epoch 32/100 - 训练损失: 0.4117 - 验证AUROC: 0.8829 - 验证AUPRC: 0.7787
批次 0: 正样本 22, 负样本 26
批次 100: 正样本 25, 负样本 23
批次 200: 正样本 27, 负样本 21
本轮训练: 正样本 74 (51.39%), 负样本 70 (48.61%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.0644
处理批次 1/30, 累计样本数: 96, 批次损失: 0.6775
处理批次 2/30, 累计样本数: 144, 批次损失: 0.6466
处理批次 3/30, 累计样本数: 192, 批次损失: 1.4733
处理批次 4/30, 累计样本数: 240, 批次损失: 0.7151
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.8862, AUPRC=0.7763
当前学习率: 0.000200
Epoch 33/100 - 训练损失: 0.3994 - 验证AUROC: 0.8862 - 验证AUPRC: 0.7763
批次 0: 正样本 26, 负样本 22
批次 100: 正样本 26, 负样本 22
批次 200: 正样本 20, 负样本 28
本轮训练: 正样本 72 (50.00%), 负样本 72 (50.00%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.8692
处理批次 1/30, 累计样本数: 96, 批次损失: 0.9357
处理批次 2/30, 累计样本数: 144, 批次损失: 0.6680
处理批次 3/30, 累计样本数: 192, 批次损失: 1.5409
处理批次 4/30, 累计样本数: 240, 批次损失: 0.7989
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.8947, AUPRC=0.8074
当前学习率: 0.000200
Epoch 34/100 - 训练损失: 0.3665 - 验证AUROC: 0.8947 - 验证AUPRC: 0.8074
批次 0: 正样本 22, 负样本 26
批次 100: 正样本 31, 负样本 17
批次 200: 正样本 26, 负样本 22
本轮训练: 正样本 79 (54.86%), 负样本 65 (45.14%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.7027
处理批次 1/30, 累计样本数: 96, 批次损失: 0.9308
处理批次 2/30, 累计样本数: 144, 批次损失: 0.8276
处理批次 3/30, 累计样本数: 192, 批次损失: 2.7103
处理批次 4/30, 累计样本数: 240, 批次损失: 0.5366
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.9010, AUPRC=0.8213
当前学习率: 0.000200
保存最佳模型（轮次 35）到 result/DrugBAN3D_balanced_augment_20250610_123043/best_model.pth
Epoch 35/100 - 训练损失: 0.3572 - 验证AUROC: 0.9010 - 验证AUPRC: 0.8213
批次 0: 正样本 30, 负样本 18
批次 100: 正样本 21, 负样本 27
批次 200: 正样本 29, 负样本 19
本轮训练: 正样本 80 (55.56%), 负样本 64 (44.44%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.9706
处理批次 1/30, 累计样本数: 96, 批次损失: 0.7885
处理批次 2/30, 累计样本数: 144, 批次损失: 0.9564
处理批次 3/30, 累计样本数: 192, 批次损失: 1.5227
处理批次 4/30, 累计样本数: 240, 批次损失: 0.5356
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.8927, AUPRC=0.7846
当前学习率: 0.000200
Epoch 36/100 - 训练损失: 0.3566 - 验证AUROC: 0.8927 - 验证AUPRC: 0.7846
批次 0: 正样本 29, 负样本 19
批次 100: 正样本 26, 负样本 22
批次 200: 正样本 26, 负样本 22
本轮训练: 正样本 81 (56.25%), 负样本 63 (43.75%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.3463
处理批次 1/30, 累计样本数: 96, 批次损失: 1.0810
处理批次 2/30, 累计样本数: 144, 批次损失: 0.8265
处理批次 3/30, 累计样本数: 192, 批次损失: 3.0341
处理批次 4/30, 累计样本数: 240, 批次损失: 0.7962
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.8852, AUPRC=0.7744
当前学习率: 0.000200
Epoch 37/100 - 训练损失: 0.3761 - 验证AUROC: 0.8852 - 验证AUPRC: 0.7744
批次 0: 正样本 29, 负样本 19
批次 100: 正样本 18, 负样本 30
批次 200: 正样本 22, 负样本 26
本轮训练: 正样本 69 (47.92%), 负样本 75 (52.08%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.6514
处理批次 1/30, 累计样本数: 96, 批次损失: 0.6498
处理批次 2/30, 累计样本数: 144, 批次损失: 0.8014
处理批次 3/30, 累计样本数: 192, 批次损失: 2.4463
处理批次 4/30, 累计样本数: 240, 批次损失: 0.6589
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.8877, AUPRC=0.7795
当前学习率: 0.000200
Epoch 38/100 - 训练损失: 0.3445 - 验证AUROC: 0.8877 - 验证AUPRC: 0.7795
批次 0: 正样本 30, 负样本 18
批次 100: 正样本 21, 负样本 27
批次 200: 正样本 19, 负样本 29
本轮训练: 正样本 70 (48.61%), 负样本 74 (51.39%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.0599
处理批次 1/30, 累计样本数: 96, 批次损失: 1.0289
处理批次 2/30, 累计样本数: 144, 批次损失: 0.9688
处理批次 3/30, 累计样本数: 192, 批次损失: 1.7278
处理批次 4/30, 累计样本数: 240, 批次损失: 0.9217
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.8813, AUPRC=0.7569
当前学习率: 0.000200
Epoch 39/100 - 训练损失: 0.3406 - 验证AUROC: 0.8813 - 验证AUPRC: 0.7569
批次 0: 正样本 22, 负样本 26
批次 100: 正样本 30, 负样本 18
批次 200: 正样本 25, 负样本 23
本轮训练: 正样本 77 (53.47%), 负样本 67 (46.53%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.0488
处理批次 1/30, 累计样本数: 96, 批次损失: 0.7929
处理批次 2/30, 累计样本数: 144, 批次损失: 0.9660
处理批次 3/30, 累计样本数: 192, 批次损失: 2.0385
处理批次 4/30, 累计样本数: 240, 批次损失: 0.6211
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.8834, AUPRC=0.7703
Epoch 00040: reducing learning rate of group 0 to 1.0000e-04.
当前学习率: 0.000100
Epoch 40/100 - 训练损失: 0.3456 - 验证AUROC: 0.8834 - 验证AUPRC: 0.7703
批次 0: 正样本 20, 负样本 28
批次 100: 正样本 25, 负样本 23
批次 200: 正样本 25, 负样本 23
本轮训练: 正样本 70 (48.61%), 负样本 74 (51.39%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.8873
处理批次 1/30, 累计样本数: 96, 批次损失: 0.7299
处理批次 2/30, 累计样本数: 144, 批次损失: 0.8389
处理批次 3/30, 累计样本数: 192, 批次损失: 1.7666
处理批次 4/30, 累计样本数: 240, 批次损失: 0.7693
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.8956, AUPRC=0.8006
当前学习率: 0.000100
Epoch 41/100 - 训练损失: 0.2958 - 验证AUROC: 0.8956 - 验证AUPRC: 0.8006
批次 0: 正样本 29, 负样本 19
批次 100: 正样本 27, 负样本 21
批次 200: 正样本 20, 负样本 28
本轮训练: 正样本 76 (52.78%), 负样本 68 (47.22%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.0295
处理批次 1/30, 累计样本数: 96, 批次损失: 0.7989
处理批次 2/30, 累计样本数: 144, 批次损失: 0.8776
处理批次 3/30, 累计样本数: 192, 批次损失: 1.7535
处理批次 4/30, 累计样本数: 240, 批次损失: 0.7172
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.8979, AUPRC=0.7842
当前学习率: 0.000100
Epoch 42/100 - 训练损失: 0.2802 - 验证AUROC: 0.8979 - 验证AUPRC: 0.7842
批次 0: 正样本 28, 负样本 20
批次 100: 正样本 24, 负样本 24
批次 200: 正样本 21, 负样本 27
本轮训练: 正样本 73 (50.69%), 负样本 71 (49.31%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.9112
处理批次 1/30, 累计样本数: 96, 批次损失: 0.8893
处理批次 2/30, 累计样本数: 144, 批次损失: 0.7891
处理批次 3/30, 累计样本数: 192, 批次损失: 1.6299
处理批次 4/30, 累计样本数: 240, 批次损失: 0.7318
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.8998, AUPRC=0.8116
当前学习率: 0.000100
Epoch 43/100 - 训练损失: 0.2711 - 验证AUROC: 0.8998 - 验证AUPRC: 0.8116
批次 0: 正样本 24, 负样本 24
批次 100: 正样本 18, 负样本 30
批次 200: 正样本 21, 负样本 27
本轮训练: 正样本 63 (43.75%), 负样本 81 (56.25%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.1065
处理批次 1/30, 累计样本数: 96, 批次损失: 0.8517
处理批次 2/30, 累计样本数: 144, 批次损失: 0.7814
处理批次 3/30, 累计样本数: 192, 批次损失: 2.8753
处理批次 4/30, 累计样本数: 240, 批次损失: 0.7841
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.9014, AUPRC=0.8110
当前学习率: 0.000100
保存最佳模型（轮次 44）到 result/DrugBAN3D_balanced_augment_20250610_123043/best_model.pth
Epoch 44/100 - 训练损失: 0.2652 - 验证AUROC: 0.9014 - 验证AUPRC: 0.8110
批次 0: 正样本 32, 负样本 16
批次 100: 正样本 21, 负样本 27
批次 200: 正样本 23, 负样本 25
本轮训练: 正样本 76 (52.78%), 负样本 68 (47.22%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.1281
处理批次 1/30, 累计样本数: 96, 批次损失: 1.2178
处理批次 2/30, 累计样本数: 144, 批次损失: 0.8822
处理批次 3/30, 累计样本数: 192, 批次损失: 4.6898
处理批次 4/30, 累计样本数: 240, 批次损失: 0.7556
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.8981, AUPRC=0.8042
Epoch 00045: reducing learning rate of group 0 to 5.0000e-05.
当前学习率: 0.000050
Epoch 45/100 - 训练损失: 0.2721 - 验证AUROC: 0.8981 - 验证AUPRC: 0.8042
批次 0: 正样本 21, 负样本 27
批次 100: 正样本 29, 负样本 19
批次 200: 正样本 18, 负样本 30
本轮训练: 正样本 68 (47.22%), 负样本 76 (52.78%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.9416
处理批次 1/30, 累计样本数: 96, 批次损失: 0.8298
处理批次 2/30, 累计样本数: 144, 批次损失: 0.8345
处理批次 3/30, 累计样本数: 192, 批次损失: 2.7493
处理批次 4/30, 累计样本数: 240, 批次损失: 0.6106
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.9053, AUPRC=0.8158
当前学习率: 0.000050
保存最佳模型（轮次 46）到 result/DrugBAN3D_balanced_augment_20250610_123043/best_model.pth
Epoch 46/100 - 训练损失: 0.2506 - 验证AUROC: 0.9053 - 验证AUPRC: 0.8158
批次 0: 正样本 21, 负样本 27
批次 100: 正样本 20, 负样本 28
批次 200: 正样本 27, 负样本 21
本轮训练: 正样本 68 (47.22%), 负样本 76 (52.78%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.0421
处理批次 1/30, 累计样本数: 96, 批次损失: 0.8095
处理批次 2/30, 累计样本数: 144, 批次损失: 0.9105
处理批次 3/30, 累计样本数: 192, 批次损失: 2.9392
处理批次 4/30, 累计样本数: 240, 批次损失: 0.8521
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.9046, AUPRC=0.8173
当前学习率: 0.000050
Epoch 47/100 - 训练损失: 0.2264 - 验证AUROC: 0.9046 - 验证AUPRC: 0.8173
批次 0: 正样本 25, 负样本 23
批次 100: 正样本 23, 负样本 25
批次 200: 正样本 28, 负样本 20
本轮训练: 正样本 76 (52.78%), 负样本 68 (47.22%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.8724
处理批次 1/30, 累计样本数: 96, 批次损失: 0.7924
处理批次 2/30, 累计样本数: 144, 批次损失: 0.8221
处理批次 3/30, 累计样本数: 192, 批次损失: 2.4123
处理批次 4/30, 累计样本数: 240, 批次损失: 0.6928
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.9024, AUPRC=0.8057
当前学习率: 0.000050
Epoch 48/100 - 训练损失: 0.2286 - 验证AUROC: 0.9024 - 验证AUPRC: 0.8057
批次 0: 正样本 27, 负样本 21
批次 100: 正样本 24, 负样本 24
批次 200: 正样本 23, 负样本 25
本轮训练: 正样本 74 (51.39%), 负样本 70 (48.61%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.0022
处理批次 1/30, 累计样本数: 96, 批次损失: 0.8545
处理批次 2/30, 累计样本数: 144, 批次损失: 0.8545
处理批次 3/30, 累计样本数: 192, 批次损失: 2.3748
处理批次 4/30, 累计样本数: 240, 批次损失: 0.6995
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.9090, AUPRC=0.8125
当前学习率: 0.000050
保存最佳模型（轮次 49）到 result/DrugBAN3D_balanced_augment_20250610_123043/best_model.pth
Epoch 49/100 - 训练损失: 0.2106 - 验证AUROC: 0.9090 - 验证AUPRC: 0.8125
批次 0: 正样本 24, 负样本 24
批次 100: 正样本 28, 负样本 20
批次 200: 正样本 22, 负样本 26
本轮训练: 正样本 74 (51.39%), 负样本 70 (48.61%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.7720
处理批次 1/30, 累计样本数: 96, 批次损失: 0.8882
处理批次 2/30, 累计样本数: 144, 批次损失: 0.8237
处理批次 3/30, 累计样本数: 192, 批次损失: 2.8287
处理批次 4/30, 累计样本数: 240, 批次损失: 0.7430
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.9067, AUPRC=0.8122
当前学习率: 0.000050
Epoch 50/100 - 训练损失: 0.2259 - 验证AUROC: 0.9067 - 验证AUPRC: 0.8122
批次 0: 正样本 21, 负样本 27
批次 100: 正样本 23, 负样本 25
批次 200: 正样本 30, 负样本 18
本轮训练: 正样本 74 (51.39%), 负样本 70 (48.61%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.9145
处理批次 1/30, 累计样本数: 96, 批次损失: 0.8818
处理批次 2/30, 累计样本数: 144, 批次损失: 1.0352
处理批次 3/30, 累计样本数: 192, 批次损失: 2.9272
处理批次 4/30, 累计样本数: 240, 批次损失: 0.8333
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.9011, AUPRC=0.8046
当前学习率: 0.000050
Epoch 51/100 - 训练损失: 0.2103 - 验证AUROC: 0.9011 - 验证AUPRC: 0.8046
批次 0: 正样本 22, 负样本 26
批次 100: 正样本 21, 负样本 27
批次 200: 正样本 21, 负样本 27
本轮训练: 正样本 64 (44.44%), 负样本 80 (55.56%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.8619
处理批次 1/30, 累计样本数: 96, 批次损失: 0.8005
处理批次 2/30, 累计样本数: 144, 批次损失: 1.0484
处理批次 3/30, 累计样本数: 192, 批次损失: 2.8137
处理批次 4/30, 累计样本数: 240, 批次损失: 0.7344
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.9002, AUPRC=0.8132
当前学习率: 0.000050
Epoch 52/100 - 训练损失: 0.2089 - 验证AUROC: 0.9002 - 验证AUPRC: 0.8132
批次 0: 正样本 20, 负样本 28
批次 100: 正样本 24, 负样本 24
批次 200: 正样本 21, 负样本 27
本轮训练: 正样本 65 (45.14%), 负样本 79 (54.86%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.9657
处理批次 1/30, 累计样本数: 96, 批次损失: 0.7917
处理批次 2/30, 累计样本数: 144, 批次损失: 0.9343
处理批次 3/30, 累计样本数: 192, 批次损失: 2.9936
处理批次 4/30, 累计样本数: 240, 批次损失: 0.8256
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.9032, AUPRC=0.8121
当前学习率: 0.000050
Epoch 53/100 - 训练损失: 0.2136 - 验证AUROC: 0.9032 - 验证AUPRC: 0.8121
批次 0: 正样本 27, 负样本 21
批次 100: 正样本 27, 负样本 21
批次 200: 正样本 24, 负样本 24
本轮训练: 正样本 78 (54.17%), 负样本 66 (45.83%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.0447
处理批次 1/30, 累计样本数: 96, 批次损失: 0.7692
处理批次 2/30, 累计样本数: 144, 批次损失: 2.9352
处理批次 3/30, 累计样本数: 192, 批次损失: 2.4985
处理批次 4/30, 累计样本数: 240, 批次损失: 0.7451
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.9061, AUPRC=0.8044
Epoch 00054: reducing learning rate of group 0 to 2.5000e-05.
当前学习率: 0.000025
Epoch 54/100 - 训练损失: 0.2073 - 验证AUROC: 0.9061 - 验证AUPRC: 0.8044
批次 0: 正样本 29, 负样本 19
批次 100: 正样本 30, 负样本 18
批次 200: 正样本 21, 负样本 27
本轮训练: 正样本 80 (55.56%), 负样本 64 (44.44%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.1171
处理批次 1/30, 累计样本数: 96, 批次损失: 0.8762
处理批次 2/30, 累计样本数: 144, 批次损失: 1.1500
处理批次 3/30, 累计样本数: 192, 批次损失: 4.8515
处理批次 4/30, 累计样本数: 240, 批次损失: 0.8258
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.9084, AUPRC=0.8147
当前学习率: 0.000025
Epoch 55/100 - 训练损失: 0.1969 - 验证AUROC: 0.9084 - 验证AUPRC: 0.8147
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 21, 负样本 27
批次 200: 正样本 17, 负样本 31
本轮训练: 正样本 56 (38.89%), 负样本 88 (61.11%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.9855
处理批次 1/30, 累计样本数: 96, 批次损失: 0.8620
处理批次 2/30, 累计样本数: 144, 批次损失: 0.9681
处理批次 3/30, 累计样本数: 192, 批次损失: 4.6905
处理批次 4/30, 累计样本数: 240, 批次损失: 0.7280
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.9056, AUPRC=0.8076
当前学习率: 0.000025
Epoch 56/100 - 训练损失: 0.1850 - 验证AUROC: 0.9056 - 验证AUPRC: 0.8076
批次 0: 正样本 25, 负样本 23
批次 100: 正样本 18, 负样本 30
批次 200: 正样本 26, 负样本 22
本轮训练: 正样本 69 (47.92%), 负样本 75 (52.08%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.1414
处理批次 1/30, 累计样本数: 96, 批次损失: 1.1188
处理批次 2/30, 累计样本数: 144, 批次损失: 1.1033
处理批次 3/30, 累计样本数: 192, 批次损失: 4.7639
处理批次 4/30, 累计样本数: 240, 批次损失: 0.9217
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.9017, AUPRC=0.8047
当前学习率: 0.000025
Epoch 57/100 - 训练损失: 0.1843 - 验证AUROC: 0.9017 - 验证AUPRC: 0.8047
批次 0: 正样本 28, 负样本 20
批次 100: 正样本 22, 负样本 26
批次 200: 正样本 23, 负样本 25
本轮训练: 正样本 73 (50.69%), 负样本 71 (49.31%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.0703
处理批次 1/30, 累计样本数: 96, 批次损失: 0.9889
处理批次 2/30, 累计样本数: 144, 批次损失: 1.0708
处理批次 3/30, 累计样本数: 192, 批次损失: 4.4927
处理批次 4/30, 累计样本数: 240, 批次损失: 0.7669
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.9057, AUPRC=0.8145
当前学习率: 0.000025
Epoch 58/100 - 训练损失: 0.1794 - 验证AUROC: 0.9057 - 验证AUPRC: 0.8145
批次 0: 正样本 21, 负样本 27
批次 100: 正样本 23, 负样本 25
批次 200: 正样本 31, 负样本 17
本轮训练: 正样本 75 (52.08%), 负样本 69 (47.92%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.0384
处理批次 1/30, 累计样本数: 96, 批次损失: 1.0587
处理批次 2/30, 累计样本数: 144, 批次损失: 1.0020
处理批次 3/30, 累计样本数: 192, 批次损失: 3.0483
处理批次 4/30, 累计样本数: 240, 批次损失: 1.0000
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.9013, AUPRC=0.8049
Epoch 00059: reducing learning rate of group 0 to 1.2500e-05.
当前学习率: 0.000013
Epoch 59/100 - 训练损失: 0.1829 - 验证AUROC: 0.9013 - 验证AUPRC: 0.8049
批次 0: 正样本 23, 负样本 25
批次 100: 正样本 22, 负样本 26
批次 200: 正样本 26, 负样本 22
本轮训练: 正样本 71 (49.31%), 负样本 73 (50.69%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.7921
处理批次 1/30, 累计样本数: 96, 批次损失: 0.9881
处理批次 2/30, 累计样本数: 144, 批次损失: 1.1479
处理批次 3/30, 累计样本数: 192, 批次损失: 2.8697
处理批次 4/30, 累计样本数: 240, 批次损失: 0.8078
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.9009, AUPRC=0.8068
当前学习率: 0.000013
Epoch 60/100 - 训练损失: 0.1647 - 验证AUROC: 0.9009 - 验证AUPRC: 0.8068
批次 0: 正样本 20, 负样本 28
批次 100: 正样本 24, 负样本 24
批次 200: 正样本 26, 负样本 22
本轮训练: 正样本 70 (48.61%), 负样本 74 (51.39%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.0418
处理批次 1/30, 累计样本数: 96, 批次损失: 1.0155
处理批次 2/30, 累计样本数: 144, 批次损失: 0.9693
处理批次 3/30, 累计样本数: 192, 批次损失: 4.7546
处理批次 4/30, 累计样本数: 240, 批次损失: 0.8737
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.9050, AUPRC=0.8108
当前学习率: 0.000013
Epoch 61/100 - 训练损失: 0.1679 - 验证AUROC: 0.9050 - 验证AUPRC: 0.8108
批次 0: 正样本 24, 负样本 24
批次 100: 正样本 20, 负样本 28
批次 200: 正样本 26, 负样本 22
本轮训练: 正样本 70 (48.61%), 负样本 74 (51.39%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.9230
处理批次 1/30, 累计样本数: 96, 批次损失: 1.0333
处理批次 2/30, 累计样本数: 144, 批次损失: 1.0155
处理批次 3/30, 累计样本数: 192, 批次损失: 4.8302
处理批次 4/30, 累计样本数: 240, 批次损失: 0.8572
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.9036, AUPRC=0.8102
当前学习率: 0.000013
Epoch 62/100 - 训练损失: 0.1622 - 验证AUROC: 0.9036 - 验证AUPRC: 0.8102
批次 0: 正样本 25, 负样本 23
批次 100: 正样本 25, 负样本 23
批次 200: 正样本 30, 负样本 18
本轮训练: 正样本 80 (55.56%), 负样本 64 (44.44%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.0002
处理批次 1/30, 累计样本数: 96, 批次损失: 1.0403
处理批次 2/30, 累计样本数: 144, 批次损失: 1.0460
处理批次 3/30, 累计样本数: 192, 批次损失: 4.7949
处理批次 4/30, 累计样本数: 240, 批次损失: 0.9681
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.9014, AUPRC=0.8093
当前学习率: 0.000013
Epoch 63/100 - 训练损失: 0.1590 - 验证AUROC: 0.9014 - 验证AUPRC: 0.8093
批次 0: 正样本 26, 负样本 22
批次 100: 正样本 31, 负样本 17
批次 200: 正样本 26, 负样本 22
本轮训练: 正样本 83 (57.64%), 负样本 61 (42.36%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.9666
处理批次 1/30, 累计样本数: 96, 批次损失: 1.0256
处理批次 2/30, 累计样本数: 144, 批次损失: 0.9703
处理批次 3/30, 累计样本数: 192, 批次损失: 4.7819
处理批次 4/30, 累计样本数: 240, 批次损失: 0.9332
测试完成: 处理了 30/30 批次, 1407 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=953
成功计算评估指标: AUROC=0.9025, AUPRC=0.8105
Epoch 00064: reducing learning rate of group 0 to 6.2500e-06.
当前学习率: 0.000006
早停触发！连续15轮验证集性能未提升
测试数据集大小: 22 批次
成功加载最佳模型状态（来自Epoch 49）
开始进行test评估...
处理批次 0/22, 累计样本数: 48, 批次损失: 0.9688
处理批次 1/22, 累计样本数: 96, 批次损失: 0.7242
处理批次 2/22, 累计样本数: 144, 批次损失: 0.9380
处理批次 3/22, 累计样本数: 192, 批次损失: 1.4420
处理批次 4/22, 累计样本数: 240, 批次损失: 1.0944
测试完成: 处理了 22/22 批次, 1039 个样本
错误批次数: 0
预测标签统计: 正样本数=336, 负样本数=703
成功计算评估指标: AUROC=0.8942, AUPRC=0.8013
最佳阈值: 0.1623, 对应的F1分数: 0.8372
混淆矩阵:
[[540 163]
 [ 38 298]]
详细测试结果: AUROC=0.8942, AUPRC=0.8013, F1=0.8372, 敏感度=0.7681, 特异度=0.8869, 准确率=0.8065, 精确度=0.6464
训练完成！最佳模型来自Epoch 49 - AUROC: 0.8942 - F1: 0.8372
结果已保存到: result/DrugBAN3D_balanced_augment_20250610_123043
训练完成时间: 2025年 06月 10日 星期二 14:26:14 CST
=== 训练总结 ===
训练成功完成！
结果保存在: result/DrugBAN3D_balanced_augment_20250610_123043
配置文件: result/DrugBAN3D_balanced_augment_20250610_123043/config/DrugBAN3D_augmented_20250610_123043.yaml
日志文件: result/DrugBAN3D_balanced_augment_20250610_123043/logs/train.log
保存的模型文件:
  result/DrugBAN3D_balanced_augment_20250610_123043/best_model.pth
