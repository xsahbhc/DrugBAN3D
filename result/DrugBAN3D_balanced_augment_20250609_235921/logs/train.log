
================================================================================
DrugBAN 数据增强与标签生成流程
================================================================================
开始时间: 2025-06-10 00:03:11
原始缓存目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/cached_graphs
增强缓存目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250609_235921
原始标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/labels.csv
训练标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/train_stratified.csv
验证标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/val_stratified.csv
测试标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv
增强标签目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_235921
是否增强测试集: 否
================================================================================

步骤1：执行数据增强...
读取标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/labels.csv
总样本数: 10436, 正样本数: 3369 (32.28%), 负样本数: 7067 (67.72%)
使用的增强类型: ['smart_conformational', 'binding_aware', 'adaptive_rotate']
正样本增强数量: 每个样本0.5次
负样本增强数量: 每个样本0.5次

数据增强完成! 耗时: 195.52秒
成功: 10398/10436 (99.64%)
失败记录已保存到 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250609_235921/augment_failures.txt
生成的文件总数: 15663
  原始文件数: 10398
  增强文件数: 5265
增强后样本总数: 15654 (期望值)
  正样本数: 5053 (32.28%)
  负样本数: 10600 (67.72%)
分布保持: 原始32.28% → 增强后32.28% (分布保持)

================================================================================
步骤2：为增强数据生成标签文件...
读取原始标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/labels.csv
原始标签文件包含 10436 条记录
使用预划分的测试集标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv
测试集包含 1044 条记录
测试集正样本率: 32.28%
正在从缓存目录 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250609_235921 中读取增强数据...
找到 15663 个缓存文件
从缓存文件中提取标签信息...
增强标签已保存至 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_235921/augmented_labels.csv，包含 15663 条记录
正样本: 5084 (32.46%), 负样本: 10579 (67.54%)
数据集划分: 训练集 7955 分子, 验证集 1404 分子, 测试集 1044 分子
验证集当前正样本率: 32.01%, 目标正样本率: 32.28%
调整验证集: 从1434个负样本中抽样1416个
调整后验证集正样本率: 32.28%
训练标签已保存至 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_235921/train_augmented.csv，包含 11991 条记录
验证标签已保存至 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_235921/valid_augmented.csv，包含 2091 条记录
测试标签已保存至 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_235921/test_augmented.csv，包含 1044 条记录
训练集: 总样本 11991, 正样本率 32.62%
验证集: 总样本 2091, 正样本率 32.28%
测试集: 总样本 1044, 正样本率 32.28%

================================================================================
数据增强与标签生成完成!
增强后的缓存文件保存在: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250609_235921
增强后的标签文件保存在: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_235921
结束时间: 2025-06-10 00:06:41
================================================================================

=== 详细配置信息 ===
配置文件: result/DrugBAN3D_balanced_augment_20250609_235921/config/DrugBAN3D_augmented_20250609_235921.yaml
训练数据: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_235921/train_augmented.csv
验证数据: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_235921/valid_augmented.csv
测试数据: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv
缓存目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250609_235921
结果目录: result/DrugBAN3D_balanced_augment_20250609_235921

=== 完整配置参数详览 ===
📋 训练参数 (TRAIN):
  TRAIN:
    D_LEARNING_RATE: 0.0004   # 最优判别器学习率（来自最佳实验）
    G_LEARNING_RATE: 0.0002   # 最优生成器学习率（来自最佳实验）
    BATCH_SIZE: 48  # 最佳batch size（来自最佳实验）
    D_STEPS_PER_G_STEP: 1
    RESUME_CHECKPOINT: ""
    EPOCH: 100  # 充足的训练轮数
    GRADIENT_ACCUMULATE_STEPS: 2  # 梯度累积，有效batch size = 48*2 = 96
    GRADIENT_CLIP_NORM: 1.0  # 梯度裁剪阈值（来自最佳实验）
    WEIGHT_DECAY: 0.0004  # 最优权重衰减（来自最佳实验）
    LABEL_SMOOTHING: 0.05  # 标签平滑参数（来自最佳实验）
    POS_WEIGHT: 1.05  # 正样本权重（来自最佳实验）

🏗️ GNN配置:
  GNN:
    HIDDEN_DIM: 384  # 最优GNN隐藏维度
    NUM_LAYERS: 4    # 最优GNN层数
  
  BCN:
    HEADS: 8  # 最优注意力头数量

🔧 解码器配置:
  DECODER:
    IN_DIM: 384
    HIDDEN_DIM: 512  # 最优解码器隐藏维度
    OUT_DIM: 128  # 最优解码器输出维度
    BINARY: 1
    DROPOUT: 0.3  # 最优Dropout率，平衡过拟合和欠拟合
  
  ADAPT:
    LAMBDA: 0.1

📊 损失函数配置:
  USE_BIAS_CORRECTION: True  # 启用偏置校正，提升模型稳定性
  USE_FOCAL_LOSS: True  # 使用焦点损失处理类别不平衡
  FOCAL_LOSS_GAMMA: 1.0  # 最优gamma值，温和的焦点损失
  FOCAL_LOSS_ALPHA: 0.3  # 最优alpha值，平衡正负样本

🌐 3D空间特征配置:
  SPATIAL_3D:
    ENABLE_SPATIAL_FUSION: true      # 启用3D空间感知特征融合 - 重要性能提升
    ENABLE_MULTISCALE: true          # 启用多尺度特征提取 - 捕获不同距离的相互作用
    DISTANCE_SCALES: [2.0, 5.0, 8.0]  # 最优多尺度距离阈值(Å)
    SPATIAL_DROPOUT: 0.1             # 最优空间模块Dropout率
    CROSS_ATTENTION_HEADS: 8         # 最优交叉注意力头数
  
  # 损失函数配置 - 最优设置
  USE_FOCAL_LOSS: True  # 使用焦点损失处理类别不平衡

⚙️ 求解器配置:
  SOLVER:
    MAX_EPOCH: 100  # 充足的训练轮数
    BATCH_SIZE: 48  # 最优batch size（来自最佳实验）
    USE_MIXED_PRECISION: False  # 不使用混合精度训练，保持稳定性
    LR_SCHEDULER: True  # 启用学习率调度器（来自最佳实验）
    LR_SCHEDULER_TYPE: "plateau"  # 最优学习率调度器（来自最佳实验）
    LR_WARMUP_EPOCHS: 4  # 最优学习率预热轮数（来自最佳实验）
    GRADIENT_CLIP_NORM: 1.0  # 梯度裁剪阈值（来自最佳实验）
    SEED: 42  # 固定随机种子保证可重现性
  
  RESULT:

⏹️ 早停配置:
  USE_EARLY_STOPPING: True
  EARLY_STOPPING_PATIENCE: 15  # 最优早停耐心值，避免过早停止

=========================

训练开始时间: 2025年 06月 10日 星期二 00:06:41 CST
使用命令行指定的输出目录: result/DrugBAN3D_balanced_augment_20250609_235921
已保存当前配置到 result/DrugBAN3D_balanced_augment_20250609_235921/config/config_used.yaml
配置文件: result/DrugBAN3D_balanced_augment_20250609_235921/config/DrugBAN3D_augmented_20250609_235921.yaml
输出目录: result/DrugBAN3D_balanced_augment_20250609_235921
运行设备: cuda
数据加载器使用 16 个工作线程
使用分层采样的预划分数据集
数据集: 训练集 11991 样本, 验证集 2091 样本, 测试集 1044 样本
正样本比例: 训练集 32.62%, 验证集 32.28%, 测试集 32.28%
使用增强数据集进行训练...
加载标签文件: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_235921/train_augmented.csv, 包含 11991 条记录
找到 11991/11991 个对应的缓存文件
数据集初始化完成，总样本数: 11991
训练/验证 数据集初始化完成: 11991 个样本
创建数据加载器成功: 预期 250 批次，批次大小 48
加载标签文件: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_235921/valid_augmented.csv, 包含 2091 条记录
找到 2091/2091 个对应的缓存文件
数据集初始化完成，总样本数: 2091
训练/验证 数据集初始化完成: 2091 个样本
创建数据加载器成功: 预期 44 批次，批次大小 48
测试模式: 使用原始测试数据
测试标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv
缓存目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/cached_graphs
测试标签文件包含 1044 条记录
测试集标签分布: 正样本 337 (32.28%), 负样本 707 (67.72%)
读取测试标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv, 包含 1044 条记录
成功创建测试标签映射，包含 2088 个条目
测试模式：从标签文件获取 2088 个复合物ID
测试模式：只处理标签文件中的 2088 个样本
在缓存目录中找到 1039/2088 个测试样本缓存文件
数据集初始化完成，总样本数: 1039
测试 数据集初始化完成: 1039 个样本
创建数据加载器成功: 预期 22 批次，批次大小 48

==================================================
DrugBAN3D初始化 - 偏差校正模块: 启用
Dropout率: 0.3
GNN层数: 4
==================================================

优化器: Adam, 学习率: 0.0002, L2正则化强度: 0.0004
启用标签平滑，参数值: 0.05
启用类别加权，正样本权重: 1.050
启用梯度裁剪，阈值：1.0
使用state_dict保存模型，避免完整对象复制
使用plateau学习率调度器
运行设备: cuda
启用标签平滑，参数值: 0.05
启用类别加权，正样本权重: 1.0499999523162842
使用ReduceLROnPlateau学习率调度器，监控验证集AUROC
开始训练...
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 17, 负样本 31
批次 200: 正样本 9, 负样本 39
本轮训练: 正样本 44 (30.56%), 负样本 100 (69.44%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.9845
处理批次 1/44, 累计样本数: 96, 批次损失: 1.0506
处理批次 2/44, 累计样本数: 144, 批次损失: 1.0387
处理批次 3/44, 累计样本数: 192, 批次损失: 0.7861
处理批次 4/44, 累计样本数: 240, 批次损失: 0.7638
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.6390, AUPRC=0.4456
当前学习率: 0.000200
保存最佳模型（轮次 1）到 result/DrugBAN3D_balanced_augment_20250609_235921/best_model.pth
Epoch 1/100 - 训练损失: 2.2380 - 验证AUROC: 0.6390 - 验证AUPRC: 0.4456
批次 0: 正样本 20, 负样本 28
批次 100: 正样本 13, 负样本 35
批次 200: 正样本 18, 负样本 30
本轮训练: 正样本 51 (35.42%), 负样本 93 (64.58%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.8857
处理批次 1/44, 累计样本数: 96, 批次损失: 0.6041
处理批次 2/44, 累计样本数: 144, 批次损失: 0.5972
处理批次 3/44, 累计样本数: 192, 批次损失: 0.7588
处理批次 4/44, 累计样本数: 240, 批次损失: 0.7284
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.6988, AUPRC=0.5045
当前学习率: 0.000200
保存最佳模型（轮次 2）到 result/DrugBAN3D_balanced_augment_20250609_235921/best_model.pth
Epoch 2/100 - 训练损失: 1.5890 - 验证AUROC: 0.6988 - 验证AUPRC: 0.5045
批次 0: 正样本 19, 负样本 29
批次 100: 正样本 14, 负样本 34
批次 200: 正样本 7, 负样本 41
本轮训练: 正样本 40 (27.78%), 负样本 104 (72.22%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.9940
处理批次 1/44, 累计样本数: 96, 批次损失: 0.5938
处理批次 2/44, 累计样本数: 144, 批次损失: 0.6068
处理批次 3/44, 累计样本数: 192, 批次损失: 1.0021
处理批次 4/44, 累计样本数: 240, 批次损失: 1.0124
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.7005, AUPRC=0.4981
当前学习率: 0.000200
保存最佳模型（轮次 3）到 result/DrugBAN3D_balanced_augment_20250609_235921/best_model.pth
Epoch 3/100 - 训练损失: 1.3659 - 验证AUROC: 0.7005 - 验证AUPRC: 0.4981
批次 0: 正样本 16, 负样本 32
批次 100: 正样本 17, 负样本 31
批次 200: 正样本 15, 负样本 33
本轮训练: 正样本 48 (33.33%), 负样本 96 (66.67%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.9278
处理批次 1/44, 累计样本数: 96, 批次损失: 0.5779
处理批次 2/44, 累计样本数: 144, 批次损失: 0.7323
处理批次 3/44, 累计样本数: 192, 批次损失: 0.8144
处理批次 4/44, 累计样本数: 240, 批次损失: 0.7497
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.7608, AUPRC=0.5673
当前学习率: 0.000200
保存最佳模型（轮次 4）到 result/DrugBAN3D_balanced_augment_20250609_235921/best_model.pth
Epoch 4/100 - 训练损失: 1.1970 - 验证AUROC: 0.7608 - 验证AUPRC: 0.5673
批次 0: 正样本 13, 负样本 35
批次 100: 正样本 20, 负样本 28
批次 200: 正样本 16, 负样本 32
本轮训练: 正样本 49 (34.03%), 负样本 95 (65.97%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.8811
处理批次 1/44, 累计样本数: 96, 批次损失: 0.6545
处理批次 2/44, 累计样本数: 144, 批次损失: 0.6868
处理批次 3/44, 累计样本数: 192, 批次损失: 0.6852
处理批次 4/44, 累计样本数: 240, 批次损失: 0.5212
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.7732, AUPRC=0.5692
当前学习率: 0.000200
保存最佳模型（轮次 5）到 result/DrugBAN3D_balanced_augment_20250609_235921/best_model.pth
Epoch 5/100 - 训练损失: 1.1928 - 验证AUROC: 0.7732 - 验证AUPRC: 0.5692
批次 0: 正样本 11, 负样本 37
批次 100: 正样本 14, 负样本 34
批次 200: 正样本 13, 负样本 35
本轮训练: 正样本 38 (26.39%), 负样本 106 (73.61%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.8471
处理批次 1/44, 累计样本数: 96, 批次损失: 0.6447
处理批次 2/44, 累计样本数: 144, 批次损失: 0.5847
处理批次 3/44, 累计样本数: 192, 批次损失: 0.9193
处理批次 4/44, 累计样本数: 240, 批次损失: 0.5762
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.7743, AUPRC=0.5650
当前学习率: 0.000200
保存最佳模型（轮次 6）到 result/DrugBAN3D_balanced_augment_20250609_235921/best_model.pth
Epoch 6/100 - 训练损失: 1.1857 - 验证AUROC: 0.7743 - 验证AUPRC: 0.5650
批次 0: 正样本 13, 负样本 35
批次 100: 正样本 15, 负样本 33
批次 200: 正样本 15, 负样本 33
本轮训练: 正样本 43 (29.86%), 负样本 101 (70.14%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.8509
处理批次 1/44, 累计样本数: 96, 批次损失: 0.7351
处理批次 2/44, 累计样本数: 144, 批次损失: 0.7864
处理批次 3/44, 累计样本数: 192, 批次损失: 0.9778
处理批次 4/44, 累计样本数: 240, 批次损失: 0.7272
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.7654, AUPRC=0.6020
当前学习率: 0.000200
Epoch 7/100 - 训练损失: 1.0826 - 验证AUROC: 0.7654 - 验证AUPRC: 0.6020
批次 0: 正样本 19, 负样本 29
批次 100: 正样本 14, 负样本 34
批次 200: 正样本 19, 负样本 29
本轮训练: 正样本 52 (36.11%), 负样本 92 (63.89%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.6487
处理批次 1/44, 累计样本数: 96, 批次损失: 0.7716
处理批次 2/44, 累计样本数: 144, 批次损失: 0.6716
处理批次 3/44, 累计样本数: 192, 批次损失: 1.3685
处理批次 4/44, 累计样本数: 240, 批次损失: 0.6198
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.7613, AUPRC=0.5949
当前学习率: 0.000200
Epoch 8/100 - 训练损失: 0.8596 - 验证AUROC: 0.7613 - 验证AUPRC: 0.5949
批次 0: 正样本 14, 负样本 34
批次 100: 正样本 18, 负样本 30
批次 200: 正样本 18, 负样本 30
本轮训练: 正样本 50 (34.72%), 负样本 94 (65.28%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.6465
处理批次 1/44, 累计样本数: 96, 批次损失: 0.7488
处理批次 2/44, 累计样本数: 144, 批次损失: 0.6369
处理批次 3/44, 累计样本数: 192, 批次损失: 1.2334
处理批次 4/44, 累计样本数: 240, 批次损失: 0.9881
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.7833, AUPRC=0.6180
当前学习率: 0.000200
保存最佳模型（轮次 9）到 result/DrugBAN3D_balanced_augment_20250609_235921/best_model.pth
Epoch 9/100 - 训练损失: 0.7845 - 验证AUROC: 0.7833 - 验证AUPRC: 0.6180
批次 0: 正样本 22, 负样本 26
批次 100: 正样本 16, 负样本 32
批次 200: 正样本 22, 负样本 26
本轮训练: 正样本 60 (41.67%), 负样本 84 (58.33%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.9018
处理批次 1/44, 累计样本数: 96, 批次损失: 0.5382
处理批次 2/44, 累计样本数: 144, 批次损失: 0.6170
处理批次 3/44, 累计样本数: 192, 批次损失: 1.1185
处理批次 4/44, 累计样本数: 240, 批次损失: 0.6882
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.7915, AUPRC=0.6337
当前学习率: 0.000200
保存最佳模型（轮次 10）到 result/DrugBAN3D_balanced_augment_20250609_235921/best_model.pth
Epoch 10/100 - 训练损失: 0.7057 - 验证AUROC: 0.7915 - 验证AUPRC: 0.6337
批次 0: 正样本 19, 负样本 29
批次 100: 正样本 18, 负样本 30
批次 200: 正样本 19, 负样本 29
本轮训练: 正样本 56 (38.89%), 负样本 88 (61.11%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.7807
处理批次 1/44, 累计样本数: 96, 批次损失: 0.6335
处理批次 2/44, 累计样本数: 144, 批次损失: 0.7083
处理批次 3/44, 累计样本数: 192, 批次损失: 1.9816
处理批次 4/44, 累计样本数: 240, 批次损失: 1.0841
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.7928, AUPRC=0.6303
当前学习率: 0.000200
保存最佳模型（轮次 11）到 result/DrugBAN3D_balanced_augment_20250609_235921/best_model.pth
Epoch 11/100 - 训练损失: 0.6540 - 验证AUROC: 0.7928 - 验证AUPRC: 0.6303
批次 0: 正样本 8, 负样本 40
批次 100: 正样本 20, 负样本 28
批次 200: 正样本 17, 负样本 31
本轮训练: 正样本 45 (31.25%), 负样本 99 (68.75%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.3441
处理批次 1/44, 累计样本数: 96, 批次损失: 0.7793
处理批次 2/44, 累计样本数: 144, 批次损失: 0.8379
处理批次 3/44, 累计样本数: 192, 批次损失: 2.0991
处理批次 4/44, 累计样本数: 240, 批次损失: 2.0742
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8000, AUPRC=0.6585
当前学习率: 0.000200
保存最佳模型（轮次 12）到 result/DrugBAN3D_balanced_augment_20250609_235921/best_model.pth
Epoch 12/100 - 训练损失: 0.5847 - 验证AUROC: 0.8000 - 验证AUPRC: 0.6585
批次 0: 正样本 16, 负样本 32
批次 100: 正样本 11, 负样本 37
批次 200: 正样本 22, 负样本 26
本轮训练: 正样本 49 (34.03%), 负样本 95 (65.97%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.8851
处理批次 1/44, 累计样本数: 96, 批次损失: 0.7092
处理批次 2/44, 累计样本数: 144, 批次损失: 0.6464
处理批次 3/44, 累计样本数: 192, 批次损失: 1.1809
处理批次 4/44, 累计样本数: 240, 批次损失: 1.6112
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8197, AUPRC=0.6966
当前学习率: 0.000200
保存最佳模型（轮次 13）到 result/DrugBAN3D_balanced_augment_20250609_235921/best_model.pth
Epoch 13/100 - 训练损失: 0.5435 - 验证AUROC: 0.8197 - 验证AUPRC: 0.6966
批次 0: 正样本 12, 负样本 36
批次 100: 正样本 15, 负样本 33
批次 200: 正样本 17, 负样本 31
本轮训练: 正样本 44 (30.56%), 负样本 100 (69.44%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.8388
处理批次 1/44, 累计样本数: 96, 批次损失: 0.6483
处理批次 2/44, 累计样本数: 144, 批次损失: 0.6352
处理批次 3/44, 累计样本数: 192, 批次损失: 1.1381
处理批次 4/44, 累计样本数: 240, 批次损失: 0.7314
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8191, AUPRC=0.6676
当前学习率: 0.000200
Epoch 14/100 - 训练损失: 0.5365 - 验证AUROC: 0.8191 - 验证AUPRC: 0.6676
批次 0: 正样本 20, 负样本 28
批次 100: 正样本 18, 负样本 30
批次 200: 正样本 12, 负样本 36
本轮训练: 正样本 50 (34.72%), 负样本 94 (65.28%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.8705
处理批次 1/44, 累计样本数: 96, 批次损失: 0.8591
处理批次 2/44, 累计样本数: 144, 批次损失: 0.6648
处理批次 3/44, 累计样本数: 192, 批次损失: 1.5979
处理批次 4/44, 累计样本数: 240, 批次损失: 1.5227
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8349, AUPRC=0.7147
当前学习率: 0.000200
保存最佳模型（轮次 15）到 result/DrugBAN3D_balanced_augment_20250609_235921/best_model.pth
Epoch 15/100 - 训练损失: 0.5113 - 验证AUROC: 0.8349 - 验证AUPRC: 0.7147
批次 0: 正样本 12, 负样本 36
批次 100: 正样本 18, 负样本 30
批次 200: 正样本 20, 负样本 28
本轮训练: 正样本 50 (34.72%), 负样本 94 (65.28%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.9194
处理批次 1/44, 累计样本数: 96, 批次损失: 0.8016
处理批次 2/44, 累计样本数: 144, 批次损失: 0.7698
处理批次 3/44, 累计样本数: 192, 批次损失: 1.9105
处理批次 4/44, 累计样本数: 240, 批次损失: 1.3232
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8488, AUPRC=0.7412
当前学习率: 0.000200
保存最佳模型（轮次 16）到 result/DrugBAN3D_balanced_augment_20250609_235921/best_model.pth
Epoch 16/100 - 训练损失: 0.4844 - 验证AUROC: 0.8488 - 验证AUPRC: 0.7412
批次 0: 正样本 15, 负样本 33
批次 100: 正样本 16, 负样本 32
批次 200: 正样本 15, 负样本 33
本轮训练: 正样本 46 (31.94%), 负样本 98 (68.06%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.6824
处理批次 1/44, 累计样本数: 96, 批次损失: 0.7530
处理批次 2/44, 累计样本数: 144, 批次损失: 0.8085
处理批次 3/44, 累计样本数: 192, 批次损失: 0.8696
处理批次 4/44, 累计样本数: 240, 批次损失: 0.9444
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8382, AUPRC=0.7188
当前学习率: 0.000200
Epoch 17/100 - 训练损失: 0.4682 - 验证AUROC: 0.8382 - 验证AUPRC: 0.7188
批次 0: 正样本 12, 负样本 36
批次 100: 正样本 12, 负样本 36
批次 200: 正样本 19, 负样本 29
本轮训练: 正样本 43 (29.86%), 负样本 101 (70.14%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.7274
处理批次 1/44, 累计样本数: 96, 批次损失: 0.7353
处理批次 2/44, 累计样本数: 144, 批次损失: 0.7020
处理批次 3/44, 累计样本数: 192, 批次损失: 1.5093
处理批次 4/44, 累计样本数: 240, 批次损失: 0.8723
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8513, AUPRC=0.7299
当前学习率: 0.000200
保存最佳模型（轮次 18）到 result/DrugBAN3D_balanced_augment_20250609_235921/best_model.pth
Epoch 18/100 - 训练损失: 0.4464 - 验证AUROC: 0.8513 - 验证AUPRC: 0.7299
批次 0: 正样本 26, 负样本 22
批次 100: 正样本 12, 负样本 36
批次 200: 正样本 12, 负样本 36
本轮训练: 正样本 50 (34.72%), 负样本 94 (65.28%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.7109
处理批次 1/44, 累计样本数: 96, 批次损失: 0.7361
处理批次 2/44, 累计样本数: 144, 批次损失: 0.8340
处理批次 3/44, 累计样本数: 192, 批次损失: 0.9131
处理批次 4/44, 累计样本数: 240, 批次损失: 1.8597
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8587, AUPRC=0.7560
当前学习率: 0.000200
保存最佳模型（轮次 19）到 result/DrugBAN3D_balanced_augment_20250609_235921/best_model.pth
Epoch 19/100 - 训练损失: 0.4318 - 验证AUROC: 0.8587 - 验证AUPRC: 0.7560
批次 0: 正样本 13, 负样本 35
批次 100: 正样本 18, 负样本 30
批次 200: 正样本 16, 负样本 32
本轮训练: 正样本 47 (32.64%), 负样本 97 (67.36%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.7747
处理批次 1/44, 累计样本数: 96, 批次损失: 0.7027
处理批次 2/44, 累计样本数: 144, 批次损失: 0.8584
处理批次 3/44, 累计样本数: 192, 批次损失: 1.1404
处理批次 4/44, 累计样本数: 240, 批次损失: 2.9249
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8623, AUPRC=0.7637
当前学习率: 0.000200
保存最佳模型（轮次 20）到 result/DrugBAN3D_balanced_augment_20250609_235921/best_model.pth
Epoch 20/100 - 训练损失: 0.4224 - 验证AUROC: 0.8623 - 验证AUPRC: 0.7637
批次 0: 正样本 14, 负样本 34
批次 100: 正样本 17, 负样本 31
批次 200: 正样本 22, 负样本 26
本轮训练: 正样本 53 (36.81%), 负样本 91 (63.19%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.0710
处理批次 1/44, 累计样本数: 96, 批次损失: 1.1775
处理批次 2/44, 累计样本数: 144, 批次损失: 0.8763
处理批次 3/44, 累计样本数: 192, 批次损失: 1.9354
处理批次 4/44, 累计样本数: 240, 批次损失: 1.5782
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8552, AUPRC=0.7526
当前学习率: 0.000200
Epoch 21/100 - 训练损失: 0.4227 - 验证AUROC: 0.8552 - 验证AUPRC: 0.7526
批次 0: 正样本 16, 负样本 32
批次 100: 正样本 19, 负样本 29
批次 200: 正样本 23, 负样本 25
本轮训练: 正样本 58 (40.28%), 负样本 86 (59.72%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.7348
处理批次 1/44, 累计样本数: 96, 批次损失: 0.8694
处理批次 2/44, 累计样本数: 144, 批次损失: 0.8925
处理批次 3/44, 累计样本数: 192, 批次损失: 2.1231
处理批次 4/44, 累计样本数: 240, 批次损失: 1.2498
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8595, AUPRC=0.7528
当前学习率: 0.000200
Epoch 22/100 - 训练损失: 0.4128 - 验证AUROC: 0.8595 - 验证AUPRC: 0.7528
批次 0: 正样本 16, 负样本 32
批次 100: 正样本 19, 负样本 29
批次 200: 正样本 14, 负样本 34
本轮训练: 正样本 49 (34.03%), 负样本 95 (65.97%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.7645
处理批次 1/44, 累计样本数: 96, 批次损失: 0.8107
处理批次 2/44, 累计样本数: 144, 批次损失: 0.8063
处理批次 3/44, 累计样本数: 192, 批次损失: 1.5185
处理批次 4/44, 累计样本数: 240, 批次损失: 1.1046
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8660, AUPRC=0.7732
当前学习率: 0.000200
保存最佳模型（轮次 23）到 result/DrugBAN3D_balanced_augment_20250609_235921/best_model.pth
Epoch 23/100 - 训练损失: 0.4068 - 验证AUROC: 0.8660 - 验证AUPRC: 0.7732
批次 0: 正样本 16, 负样本 32
批次 100: 正样本 14, 负样本 34
批次 200: 正样本 14, 负样本 34
本轮训练: 正样本 44 (30.56%), 负样本 100 (69.44%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.7462
处理批次 1/44, 累计样本数: 96, 批次损失: 0.6462
处理批次 2/44, 累计样本数: 144, 批次损失: 0.7618
处理批次 3/44, 累计样本数: 192, 批次损失: 1.8728
处理批次 4/44, 累计样本数: 240, 批次损失: 1.0766
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8705, AUPRC=0.7785
当前学习率: 0.000200
保存最佳模型（轮次 24）到 result/DrugBAN3D_balanced_augment_20250609_235921/best_model.pth
Epoch 24/100 - 训练损失: 0.3778 - 验证AUROC: 0.8705 - 验证AUPRC: 0.7785
批次 0: 正样本 16, 负样本 32
批次 100: 正样本 14, 负样本 34
批次 200: 正样本 18, 负样本 30
本轮训练: 正样本 48 (33.33%), 负样本 96 (66.67%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.7387
处理批次 1/44, 累计样本数: 96, 批次损失: 0.7685
处理批次 2/44, 累计样本数: 144, 批次损失: 0.8494
处理批次 3/44, 累计样本数: 192, 批次损失: 1.0045
处理批次 4/44, 累计样本数: 240, 批次损失: 2.0110
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8712, AUPRC=0.7795
当前学习率: 0.000200
保存最佳模型（轮次 25）到 result/DrugBAN3D_balanced_augment_20250609_235921/best_model.pth
Epoch 25/100 - 训练损失: 0.3839 - 验证AUROC: 0.8712 - 验证AUPRC: 0.7795
批次 0: 正样本 13, 负样本 35
批次 100: 正样本 24, 负样本 24
批次 200: 正样本 16, 负样本 32
本轮训练: 正样本 53 (36.81%), 负样本 91 (63.19%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.8681
处理批次 1/44, 累计样本数: 96, 批次损失: 1.0715
处理批次 2/44, 累计样本数: 144, 批次损失: 0.9229
处理批次 3/44, 累计样本数: 192, 批次损失: 1.6120
处理批次 4/44, 累计样本数: 240, 批次损失: 1.2900
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8529, AUPRC=0.7625
当前学习率: 0.000200
Epoch 26/100 - 训练损失: 0.3688 - 验证AUROC: 0.8529 - 验证AUPRC: 0.7625
批次 0: 正样本 17, 负样本 31
批次 100: 正样本 18, 负样本 30
批次 200: 正样本 11, 负样本 37
本轮训练: 正样本 46 (31.94%), 负样本 98 (68.06%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.6672
处理批次 1/44, 累计样本数: 96, 批次损失: 0.5500
处理批次 2/44, 累计样本数: 144, 批次损失: 0.6479
处理批次 3/44, 累计样本数: 192, 批次损失: 1.2636
处理批次 4/44, 累计样本数: 240, 批次损失: 1.4853
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8840, AUPRC=0.7873
当前学习率: 0.000200
保存最佳模型（轮次 27）到 result/DrugBAN3D_balanced_augment_20250609_235921/best_model.pth
Epoch 27/100 - 训练损失: 0.3617 - 验证AUROC: 0.8840 - 验证AUPRC: 0.7873
批次 0: 正样本 13, 负样本 35
批次 100: 正样本 15, 负样本 33
批次 200: 正样本 13, 负样本 35
本轮训练: 正样本 41 (28.47%), 负样本 103 (71.53%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.8087
处理批次 1/44, 累计样本数: 96, 批次损失: 0.7106
处理批次 2/44, 累计样本数: 144, 批次损失: 0.8260
处理批次 3/44, 累计样本数: 192, 批次损失: 1.1259
处理批次 4/44, 累计样本数: 240, 批次损失: 1.1085
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8624, AUPRC=0.7619
当前学习率: 0.000200
Epoch 28/100 - 训练损失: 0.3619 - 验证AUROC: 0.8624 - 验证AUPRC: 0.7619
批次 0: 正样本 13, 负样本 35
批次 100: 正样本 14, 负样本 34
批次 200: 正样本 12, 负样本 36
本轮训练: 正样本 39 (27.08%), 负样本 105 (72.92%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.7841
处理批次 1/44, 累计样本数: 96, 批次损失: 0.7436
处理批次 2/44, 累计样本数: 144, 批次损失: 1.0013
处理批次 3/44, 累计样本数: 192, 批次损失: 2.4503
处理批次 4/44, 累计样本数: 240, 批次损失: 1.3667
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8786, AUPRC=0.7776
当前学习率: 0.000200
Epoch 29/100 - 训练损失: 0.3531 - 验证AUROC: 0.8786 - 验证AUPRC: 0.7776
批次 0: 正样本 17, 负样本 31
批次 100: 正样本 14, 负样本 34
批次 200: 正样本 13, 负样本 35
本轮训练: 正样本 44 (30.56%), 负样本 100 (69.44%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.7041
处理批次 1/44, 累计样本数: 96, 批次损失: 0.6655
处理批次 2/44, 累计样本数: 144, 批次损失: 0.8076
处理批次 3/44, 累计样本数: 192, 批次损失: 1.4213
处理批次 4/44, 累计样本数: 240, 批次损失: 0.7784
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8679, AUPRC=0.7605
当前学习率: 0.000200
Epoch 30/100 - 训练损失: 0.3455 - 验证AUROC: 0.8679 - 验证AUPRC: 0.7605
批次 0: 正样本 15, 负样本 33
批次 100: 正样本 15, 负样本 33
批次 200: 正样本 20, 负样本 28
本轮训练: 正样本 50 (34.72%), 负样本 94 (65.28%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.6954
处理批次 1/44, 累计样本数: 96, 批次损失: 1.0425
处理批次 2/44, 累计样本数: 144, 批次损失: 0.8688
处理批次 3/44, 累计样本数: 192, 批次损失: 1.3327
处理批次 4/44, 累计样本数: 240, 批次损失: 0.8034
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8716, AUPRC=0.7882
当前学习率: 0.000200
Epoch 31/100 - 训练损失: 0.3576 - 验证AUROC: 0.8716 - 验证AUPRC: 0.7882
批次 0: 正样本 20, 负样本 28
批次 100: 正样本 14, 负样本 34
批次 200: 正样本 14, 负样本 34
本轮训练: 正样本 48 (33.33%), 负样本 96 (66.67%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.7624
处理批次 1/44, 累计样本数: 96, 批次损失: 0.7831
处理批次 2/44, 累计样本数: 144, 批次损失: 1.4049
处理批次 3/44, 累计样本数: 192, 批次损失: 2.0022
处理批次 4/44, 累计样本数: 240, 批次损失: 1.2068
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8771, AUPRC=0.7953
Epoch 00032: reducing learning rate of group 0 to 1.0000e-04.
当前学习率: 0.000100
Epoch 32/100 - 训练损失: 0.3388 - 验证AUROC: 0.8771 - 验证AUPRC: 0.7953
批次 0: 正样本 11, 负样本 37
批次 100: 正样本 16, 负样本 32
批次 200: 正样本 14, 负样本 34
本轮训练: 正样本 41 (28.47%), 负样本 103 (71.53%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.7116
处理批次 1/44, 累计样本数: 96, 批次损失: 0.7682
处理批次 2/44, 累计样本数: 144, 批次损失: 0.7883
处理批次 3/44, 累计样本数: 192, 批次损失: 1.5956
处理批次 4/44, 累计样本数: 240, 批次损失: 0.8989
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8835, AUPRC=0.7924
当前学习率: 0.000100
Epoch 33/100 - 训练损失: 0.3001 - 验证AUROC: 0.8835 - 验证AUPRC: 0.7924
批次 0: 正样本 15, 负样本 33
批次 100: 正样本 19, 负样本 29
批次 200: 正样本 14, 负样本 34
本轮训练: 正样本 48 (33.33%), 负样本 96 (66.67%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.7224
处理批次 1/44, 累计样本数: 96, 批次损失: 0.6692
处理批次 2/44, 累计样本数: 144, 批次损失: 1.0270
处理批次 3/44, 累计样本数: 192, 批次损失: 2.0181
处理批次 4/44, 累计样本数: 240, 批次损失: 1.1526
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8829, AUPRC=0.8064
当前学习率: 0.000100
Epoch 34/100 - 训练损失: 0.2885 - 验证AUROC: 0.8829 - 验证AUPRC: 0.8064
批次 0: 正样本 20, 负样本 28
批次 100: 正样本 11, 负样本 37
批次 200: 正样本 19, 负样本 29
本轮训练: 正样本 50 (34.72%), 负样本 94 (65.28%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.8459
处理批次 1/44, 累计样本数: 96, 批次损失: 1.0504
处理批次 2/44, 累计样本数: 144, 批次损失: 1.1777
处理批次 3/44, 累计样本数: 192, 批次损失: 2.5211
处理批次 4/44, 累计样本数: 240, 批次损失: 1.4214
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8845, AUPRC=0.8099
当前学习率: 0.000100
保存最佳模型（轮次 35）到 result/DrugBAN3D_balanced_augment_20250609_235921/best_model.pth
Epoch 35/100 - 训练损失: 0.2783 - 验证AUROC: 0.8845 - 验证AUPRC: 0.8099
批次 0: 正样本 17, 负样本 31
批次 100: 正样本 21, 负样本 27
批次 200: 正样本 17, 负样本 31
本轮训练: 正样本 55 (38.19%), 负样本 89 (61.81%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.8541
处理批次 1/44, 累计样本数: 96, 批次损失: 0.9433
处理批次 2/44, 累计样本数: 144, 批次损失: 1.1655
处理批次 3/44, 累计样本数: 192, 批次损失: 2.1994
处理批次 4/44, 累计样本数: 240, 批次损失: 1.3828
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8925, AUPRC=0.8095
当前学习率: 0.000100
保存最佳模型（轮次 36）到 result/DrugBAN3D_balanced_augment_20250609_235921/best_model.pth
Epoch 36/100 - 训练损失: 0.2744 - 验证AUROC: 0.8925 - 验证AUPRC: 0.8095
批次 0: 正样本 16, 负样本 32
批次 100: 正样本 11, 负样本 37
批次 200: 正样本 18, 负样本 30
本轮训练: 正样本 45 (31.25%), 负样本 99 (68.75%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.7981
处理批次 1/44, 累计样本数: 96, 批次损失: 0.5691
处理批次 2/44, 累计样本数: 144, 批次损失: 0.7658
处理批次 3/44, 累计样本数: 192, 批次损失: 1.3774
处理批次 4/44, 累计样本数: 240, 批次损失: 1.2953
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8943, AUPRC=0.8212
当前学习率: 0.000100
保存最佳模型（轮次 37）到 result/DrugBAN3D_balanced_augment_20250609_235921/best_model.pth
Epoch 37/100 - 训练损失: 0.2779 - 验证AUROC: 0.8943 - 验证AUPRC: 0.8212
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 9, 负样本 39
批次 200: 正样本 12, 负样本 36
本轮训练: 正样本 39 (27.08%), 负样本 105 (72.92%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.6811
处理批次 1/44, 累计样本数: 96, 批次损失: 0.7124
处理批次 2/44, 累计样本数: 144, 批次损失: 0.6032
处理批次 3/44, 累计样本数: 192, 批次损失: 1.4718
处理批次 4/44, 累计样本数: 240, 批次损失: 0.8776
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8880, AUPRC=0.7980
当前学习率: 0.000100
Epoch 38/100 - 训练损失: 0.2737 - 验证AUROC: 0.8880 - 验证AUPRC: 0.7980
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 18, 负样本 30
批次 200: 正样本 16, 负样本 32
本轮训练: 正样本 52 (36.11%), 负样本 92 (63.89%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.5550
处理批次 1/44, 累计样本数: 96, 批次损失: 0.8508
处理批次 2/44, 累计样本数: 144, 批次损失: 0.6128
处理批次 3/44, 累计样本数: 192, 批次损失: 1.4866
处理批次 4/44, 累计样本数: 240, 批次损失: 1.0446
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8880, AUPRC=0.8088
当前学习率: 0.000100
Epoch 39/100 - 训练损失: 0.2697 - 验证AUROC: 0.8880 - 验证AUPRC: 0.8088
批次 0: 正样本 20, 负样本 28
批次 100: 正样本 14, 负样本 34
批次 200: 正样本 9, 负样本 39
本轮训练: 正样本 43 (29.86%), 负样本 101 (70.14%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.6087
处理批次 1/44, 累计样本数: 96, 批次损失: 0.6942
处理批次 2/44, 累计样本数: 144, 批次损失: 0.5604
处理批次 3/44, 累计样本数: 192, 批次损失: 2.2990
处理批次 4/44, 累计样本数: 240, 批次损失: 1.5289
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8881, AUPRC=0.8055
当前学习率: 0.000100
Epoch 40/100 - 训练损失: 0.2722 - 验证AUROC: 0.8881 - 验证AUPRC: 0.8055
批次 0: 正样本 19, 负样本 29
批次 100: 正样本 21, 负样本 27
批次 200: 正样本 13, 负样本 35
本轮训练: 正样本 53 (36.81%), 负样本 91 (63.19%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.9235
处理批次 1/44, 累计样本数: 96, 批次损失: 0.6210
处理批次 2/44, 累计样本数: 144, 批次损失: 0.5880
处理批次 3/44, 累计样本数: 192, 批次损失: 1.8288
处理批次 4/44, 累计样本数: 240, 批次损失: 1.5546
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8863, AUPRC=0.8090
当前学习率: 0.000100
Epoch 41/100 - 训练损失: 0.2811 - 验证AUROC: 0.8863 - 验证AUPRC: 0.8090
批次 0: 正样本 12, 负样本 36
批次 100: 正样本 9, 负样本 39
批次 200: 正样本 17, 负样本 31
本轮训练: 正样本 38 (26.39%), 负样本 106 (73.61%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.7045
处理批次 1/44, 累计样本数: 96, 批次损失: 0.6150
处理批次 2/44, 累计样本数: 144, 批次损失: 0.7229
处理批次 3/44, 累计样本数: 192, 批次损失: 1.1082
处理批次 4/44, 累计样本数: 240, 批次损失: 1.3587
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8879, AUPRC=0.8010
Epoch 00042: reducing learning rate of group 0 to 5.0000e-05.
当前学习率: 0.000050
Epoch 42/100 - 训练损失: 0.2782 - 验证AUROC: 0.8879 - 验证AUPRC: 0.8010
批次 0: 正样本 11, 负样本 37
批次 100: 正样本 15, 负样本 33
批次 200: 正样本 15, 负样本 33
本轮训练: 正样本 41 (28.47%), 负样本 103 (71.53%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.0837
处理批次 1/44, 累计样本数: 96, 批次损失: 0.5513
处理批次 2/44, 累计样本数: 144, 批次损失: 0.5836
处理批次 3/44, 累计样本数: 192, 批次损失: 1.6354
处理批次 4/44, 累计样本数: 240, 批次损失: 1.3383
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8909, AUPRC=0.8071
当前学习率: 0.000050
Epoch 43/100 - 训练损失: 0.2462 - 验证AUROC: 0.8909 - 验证AUPRC: 0.8071
批次 0: 正样本 17, 负样本 31
批次 100: 正样本 19, 负样本 29
批次 200: 正样本 17, 负样本 31
本轮训练: 正样本 53 (36.81%), 负样本 91 (63.19%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.9623
处理批次 1/44, 累计样本数: 96, 批次损失: 0.6394
处理批次 2/44, 累计样本数: 144, 批次损失: 0.8997
处理批次 3/44, 累计样本数: 192, 批次损失: 1.6782
处理批次 4/44, 累计样本数: 240, 批次损失: 1.2859
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8853, AUPRC=0.8187
当前学习率: 0.000050
Epoch 44/100 - 训练损失: 0.2382 - 验证AUROC: 0.8853 - 验证AUPRC: 0.8187
批次 0: 正样本 15, 负样本 33
批次 100: 正样本 18, 负样本 30
批次 200: 正样本 14, 负样本 34
本轮训练: 正样本 47 (32.64%), 负样本 97 (67.36%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.9955
处理批次 1/44, 累计样本数: 96, 批次损失: 0.5698
处理批次 2/44, 累计样本数: 144, 批次损失: 0.7549
处理批次 3/44, 累计样本数: 192, 批次损失: 1.3748
处理批次 4/44, 累计样本数: 240, 批次损失: 1.3704
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8874, AUPRC=0.8270
当前学习率: 0.000050
Epoch 45/100 - 训练损失: 0.2260 - 验证AUROC: 0.8874 - 验证AUPRC: 0.8270
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 18, 负样本 30
批次 200: 正样本 17, 负样本 31
本轮训练: 正样本 53 (36.81%), 负样本 91 (63.19%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.7021
处理批次 1/44, 累计样本数: 96, 批次损失: 0.8172
处理批次 2/44, 累计样本数: 144, 批次损失: 0.7780
处理批次 3/44, 累计样本数: 192, 批次损失: 1.4668
处理批次 4/44, 累计样本数: 240, 批次损失: 1.1012
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.9006, AUPRC=0.8411
当前学习率: 0.000050
保存最佳模型（轮次 46）到 result/DrugBAN3D_balanced_augment_20250609_235921/best_model.pth
Epoch 46/100 - 训练损失: 0.2265 - 验证AUROC: 0.9006 - 验证AUPRC: 0.8411
批次 0: 正样本 17, 负样本 31
批次 100: 正样本 14, 负样本 34
批次 200: 正样本 20, 负样本 28
本轮训练: 正样本 51 (35.42%), 负样本 93 (64.58%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.8185
处理批次 1/44, 累计样本数: 96, 批次损失: 0.5414
处理批次 2/44, 累计样本数: 144, 批次损失: 0.6872
处理批次 3/44, 累计样本数: 192, 批次损失: 1.5425
处理批次 4/44, 累计样本数: 240, 批次损失: 1.3196
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8946, AUPRC=0.8252
当前学习率: 0.000050
Epoch 47/100 - 训练损失: 0.2196 - 验证AUROC: 0.8946 - 验证AUPRC: 0.8252
批次 0: 正样本 15, 负样本 33
批次 100: 正样本 22, 负样本 26
批次 200: 正样本 19, 负样本 29
本轮训练: 正样本 56 (38.89%), 负样本 88 (61.11%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.8288
处理批次 1/44, 累计样本数: 96, 批次损失: 0.6462
处理批次 2/44, 累计样本数: 144, 批次损失: 0.9149
处理批次 3/44, 累计样本数: 192, 批次损失: 1.2704
处理批次 4/44, 累计样本数: 240, 批次损失: 1.1920
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8901, AUPRC=0.8113
当前学习率: 0.000050
Epoch 48/100 - 训练损失: 0.2211 - 验证AUROC: 0.8901 - 验证AUPRC: 0.8113
批次 0: 正样本 16, 负样本 32
批次 100: 正样本 17, 负样本 31
批次 200: 正样本 18, 负样本 30
本轮训练: 正样本 51 (35.42%), 负样本 93 (64.58%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.6929
处理批次 1/44, 累计样本数: 96, 批次损失: 0.7780
处理批次 2/44, 累计样本数: 144, 批次损失: 0.6812
处理批次 3/44, 累计样本数: 192, 批次损失: 1.4383
处理批次 4/44, 累计样本数: 240, 批次损失: 1.2682
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.9010, AUPRC=0.8325
当前学习率: 0.000050
保存最佳模型（轮次 49）到 result/DrugBAN3D_balanced_augment_20250609_235921/best_model.pth
Epoch 49/100 - 训练损失: 0.2218 - 验证AUROC: 0.9010 - 验证AUPRC: 0.8325
批次 0: 正样本 12, 负样本 36
批次 100: 正样本 14, 负样本 34
批次 200: 正样本 16, 负样本 32
本轮训练: 正样本 42 (29.17%), 负样本 102 (70.83%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.1361
处理批次 1/44, 累计样本数: 96, 批次损失: 0.9720
处理批次 2/44, 累计样本数: 144, 批次损失: 0.8716
处理批次 3/44, 累计样本数: 192, 批次损失: 1.8909
处理批次 4/44, 累计样本数: 240, 批次损失: 1.3251
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8862, AUPRC=0.8171
当前学习率: 0.000050
Epoch 50/100 - 训练损失: 0.2129 - 验证AUROC: 0.8862 - 验证AUPRC: 0.8171
批次 0: 正样本 17, 负样本 31
批次 100: 正样本 12, 负样本 36
批次 200: 正样本 18, 负样本 30
本轮训练: 正样本 47 (32.64%), 负样本 97 (67.36%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.9162
处理批次 1/44, 累计样本数: 96, 批次损失: 0.7911
处理批次 2/44, 累计样本数: 144, 批次损失: 0.6267
处理批次 3/44, 累计样本数: 192, 批次损失: 1.6438
处理批次 4/44, 累计样本数: 240, 批次损失: 1.0877
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.9060, AUPRC=0.8345
当前学习率: 0.000050
保存最佳模型（轮次 51）到 result/DrugBAN3D_balanced_augment_20250609_235921/best_model.pth
Epoch 51/100 - 训练损失: 0.2245 - 验证AUROC: 0.9060 - 验证AUPRC: 0.8345
批次 0: 正样本 12, 负样本 36
批次 100: 正样本 19, 负样本 29
批次 200: 正样本 16, 负样本 32
本轮训练: 正样本 47 (32.64%), 负样本 97 (67.36%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.9222
处理批次 1/44, 累计样本数: 96, 批次损失: 0.5623
处理批次 2/44, 累计样本数: 144, 批次损失: 0.6110
处理批次 3/44, 累计样本数: 192, 批次损失: 1.8165
处理批次 4/44, 累计样本数: 240, 批次损失: 1.0008
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.9049, AUPRC=0.8336
当前学习率: 0.000050
Epoch 52/100 - 训练损失: 0.2295 - 验证AUROC: 0.9049 - 验证AUPRC: 0.8336
批次 0: 正样本 13, 负样本 35
批次 100: 正样本 17, 负样本 31
批次 200: 正样本 20, 负样本 28
本轮训练: 正样本 50 (34.72%), 负样本 94 (65.28%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.9556
处理批次 1/44, 累计样本数: 96, 批次损失: 0.7063
处理批次 2/44, 累计样本数: 144, 批次损失: 0.6895
处理批次 3/44, 累计样本数: 192, 批次损失: 1.7564
处理批次 4/44, 累计样本数: 240, 批次损失: 1.1223
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8925, AUPRC=0.8195
当前学习率: 0.000050
Epoch 53/100 - 训练损失: 0.2244 - 验证AUROC: 0.8925 - 验证AUPRC: 0.8195
批次 0: 正样本 12, 负样本 36
批次 100: 正样本 17, 负样本 31
批次 200: 正样本 14, 负样本 34
本轮训练: 正样本 43 (29.86%), 负样本 101 (70.14%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.9695
处理批次 1/44, 累计样本数: 96, 批次损失: 0.7883
处理批次 2/44, 累计样本数: 144, 批次损失: 0.7227
处理批次 3/44, 累计样本数: 192, 批次损失: 1.8523
处理批次 4/44, 累计样本数: 240, 批次损失: 0.9874
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8937, AUPRC=0.8093
当前学习率: 0.000050
Epoch 54/100 - 训练损失: 0.2348 - 验证AUROC: 0.8937 - 验证AUPRC: 0.8093
批次 0: 正样本 17, 负样本 31
批次 100: 正样本 14, 负样本 34
批次 200: 正样本 18, 负样本 30
本轮训练: 正样本 49 (34.03%), 负样本 95 (65.97%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.0983
处理批次 1/44, 累计样本数: 96, 批次损失: 0.6403
处理批次 2/44, 累计样本数: 144, 批次损失: 0.8393
处理批次 3/44, 累计样本数: 192, 批次损失: 1.6342
处理批次 4/44, 累计样本数: 240, 批次损失: 1.1865
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8925, AUPRC=0.8190
当前学习率: 0.000050
Epoch 55/100 - 训练损失: 0.2342 - 验证AUROC: 0.8925 - 验证AUPRC: 0.8190
批次 0: 正样本 14, 负样本 34
批次 100: 正样本 19, 负样本 29
批次 200: 正样本 15, 负样本 33
本轮训练: 正样本 48 (33.33%), 负样本 96 (66.67%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.1689
处理批次 1/44, 累计样本数: 96, 批次损失: 0.4974
处理批次 2/44, 累计样本数: 144, 批次损失: 0.7866
处理批次 3/44, 累计样本数: 192, 批次损失: 1.5810
处理批次 4/44, 累计样本数: 240, 批次损失: 1.2281
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8878, AUPRC=0.7921
Epoch 00056: reducing learning rate of group 0 to 2.5000e-05.
当前学习率: 0.000025
Epoch 56/100 - 训练损失: 0.2434 - 验证AUROC: 0.8878 - 验证AUPRC: 0.7921
批次 0: 正样本 13, 负样本 35
批次 100: 正样本 20, 负样本 28
批次 200: 正样本 16, 负样本 32
本轮训练: 正样本 49 (34.03%), 负样本 95 (65.97%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.9337
处理批次 1/44, 累计样本数: 96, 批次损失: 0.4578
处理批次 2/44, 累计样本数: 144, 批次损失: 0.7299
处理批次 3/44, 累计样本数: 192, 批次损失: 1.5346
处理批次 4/44, 累计样本数: 240, 批次损失: 1.0923
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8975, AUPRC=0.8210
当前学习率: 0.000025
Epoch 57/100 - 训练损失: 0.2115 - 验证AUROC: 0.8975 - 验证AUPRC: 0.8210
批次 0: 正样本 21, 负样本 27
批次 100: 正样本 17, 负样本 31
批次 200: 正样本 18, 负样本 30
本轮训练: 正样本 56 (38.89%), 负样本 88 (61.11%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.0310
处理批次 1/44, 累计样本数: 96, 批次损失: 0.5634
处理批次 2/44, 累计样本数: 144, 批次损失: 0.6340
处理批次 3/44, 累计样本数: 192, 批次损失: 1.4903
处理批次 4/44, 累计样本数: 240, 批次损失: 1.0093
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.9019, AUPRC=0.8315
当前学习率: 0.000025
Epoch 58/100 - 训练损失: 0.2002 - 验证AUROC: 0.9019 - 验证AUPRC: 0.8315
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 16, 负样本 32
批次 200: 正样本 11, 负样本 37
本轮训练: 正样本 45 (31.25%), 负样本 99 (68.75%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.2542
处理批次 1/44, 累计样本数: 96, 批次损失: 0.8378
处理批次 2/44, 累计样本数: 144, 批次损失: 0.7038
处理批次 3/44, 累计样本数: 192, 批次损失: 2.0420
处理批次 4/44, 累计样本数: 240, 批次损失: 1.1766
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8981, AUPRC=0.8259
当前学习率: 0.000025
Epoch 59/100 - 训练损失: 0.2008 - 验证AUROC: 0.8981 - 验证AUPRC: 0.8259
批次 0: 正样本 19, 负样本 29
批次 100: 正样本 16, 负样本 32
批次 200: 正样本 18, 负样本 30
本轮训练: 正样本 53 (36.81%), 负样本 91 (63.19%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.2425
处理批次 1/44, 累计样本数: 96, 批次损失: 0.6875
处理批次 2/44, 累计样本数: 144, 批次损失: 0.7575
处理批次 3/44, 累计样本数: 192, 批次损失: 1.5459
处理批次 4/44, 累计样本数: 240, 批次损失: 1.2012
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8986, AUPRC=0.8274
当前学习率: 0.000025
Epoch 60/100 - 训练损失: 0.1943 - 验证AUROC: 0.8986 - 验证AUPRC: 0.8274
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 15, 负样本 33
批次 200: 正样本 14, 负样本 34
本轮训练: 正样本 47 (32.64%), 负样本 97 (67.36%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.3279
处理批次 1/44, 累计样本数: 96, 批次损失: 0.5633
处理批次 2/44, 累计样本数: 144, 批次损失: 0.7788
处理批次 3/44, 累计样本数: 192, 批次损失: 1.3267
处理批次 4/44, 累计样本数: 240, 批次损失: 1.1110
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8981, AUPRC=0.8380
Epoch 00061: reducing learning rate of group 0 to 1.2500e-05.
当前学习率: 0.000013
Epoch 61/100 - 训练损失: 0.2002 - 验证AUROC: 0.8981 - 验证AUPRC: 0.8380
批次 0: 正样本 13, 负样本 35
批次 100: 正样本 20, 负样本 28
批次 200: 正样本 16, 负样本 32
本轮训练: 正样本 49 (34.03%), 负样本 95 (65.97%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.2639
处理批次 1/44, 累计样本数: 96, 批次损失: 0.5588
处理批次 2/44, 累计样本数: 144, 批次损失: 0.9886
处理批次 3/44, 累计样本数: 192, 批次损失: 1.4842
处理批次 4/44, 累计样本数: 240, 批次损失: 1.3035
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8968, AUPRC=0.8328
当前学习率: 0.000013
Epoch 62/100 - 训练损失: 0.1768 - 验证AUROC: 0.8968 - 验证AUPRC: 0.8328
批次 0: 正样本 15, 负样本 33
批次 100: 正样本 13, 负样本 35
批次 200: 正样本 18, 负样本 30
本轮训练: 正样本 46 (31.94%), 负样本 98 (68.06%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.2714
处理批次 1/44, 累计样本数: 96, 批次损失: 0.5246
处理批次 2/44, 累计样本数: 144, 批次损失: 0.8345
处理批次 3/44, 累计样本数: 192, 批次损失: 1.4329
处理批次 4/44, 累计样本数: 240, 批次损失: 1.0863
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.9033, AUPRC=0.8409
当前学习率: 0.000013
Epoch 63/100 - 训练损失: 0.1730 - 验证AUROC: 0.9033 - 验证AUPRC: 0.8409
批次 0: 正样本 11, 负样本 37
批次 100: 正样本 13, 负样本 35
批次 200: 正样本 14, 负样本 34
本轮训练: 正样本 38 (26.39%), 负样本 106 (73.61%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.2644
处理批次 1/44, 累计样本数: 96, 批次损失: 0.6248
处理批次 2/44, 累计样本数: 144, 批次损失: 0.8998
处理批次 3/44, 累计样本数: 192, 批次损失: 1.3474
处理批次 4/44, 累计样本数: 240, 批次损失: 1.1699
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.9034, AUPRC=0.8420
当前学习率: 0.000013
Epoch 64/100 - 训练损失: 0.1737 - 验证AUROC: 0.9034 - 验证AUPRC: 0.8420
批次 0: 正样本 13, 负样本 35
批次 100: 正样本 13, 负样本 35
批次 200: 正样本 13, 负样本 35
本轮训练: 正样本 39 (27.08%), 负样本 105 (72.92%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.4025
处理批次 1/44, 累计样本数: 96, 批次损失: 0.5340
处理批次 2/44, 累计样本数: 144, 批次损失: 0.9453
处理批次 3/44, 累计样本数: 192, 批次损失: 1.5332
处理批次 4/44, 累计样本数: 240, 批次损失: 1.1617
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.9001, AUPRC=0.8364
当前学习率: 0.000013
Epoch 65/100 - 训练损失: 0.1699 - 验证AUROC: 0.9001 - 验证AUPRC: 0.8364
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 18, 负样本 30
批次 200: 正样本 15, 负样本 33
本轮训练: 正样本 51 (35.42%), 负样本 93 (64.58%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.3085
处理批次 1/44, 累计样本数: 96, 批次损失: 0.5568
处理批次 2/44, 累计样本数: 144, 批次损失: 0.9403
处理批次 3/44, 累计样本数: 192, 批次损失: 1.5802
处理批次 4/44, 累计样本数: 240, 批次损失: 1.2431
测试完成: 处理了 44/44 批次, 2091 个样本
错误批次数: 0
预测标签统计: 正样本数=675, 负样本数=1416
成功计算评估指标: AUROC=0.8999, AUPRC=0.8370
Epoch 00066: reducing learning rate of group 0 to 6.2500e-06.
当前学习率: 0.000006
早停触发！连续15轮验证集性能未提升
测试数据集大小: 22 批次
成功加载最佳模型状态（来自Epoch 51）
开始进行test评估...
处理批次 0/22, 累计样本数: 48, 批次损失: 0.6251
处理批次 1/22, 累计样本数: 96, 批次损失: 0.7676
处理批次 2/22, 累计样本数: 144, 批次损失: 0.7403
处理批次 3/22, 累计样本数: 192, 批次损失: 3.2152
处理批次 4/22, 累计样本数: 240, 批次损失: 0.9153
测试完成: 处理了 22/22 批次, 1039 个样本
错误批次数: 0
预测标签统计: 正样本数=336, 负样本数=703
成功计算评估指标: AUROC=0.8911, AUPRC=0.7999
最佳阈值: 0.2318, 对应的F1分数: 0.8188
混淆矩阵:
[[567 136]
 [ 58 278]]
详细测试结果: AUROC=0.8911, AUPRC=0.7999, F1=0.8188, 敏感度=0.8065, 特异度=0.8274, 准确率=0.8133, 精确度=0.6715
训练完成！最佳模型来自Epoch 51 - AUROC: 0.8911 - F1: 0.8188
结果已保存到: result/DrugBAN3D_balanced_augment_20250609_235921
训练完成时间: 2025年 06月 10日 星期二 02:11:59 CST
=== 训练总结 ===
训练成功完成！
结果保存在: result/DrugBAN3D_balanced_augment_20250609_235921
配置文件: result/DrugBAN3D_balanced_augment_20250609_235921/config/DrugBAN3D_augmented_20250609_235921.yaml
日志文件: result/DrugBAN3D_balanced_augment_20250609_235921/logs/train.log
保存的模型文件:
  result/DrugBAN3D_balanced_augment_20250609_235921/best_model.pth
