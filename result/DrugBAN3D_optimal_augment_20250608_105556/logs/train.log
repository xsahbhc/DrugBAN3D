
================================================================================
DrugBAN 数据增强与标签生成流程
================================================================================
开始时间: 2025-06-08 10:59:00
原始缓存目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/cached_graphs
增强缓存目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250608_105556
原始标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/labels.csv
训练标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/train_stratified.csv
验证标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/val_stratified.csv
测试标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv
增强标签目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250608_105556
是否增强测试集: 否
================================================================================

步骤1：执行数据增强...
读取标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/labels.csv
总样本数: 10436, 正样本数: 3369 (32.28%), 负样本数: 7067 (67.72%)
使用的增强类型: ['gentle_rotate', 'thermal_vibration', 'bond_flexibility', 'smart_combined', 'minimal_edge_dropout']
正样本增强数量: 每个样本1次
负样本增强数量: 每个样本0次

数据增强完成! 耗时: 104.67秒
成功: 10398/10436 (99.64%)
失败记录已保存到 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250608_105556/augment_failures.txt
生成的文件总数: 13758
  原始文件数: 10398
  增强文件数: 3360
增强后样本总数: 13805
  正样本数: 6738 (48.81%)
  负样本数: 7067 (51.19%)

================================================================================
步骤2：为增强数据生成标签文件...
读取原始标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/labels.csv
原始标签文件包含 10436 条记录
使用预划分的测试集标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv
测试集包含 1044 条记录
测试集正样本率: 32.28%
正在从缓存目录 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250608_105556 中读取增强数据...
找到 13758 个缓存文件
从缓存文件中提取标签信息...
增强标签已保存至 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250608_105556/augmented_labels.csv，包含 13758 条记录
正样本: 6720 (48.84%), 负样本: 7038 (51.16%)
数据集划分: 训练集 7955 分子, 验证集 1404 分子, 测试集 1044 分子
验证集当前正样本率: 49.03%, 目标正样本率: 32.28%
调整验证集: 从912个正样本中抽样451个
调整后验证集正样本率: 32.24%
训练标签已保存至 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250608_105556/train_augmented.csv，包含 10523 条记录
验证标签已保存至 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250608_105556/valid_augmented.csv，包含 1399 条记录
测试标签已保存至 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250608_105556/test_augmented.csv，包含 1044 条记录
训练集: 总样本 10523, 正样本率 48.81%
验证集: 总样本 1399, 正样本率 32.24%
测试集: 总样本 1044, 正样本率 32.28%

================================================================================
数据增强与标签生成完成!
增强后的缓存文件保存在: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250608_105556
增强后的标签文件保存在: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250608_105556
结束时间: 2025-06-08 11:01:05
================================================================================

使用命令行指定的输出目录: result/DrugBAN3D_optimal_augment_20250608_105556
已保存当前配置到 result/DrugBAN3D_optimal_augment_20250608_105556/config/config_used.yaml
配置文件: result/DrugBAN3D_optimal_augment_20250608_105556/config/DrugBAN3D_augmented_20250608_105556.yaml
输出目录: result/DrugBAN3D_optimal_augment_20250608_105556
运行设备: cuda
数据加载器使用 16 个工作线程
使用分层采样的预划分数据集
数据集: 训练集 10523 样本, 验证集 1399 样本, 测试集 1044 样本
正样本比例: 训练集 48.81%, 验证集 32.24%, 测试集 32.28%
使用增强数据集进行训练...
加载标签文件: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250608_105556/train_augmented.csv, 包含 10523 条记录
找到 10523/10523 个对应的缓存文件
数据集初始化完成，总样本数: 10523
训练/验证 数据集初始化完成: 10523 个样本
创建数据加载器成功: 预期 220 批次，批次大小 48
加载标签文件: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250608_105556/valid_augmented.csv, 包含 1399 条记录
找到 1399/1399 个对应的缓存文件
数据集初始化完成，总样本数: 1399
训练/验证 数据集初始化完成: 1399 个样本
创建数据加载器成功: 预期 30 批次，批次大小 48
测试模式: 使用原始测试数据
测试标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv
缓存目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/cached_graphs
测试标签文件包含 1044 条记录
测试集标签分布: 正样本 337 (32.28%), 负样本 707 (67.72%)
读取测试标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv, 包含 1044 条记录
成功创建测试标签映射，包含 2088 个条目
测试模式：从标签文件获取 2088 个复合物ID
测试模式：只处理标签文件中的 2088 个样本
在缓存目录中找到 1039/2088 个测试样本缓存文件
数据集初始化完成，总样本数: 1039
测试 数据集初始化完成: 1039 个样本
创建数据加载器成功: 预期 22 批次，批次大小 48

==================================================
DrugBAN3D初始化 - 偏差校正模块: 启用
Dropout率: 0.3
GNN层数: 4
==================================================

优化器: Adam, 学习率: 0.0002, L2正则化强度: 0.0004
启用标签平滑，参数值: 0.05
启用类别加权，正样本权重: 1.050
启用梯度裁剪，阈值：1.0
使用state_dict保存模型，避免完整对象复制
使用plateau学习率调度器
运行设备: cuda
启用标签平滑，参数值: 0.05
启用类别加权，正样本权重: 1.0499999523162842
使用ReduceLROnPlateau学习率调度器，监控验证集AUROC
开始训练...
批次 0: 正样本 26, 负样本 22
批次 100: 正样本 29, 负样本 19
批次 200: 正样本 19, 负样本 29
本轮训练: 正样本 74 (51.39%), 负样本 70 (48.61%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.6986
处理批次 1/30, 累计样本数: 96, 批次损失: 0.6834
处理批次 2/30, 累计样本数: 144, 批次损失: 0.8427
处理批次 3/30, 累计样本数: 192, 批次损失: 0.7366
处理批次 4/30, 累计样本数: 240, 批次损失: 0.7196
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.5860, AUPRC=0.3993
当前学习率: 0.000200
保存最佳模型（轮次 1）到 result/DrugBAN3D_optimal_augment_20250608_105556/best_model.pth
Epoch 1/100 - 训练损失: 2.3661 - 验证AUROC: 0.5860 - 验证AUPRC: 0.3993
批次 0: 正样本 25, 负样本 23
批次 100: 正样本 32, 负样本 16
批次 200: 正样本 22, 负样本 26
本轮训练: 正样本 79 (54.86%), 负样本 65 (45.14%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.5871
处理批次 1/30, 累计样本数: 96, 批次损失: 0.7495
处理批次 2/30, 累计样本数: 144, 批次损失: 0.8280
处理批次 3/30, 累计样本数: 192, 批次损失: 0.7587
处理批次 4/30, 累计样本数: 240, 批次损失: 0.6411
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.6900, AUPRC=0.4908
当前学习率: 0.000200
保存最佳模型（轮次 2）到 result/DrugBAN3D_optimal_augment_20250608_105556/best_model.pth
Epoch 2/100 - 训练损失: 1.5997 - 验证AUROC: 0.6900 - 验证AUPRC: 0.4908
批次 0: 正样本 23, 负样本 25
批次 100: 正样本 25, 负样本 23
批次 200: 正样本 24, 负样本 24
本轮训练: 正样本 72 (50.00%), 负样本 72 (50.00%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.5850
处理批次 1/30, 累计样本数: 96, 批次损失: 0.7386
处理批次 2/30, 累计样本数: 144, 批次损失: 1.1127
处理批次 3/30, 累计样本数: 192, 批次损失: 0.7811
处理批次 4/30, 累计样本数: 240, 批次损失: 0.9147
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.7266, AUPRC=0.5338
当前学习率: 0.000200
保存最佳模型（轮次 3）到 result/DrugBAN3D_optimal_augment_20250608_105556/best_model.pth
Epoch 3/100 - 训练损失: 1.4845 - 验证AUROC: 0.7266 - 验证AUPRC: 0.5338
批次 0: 正样本 23, 负样本 25
批次 100: 正样本 26, 负样本 22
批次 200: 正样本 24, 负样本 24
本轮训练: 正样本 73 (50.69%), 负样本 71 (49.31%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.5825
处理批次 1/30, 累计样本数: 96, 批次损失: 0.5870
处理批次 2/30, 累计样本数: 144, 批次损失: 0.7990
处理批次 3/30, 累计样本数: 192, 批次损失: 0.6816
处理批次 4/30, 累计样本数: 240, 批次损失: 0.8869
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.7679, AUPRC=0.5647
当前学习率: 0.000200
保存最佳模型（轮次 4）到 result/DrugBAN3D_optimal_augment_20250608_105556/best_model.pth
Epoch 4/100 - 训练损失: 1.3468 - 验证AUROC: 0.7679 - 验证AUPRC: 0.5647
批次 0: 正样本 19, 负样本 29
批次 100: 正样本 24, 负样本 24
批次 200: 正样本 22, 负样本 26
本轮训练: 正样本 65 (45.14%), 负样本 79 (54.86%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.7129
处理批次 1/30, 累计样本数: 96, 批次损失: 0.5800
处理批次 2/30, 累计样本数: 144, 批次损失: 1.0577
处理批次 3/30, 累计样本数: 192, 批次损失: 0.8249
处理批次 4/30, 累计样本数: 240, 批次损失: 0.7749
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.7645, AUPRC=0.5851
当前学习率: 0.000200
Epoch 5/100 - 训练损失: 1.0802 - 验证AUROC: 0.7645 - 验证AUPRC: 0.5851
批次 0: 正样本 27, 负样本 21
批次 100: 正样本 28, 负样本 20
批次 200: 正样本 19, 负样本 29
本轮训练: 正样本 74 (51.39%), 负样本 70 (48.61%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.5768
处理批次 1/30, 累计样本数: 96, 批次损失: 0.5476
处理批次 2/30, 累计样本数: 144, 批次损失: 0.5259
处理批次 3/30, 累计样本数: 192, 批次损失: 0.5737
处理批次 4/30, 累计样本数: 240, 批次损失: 0.5772
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.7907, AUPRC=0.6419
当前学习率: 0.000200
保存最佳模型（轮次 6）到 result/DrugBAN3D_optimal_augment_20250608_105556/best_model.pth
Epoch 6/100 - 训练损失: 1.0416 - 验证AUROC: 0.7907 - 验证AUPRC: 0.6419
批次 0: 正样本 25, 负样本 23
批次 100: 正样本 27, 负样本 21
批次 200: 正样本 22, 负样本 26
本轮训练: 正样本 74 (51.39%), 负样本 70 (48.61%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.5787
处理批次 1/30, 累计样本数: 96, 批次损失: 0.5286
处理批次 2/30, 累计样本数: 144, 批次损失: 0.7087
处理批次 3/30, 累计样本数: 192, 批次损失: 0.6617
处理批次 4/30, 累计样本数: 240, 批次损失: 0.6458
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8239, AUPRC=0.6674
当前学习率: 0.000200
保存最佳模型（轮次 7）到 result/DrugBAN3D_optimal_augment_20250608_105556/best_model.pth
Epoch 7/100 - 训练损失: 1.0273 - 验证AUROC: 0.8239 - 验证AUPRC: 0.6674
批次 0: 正样本 25, 负样本 23
批次 100: 正样本 26, 负样本 22
批次 200: 正样本 23, 负样本 25
本轮训练: 正样本 74 (51.39%), 负样本 70 (48.61%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.7863
处理批次 1/30, 累计样本数: 96, 批次损失: 0.5723
处理批次 2/30, 累计样本数: 144, 批次损失: 0.6725
处理批次 3/30, 累计样本数: 192, 批次损失: 0.6936
处理批次 4/30, 累计样本数: 240, 批次损失: 0.8777
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.7937, AUPRC=0.6452
当前学习率: 0.000200
Epoch 8/100 - 训练损失: 0.8643 - 验证AUROC: 0.7937 - 验证AUPRC: 0.6452
批次 0: 正样本 25, 负样本 23
批次 100: 正样本 26, 负样本 22
批次 200: 正样本 22, 负样本 26
本轮训练: 正样本 73 (50.69%), 负样本 71 (49.31%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.7998
处理批次 1/30, 累计样本数: 96, 批次损失: 0.5105
处理批次 2/30, 累计样本数: 144, 批次损失: 0.7475
处理批次 3/30, 累计样本数: 192, 批次损失: 0.5833
处理批次 4/30, 累计样本数: 240, 批次损失: 0.7536
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8074, AUPRC=0.6492
当前学习率: 0.000200
Epoch 9/100 - 训练损失: 0.7913 - 验证AUROC: 0.8074 - 验证AUPRC: 0.6492
批次 0: 正样本 19, 负样本 29
批次 100: 正样本 27, 负样本 21
批次 200: 正样本 22, 负样本 26
本轮训练: 正样本 68 (47.22%), 负样本 76 (52.78%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.6363
处理批次 1/30, 累计样本数: 96, 批次损失: 0.6781
处理批次 2/30, 累计样本数: 144, 批次损失: 0.7300
处理批次 3/30, 累计样本数: 192, 批次损失: 0.6179
处理批次 4/30, 累计样本数: 240, 批次损失: 0.8798
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8172, AUPRC=0.6758
当前学习率: 0.000200
Epoch 10/100 - 训练损失: 0.7601 - 验证AUROC: 0.8172 - 验证AUPRC: 0.6758
批次 0: 正样本 25, 负样本 23
批次 100: 正样本 25, 负样本 23
批次 200: 正样本 24, 负样本 24
本轮训练: 正样本 74 (51.39%), 负样本 70 (48.61%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.7200
处理批次 1/30, 累计样本数: 96, 批次损失: 0.7057
处理批次 2/30, 累计样本数: 144, 批次损失: 0.7363
处理批次 3/30, 累计样本数: 192, 批次损失: 0.7395
处理批次 4/30, 累计样本数: 240, 批次损失: 1.1570
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8381, AUPRC=0.7104
当前学习率: 0.000200
保存最佳模型（轮次 11）到 result/DrugBAN3D_optimal_augment_20250608_105556/best_model.pth
Epoch 11/100 - 训练损失: 0.6957 - 验证AUROC: 0.8381 - 验证AUPRC: 0.7104
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 23, 负样本 25
批次 200: 正样本 20, 负样本 28
本轮训练: 正样本 61 (42.36%), 负样本 83 (57.64%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.7836
处理批次 1/30, 累计样本数: 96, 批次损失: 0.7000
处理批次 2/30, 累计样本数: 144, 批次损失: 0.8399
处理批次 3/30, 累计样本数: 192, 批次损失: 0.6157
处理批次 4/30, 累计样本数: 240, 批次损失: 1.0624
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8300, AUPRC=0.6973
当前学习率: 0.000200
Epoch 12/100 - 训练损失: 0.6495 - 验证AUROC: 0.8300 - 验证AUPRC: 0.6973
批次 0: 正样本 22, 负样本 26
批次 100: 正样本 23, 负样本 25
批次 200: 正样本 20, 负样本 28
本轮训练: 正样本 65 (45.14%), 负样本 79 (54.86%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.6615
处理批次 1/30, 累计样本数: 96, 批次损失: 0.7108
处理批次 2/30, 累计样本数: 144, 批次损失: 0.6986
处理批次 3/30, 累计样本数: 192, 批次损失: 0.4702
处理批次 4/30, 累计样本数: 240, 批次损失: 0.8270
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8604, AUPRC=0.7378
当前学习率: 0.000200
保存最佳模型（轮次 13）到 result/DrugBAN3D_optimal_augment_20250608_105556/best_model.pth
Epoch 13/100 - 训练损失: 0.5338 - 验证AUROC: 0.8604 - 验证AUPRC: 0.7378
批次 0: 正样本 28, 负样本 20
批次 100: 正样本 22, 负样本 26
批次 200: 正样本 25, 负样本 23
本轮训练: 正样本 75 (52.08%), 负样本 69 (47.92%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.6105
处理批次 1/30, 累计样本数: 96, 批次损失: 0.6588
处理批次 2/30, 累计样本数: 144, 批次损失: 0.6264
处理批次 3/30, 累计样本数: 192, 批次损失: 0.5995
处理批次 4/30, 累计样本数: 240, 批次损失: 1.0162
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8627, AUPRC=0.7421
当前学习率: 0.000200
保存最佳模型（轮次 14）到 result/DrugBAN3D_optimal_augment_20250608_105556/best_model.pth
Epoch 14/100 - 训练损失: 0.5166 - 验证AUROC: 0.8627 - 验证AUPRC: 0.7421
批次 0: 正样本 25, 负样本 23
批次 100: 正样本 23, 负样本 25
批次 200: 正样本 22, 负样本 26
本轮训练: 正样本 70 (48.61%), 负样本 74 (51.39%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.6487
处理批次 1/30, 累计样本数: 96, 批次损失: 0.6400
处理批次 2/30, 累计样本数: 144, 批次损失: 0.5874
处理批次 3/30, 累计样本数: 192, 批次损失: 0.4971
处理批次 4/30, 累计样本数: 240, 批次损失: 0.7520
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8694, AUPRC=0.7700
当前学习率: 0.000200
保存最佳模型（轮次 15）到 result/DrugBAN3D_optimal_augment_20250608_105556/best_model.pth
Epoch 15/100 - 训练损失: 0.5376 - 验证AUROC: 0.8694 - 验证AUPRC: 0.7700
批次 0: 正样本 21, 负样本 27
批次 100: 正样本 25, 负样本 23
批次 200: 正样本 18, 负样本 30
本轮训练: 正样本 64 (44.44%), 负样本 80 (55.56%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.6412
处理批次 1/30, 累计样本数: 96, 批次损失: 0.6699
处理批次 2/30, 累计样本数: 144, 批次损失: 0.5521
处理批次 3/30, 累计样本数: 192, 批次损失: 0.6035
处理批次 4/30, 累计样本数: 240, 批次损失: 0.9571
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8654, AUPRC=0.7705
当前学习率: 0.000200
Epoch 16/100 - 训练损失: 0.4558 - 验证AUROC: 0.8654 - 验证AUPRC: 0.7705
批次 0: 正样本 24, 负样本 24
批次 100: 正样本 23, 负样本 25
批次 200: 正样本 18, 负样本 30
本轮训练: 正样本 65 (45.14%), 负样本 79 (54.86%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.1779
处理批次 1/30, 累计样本数: 96, 批次损失: 0.8295
处理批次 2/30, 累计样本数: 144, 批次损失: 0.6161
处理批次 3/30, 累计样本数: 192, 批次损失: 0.5952
处理批次 4/30, 累计样本数: 240, 批次损失: 1.1906
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8635, AUPRC=0.7581
当前学习率: 0.000200
Epoch 17/100 - 训练损失: 0.4808 - 验证AUROC: 0.8635 - 验证AUPRC: 0.7581
批次 0: 正样本 28, 负样本 20
批次 100: 正样本 22, 负样本 26
批次 200: 正样本 20, 负样本 28
本轮训练: 正样本 70 (48.61%), 负样本 74 (51.39%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.7797
处理批次 1/30, 累计样本数: 96, 批次损失: 0.7889
处理批次 2/30, 累计样本数: 144, 批次损失: 0.5832
处理批次 3/30, 累计样本数: 192, 批次损失: 0.8015
处理批次 4/30, 累计样本数: 240, 批次损失: 0.9822
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8736, AUPRC=0.7643
当前学习率: 0.000200
保存最佳模型（轮次 18）到 result/DrugBAN3D_optimal_augment_20250608_105556/best_model.pth
Epoch 18/100 - 训练损失: 0.4354 - 验证AUROC: 0.8736 - 验证AUPRC: 0.7643
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 18, 负样本 30
批次 200: 正样本 23, 负样本 25
本轮训练: 正样本 59 (40.97%), 负样本 85 (59.03%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.6784
处理批次 1/30, 累计样本数: 96, 批次损失: 0.7251
处理批次 2/30, 累计样本数: 144, 批次损失: 0.8319
处理批次 3/30, 累计样本数: 192, 批次损失: 0.6061
处理批次 4/30, 累计样本数: 240, 批次损失: 0.9345
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8786, AUPRC=0.7906
当前学习率: 0.000200
保存最佳模型（轮次 19）到 result/DrugBAN3D_optimal_augment_20250608_105556/best_model.pth
Epoch 19/100 - 训练损失: 0.4482 - 验证AUROC: 0.8786 - 验证AUPRC: 0.7906
批次 0: 正样本 24, 负样本 24
批次 100: 正样本 23, 负样本 25
批次 200: 正样本 29, 负样本 19
本轮训练: 正样本 76 (52.78%), 负样本 68 (47.22%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.1869
处理批次 1/30, 累计样本数: 96, 批次损失: 0.7842
处理批次 2/30, 累计样本数: 144, 批次损失: 0.6744
处理批次 3/30, 累计样本数: 192, 批次损失: 0.7940
处理批次 4/30, 累计样本数: 240, 批次损失: 0.9891
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8746, AUPRC=0.7832
当前学习率: 0.000200
Epoch 20/100 - 训练损失: 0.4352 - 验证AUROC: 0.8746 - 验证AUPRC: 0.7832
批次 0: 正样本 23, 负样本 25
批次 100: 正样本 21, 负样本 27
批次 200: 正样本 25, 负样本 23
本轮训练: 正样本 69 (47.92%), 负样本 75 (52.08%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.8147
处理批次 1/30, 累计样本数: 96, 批次损失: 0.7987
处理批次 2/30, 累计样本数: 144, 批次损失: 0.6838
处理批次 3/30, 累计样本数: 192, 批次损失: 0.8454
处理批次 4/30, 累计样本数: 240, 批次损失: 1.0010
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8779, AUPRC=0.7914
当前学习率: 0.000200
Epoch 21/100 - 训练损失: 0.3998 - 验证AUROC: 0.8779 - 验证AUPRC: 0.7914
批次 0: 正样本 24, 负样本 24
批次 100: 正样本 27, 负样本 21
批次 200: 正样本 22, 负样本 26
本轮训练: 正样本 73 (50.69%), 负样本 71 (49.31%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.9249
处理批次 1/30, 累计样本数: 96, 批次损失: 0.9222
处理批次 2/30, 累计样本数: 144, 批次损失: 0.7313
处理批次 3/30, 累计样本数: 192, 批次损失: 0.6449
处理批次 4/30, 累计样本数: 240, 批次损失: 1.2487
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8674, AUPRC=0.7759
当前学习率: 0.000200
Epoch 22/100 - 训练损失: 0.3834 - 验证AUROC: 0.8674 - 验证AUPRC: 0.7759
批次 0: 正样本 21, 负样本 27
批次 100: 正样本 27, 负样本 21
批次 200: 正样本 25, 负样本 23
本轮训练: 正样本 73 (50.69%), 负样本 71 (49.31%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.6743
处理批次 1/30, 累计样本数: 96, 批次损失: 0.9336
处理批次 2/30, 累计样本数: 144, 批次损失: 0.6882
处理批次 3/30, 累计样本数: 192, 批次损失: 0.5332
处理批次 4/30, 累计样本数: 240, 批次损失: 0.9473
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8771, AUPRC=0.7873
当前学习率: 0.000200
Epoch 23/100 - 训练损失: 0.3940 - 验证AUROC: 0.8771 - 验证AUPRC: 0.7873
批次 0: 正样本 22, 负样本 26
批次 100: 正样本 31, 负样本 17
批次 200: 正样本 22, 负样本 26
本轮训练: 正样本 75 (52.08%), 负样本 69 (47.92%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.7836
处理批次 1/30, 累计样本数: 96, 批次损失: 0.8194
处理批次 2/30, 累计样本数: 144, 批次损失: 0.6187
处理批次 3/30, 累计样本数: 192, 批次损失: 0.5435
处理批次 4/30, 累计样本数: 240, 批次损失: 1.2678
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8829, AUPRC=0.7925
当前学习率: 0.000200
保存最佳模型（轮次 24）到 result/DrugBAN3D_optimal_augment_20250608_105556/best_model.pth
Epoch 24/100 - 训练损失: 0.3847 - 验证AUROC: 0.8829 - 验证AUPRC: 0.7925
批次 0: 正样本 21, 负样本 27
批次 100: 正样本 25, 负样本 23
批次 200: 正样本 17, 负样本 31
本轮训练: 正样本 63 (43.75%), 负样本 81 (56.25%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.9952
处理批次 1/30, 累计样本数: 96, 批次损失: 0.6924
处理批次 2/30, 累计样本数: 144, 批次损失: 0.7747
处理批次 3/30, 累计样本数: 192, 批次损失: 0.6164
处理批次 4/30, 累计样本数: 240, 批次损失: 0.9697
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8897, AUPRC=0.8142
当前学习率: 0.000200
保存最佳模型（轮次 25）到 result/DrugBAN3D_optimal_augment_20250608_105556/best_model.pth
Epoch 25/100 - 训练损失: 0.3663 - 验证AUROC: 0.8897 - 验证AUPRC: 0.8142
批次 0: 正样本 21, 负样本 27
批次 100: 正样本 30, 负样本 18
批次 200: 正样本 29, 负样本 19
本轮训练: 正样本 80 (55.56%), 负样本 64 (44.44%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.9867
处理批次 1/30, 累计样本数: 96, 批次损失: 0.9275
处理批次 2/30, 累计样本数: 144, 批次损失: 1.0058
处理批次 3/30, 累计样本数: 192, 批次损失: 1.1034
处理批次 4/30, 累计样本数: 240, 批次损失: 1.1578
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8661, AUPRC=0.7667
当前学习率: 0.000200
Epoch 26/100 - 训练损失: 0.3484 - 验证AUROC: 0.8661 - 验证AUPRC: 0.7667
批次 0: 正样本 23, 负样本 25
批次 100: 正样本 25, 负样本 23
批次 200: 正样本 20, 负样本 28
本轮训练: 正样本 68 (47.22%), 负样本 76 (52.78%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.9748
处理批次 1/30, 累计样本数: 96, 批次损失: 0.9701
处理批次 2/30, 累计样本数: 144, 批次损失: 0.8281
处理批次 3/30, 累计样本数: 192, 批次损失: 0.6483
处理批次 4/30, 累计样本数: 240, 批次损失: 0.9498
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8740, AUPRC=0.7799
当前学习率: 0.000200
Epoch 27/100 - 训练损失: 0.3468 - 验证AUROC: 0.8740 - 验证AUPRC: 0.7799
批次 0: 正样本 17, 负样本 31
批次 100: 正样本 19, 负样本 29
批次 200: 正样本 24, 负样本 24
本轮训练: 正样本 60 (41.67%), 负样本 84 (58.33%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.0220
处理批次 1/30, 累计样本数: 96, 批次损失: 1.1294
处理批次 2/30, 累计样本数: 144, 批次损失: 1.0541
处理批次 3/30, 累计样本数: 192, 批次损失: 0.7442
处理批次 4/30, 累计样本数: 240, 批次损失: 1.2229
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8771, AUPRC=0.7964
当前学习率: 0.000200
Epoch 28/100 - 训练损失: 0.3735 - 验证AUROC: 0.8771 - 验证AUPRC: 0.7964
批次 0: 正样本 26, 负样本 22
批次 100: 正样本 26, 负样本 22
批次 200: 正样本 23, 负样本 25
本轮训练: 正样本 75 (52.08%), 负样本 69 (47.92%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.1017
处理批次 1/30, 累计样本数: 96, 批次损失: 2.1900
处理批次 2/30, 累计样本数: 144, 批次损失: 0.7265
处理批次 3/30, 累计样本数: 192, 批次损失: 0.8340
处理批次 4/30, 累计样本数: 240, 批次损失: 1.1770
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8788, AUPRC=0.7892
当前学习率: 0.000200
Epoch 29/100 - 训练损失: 0.3520 - 验证AUROC: 0.8788 - 验证AUPRC: 0.7892
批次 0: 正样本 20, 负样本 28
批次 100: 正样本 26, 负样本 22
批次 200: 正样本 26, 负样本 22
本轮训练: 正样本 72 (50.00%), 负样本 72 (50.00%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.8513
处理批次 1/30, 累计样本数: 96, 批次损失: 1.0712
处理批次 2/30, 累计样本数: 144, 批次损失: 0.7575
处理批次 3/30, 累计样本数: 192, 批次损失: 0.6979
处理批次 4/30, 累计样本数: 240, 批次损失: 1.3021
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8798, AUPRC=0.7901
Epoch 00030: reducing learning rate of group 0 to 1.0000e-04.
当前学习率: 0.000100
Epoch 30/100 - 训练损失: 0.3344 - 验证AUROC: 0.8798 - 验证AUPRC: 0.7901
批次 0: 正样本 25, 负样本 23
批次 100: 正样本 23, 负样本 25
批次 200: 正样本 26, 负样本 22
本轮训练: 正样本 74 (51.39%), 负样本 70 (48.61%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.0571
处理批次 1/30, 累计样本数: 96, 批次损失: 1.6459
处理批次 2/30, 累计样本数: 144, 批次损失: 0.9321
处理批次 3/30, 累计样本数: 192, 批次损失: 0.7360
处理批次 4/30, 累计样本数: 240, 批次损失: 1.4981
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8763, AUPRC=0.7878
当前学习率: 0.000100
Epoch 31/100 - 训练损失: 0.2826 - 验证AUROC: 0.8763 - 验证AUPRC: 0.7878
批次 0: 正样本 28, 负样本 20
批次 100: 正样本 18, 负样本 30
批次 200: 正样本 26, 负样本 22
本轮训练: 正样本 72 (50.00%), 负样本 72 (50.00%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.8298
处理批次 1/30, 累计样本数: 96, 批次损失: 1.0335
处理批次 2/30, 累计样本数: 144, 批次损失: 0.8751
处理批次 3/30, 累计样本数: 192, 批次损失: 0.8804
处理批次 4/30, 累计样本数: 240, 批次损失: 1.3392
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8865, AUPRC=0.7933
当前学习率: 0.000100
Epoch 32/100 - 训练损失: 0.2635 - 验证AUROC: 0.8865 - 验证AUPRC: 0.7933
批次 0: 正样本 27, 负样本 21
批次 100: 正样本 19, 负样本 29
批次 200: 正样本 21, 负样本 27
本轮训练: 正样本 67 (46.53%), 负样本 77 (53.47%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.8724
处理批次 1/30, 累计样本数: 96, 批次损失: 0.9514
处理批次 2/30, 累计样本数: 144, 批次损失: 0.8826
处理批次 3/30, 累计样本数: 192, 批次损失: 0.7596
处理批次 4/30, 累计样本数: 240, 批次损失: 1.3371
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8924, AUPRC=0.8136
当前学习率: 0.000100
保存最佳模型（轮次 33）到 result/DrugBAN3D_optimal_augment_20250608_105556/best_model.pth
Epoch 33/100 - 训练损失: 0.2571 - 验证AUROC: 0.8924 - 验证AUPRC: 0.8136
批次 0: 正样本 25, 负样本 23
批次 100: 正样本 28, 负样本 20
批次 200: 正样本 21, 负样本 27
本轮训练: 正样本 74 (51.39%), 负样本 70 (48.61%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.9256
处理批次 1/30, 累计样本数: 96, 批次损失: 1.5024
处理批次 2/30, 累计样本数: 144, 批次损失: 0.7644
处理批次 3/30, 累计样本数: 192, 批次损失: 0.8617
处理批次 4/30, 累计样本数: 240, 批次损失: 1.3644
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8896, AUPRC=0.8052
当前学习率: 0.000100
Epoch 34/100 - 训练损失: 0.2427 - 验证AUROC: 0.8896 - 验证AUPRC: 0.8052
批次 0: 正样本 25, 负样本 23
批次 100: 正样本 21, 负样本 27
批次 200: 正样本 29, 负样本 19
本轮训练: 正样本 75 (52.08%), 负样本 69 (47.92%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.3760
处理批次 1/30, 累计样本数: 96, 批次损失: 2.1264
处理批次 2/30, 累计样本数: 144, 批次损失: 0.9504
处理批次 3/30, 累计样本数: 192, 批次损失: 0.7946
处理批次 4/30, 累计样本数: 240, 批次损失: 1.2642
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8771, AUPRC=0.7878
当前学习率: 0.000100
Epoch 35/100 - 训练损失: 0.2433 - 验证AUROC: 0.8771 - 验证AUPRC: 0.7878
批次 0: 正样本 27, 负样本 21
批次 100: 正样本 22, 负样本 26
批次 200: 正样本 24, 负样本 24
本轮训练: 正样本 73 (50.69%), 负样本 71 (49.31%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.8158
处理批次 1/30, 累计样本数: 96, 批次损失: 1.2018
处理批次 2/30, 累计样本数: 144, 批次损失: 0.8675
处理批次 3/30, 累计样本数: 192, 批次损失: 0.7986
处理批次 4/30, 累计样本数: 240, 批次损失: 1.5151
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8866, AUPRC=0.8054
当前学习率: 0.000100
Epoch 36/100 - 训练损失: 0.2483 - 验证AUROC: 0.8866 - 验证AUPRC: 0.8054
批次 0: 正样本 21, 负样本 27
批次 100: 正样本 25, 负样本 23
批次 200: 正样本 25, 负样本 23
本轮训练: 正样本 71 (49.31%), 负样本 73 (50.69%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.0563
处理批次 1/30, 累计样本数: 96, 批次损失: 1.9215
处理批次 2/30, 累计样本数: 144, 批次损失: 1.0534
处理批次 3/30, 累计样本数: 192, 批次损失: 0.8240
处理批次 4/30, 累计样本数: 240, 批次损失: 1.2623
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8895, AUPRC=0.8127
当前学习率: 0.000100
Epoch 37/100 - 训练损失: 0.2541 - 验证AUROC: 0.8895 - 验证AUPRC: 0.8127
批次 0: 正样本 27, 负样本 21
批次 100: 正样本 24, 负样本 24
批次 200: 正样本 20, 负样本 28
本轮训练: 正样本 71 (49.31%), 负样本 73 (50.69%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 0.9746
处理批次 1/30, 累计样本数: 96, 批次损失: 2.0966
处理批次 2/30, 累计样本数: 144, 批次损失: 0.7585
处理批次 3/30, 累计样本数: 192, 批次损失: 0.9045
处理批次 4/30, 累计样本数: 240, 批次损失: 2.1058
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8759, AUPRC=0.7961
Epoch 00038: reducing learning rate of group 0 to 5.0000e-05.
当前学习率: 0.000050
Epoch 38/100 - 训练损失: 0.2564 - 验证AUROC: 0.8759 - 验证AUPRC: 0.7961
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 28, 负样本 20
批次 200: 正样本 26, 负样本 22
本轮训练: 正样本 72 (50.00%), 负样本 72 (50.00%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.0191
处理批次 1/30, 累计样本数: 96, 批次损失: 1.4333
处理批次 2/30, 累计样本数: 144, 批次损失: 0.9207
处理批次 3/30, 累计样本数: 192, 批次损失: 0.8289
处理批次 4/30, 累计样本数: 240, 批次损失: 1.4470
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8876, AUPRC=0.8127
当前学习率: 0.000050
Epoch 39/100 - 训练损失: 0.2251 - 验证AUROC: 0.8876 - 验证AUPRC: 0.8127
批次 0: 正样本 17, 负样本 31
批次 100: 正样本 25, 负样本 23
批次 200: 正样本 26, 负样本 22
本轮训练: 正样本 68 (47.22%), 负样本 76 (52.78%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.0530
处理批次 1/30, 累计样本数: 96, 批次损失: 2.0733
处理批次 2/30, 累计样本数: 144, 批次损失: 1.1150
处理批次 3/30, 累计样本数: 192, 批次损失: 0.8113
处理批次 4/30, 累计样本数: 240, 批次损失: 1.9183
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8909, AUPRC=0.8099
当前学习率: 0.000050
Epoch 40/100 - 训练损失: 0.2098 - 验证AUROC: 0.8909 - 验证AUPRC: 0.8099
批次 0: 正样本 21, 负样本 27
批次 100: 正样本 28, 负样本 20
批次 200: 正样本 22, 负样本 26
本轮训练: 正样本 71 (49.31%), 负样本 73 (50.69%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.0695
处理批次 1/30, 累计样本数: 96, 批次损失: 1.6805
处理批次 2/30, 累计样本数: 144, 批次损失: 1.0511
处理批次 3/30, 累计样本数: 192, 批次损失: 0.8535
处理批次 4/30, 累计样本数: 240, 批次损失: 1.8244
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8886, AUPRC=0.8090
当前学习率: 0.000050
Epoch 41/100 - 训练损失: 0.2124 - 验证AUROC: 0.8886 - 验证AUPRC: 0.8090
批次 0: 正样本 29, 负样本 19
批次 100: 正样本 23, 负样本 25
批次 200: 正样本 21, 负样本 27
本轮训练: 正样本 73 (50.69%), 负样本 71 (49.31%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.1868
处理批次 1/30, 累计样本数: 96, 批次损失: 2.8311
处理批次 2/30, 累计样本数: 144, 批次损失: 1.1080
处理批次 3/30, 累计样本数: 192, 批次损失: 1.0213
处理批次 4/30, 累计样本数: 240, 批次损失: 2.0295
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8914, AUPRC=0.8044
当前学习率: 0.000050
Epoch 42/100 - 训练损失: 0.1910 - 验证AUROC: 0.8914 - 验证AUPRC: 0.8044
批次 0: 正样本 29, 负样本 19
批次 100: 正样本 20, 负样本 28
批次 200: 正样本 25, 负样本 23
本轮训练: 正样本 74 (51.39%), 负样本 70 (48.61%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.1702
处理批次 1/30, 累计样本数: 96, 批次损失: 2.1787
处理批次 2/30, 累计样本数: 144, 批次损失: 1.0275
处理批次 3/30, 累计样本数: 192, 批次损失: 0.8974
处理批次 4/30, 累计样本数: 240, 批次损失: 1.9326
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8888, AUPRC=0.8053
Epoch 00043: reducing learning rate of group 0 to 2.5000e-05.
当前学习率: 0.000025
Epoch 43/100 - 训练损失: 0.1916 - 验证AUROC: 0.8888 - 验证AUPRC: 0.8053
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 31, 负样本 17
批次 200: 正样本 20, 负样本 28
本轮训练: 正样本 69 (47.92%), 负样本 75 (52.08%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.1951
处理批次 1/30, 累计样本数: 96, 批次损失: 2.7254
处理批次 2/30, 累计样本数: 144, 批次损失: 1.0716
处理批次 3/30, 累计样本数: 192, 批次损失: 0.8539
处理批次 4/30, 累计样本数: 240, 批次损失: 2.1260
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8898, AUPRC=0.8058
当前学习率: 0.000025
Epoch 44/100 - 训练损失: 0.1848 - 验证AUROC: 0.8898 - 验证AUPRC: 0.8058
批次 0: 正样本 30, 负样本 18
批次 100: 正样本 26, 负样本 22
批次 200: 正样本 22, 负样本 26
本轮训练: 正样本 78 (54.17%), 负样本 66 (45.83%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.1835
处理批次 1/30, 累计样本数: 96, 批次损失: 2.1448
处理批次 2/30, 累计样本数: 144, 批次损失: 0.8836
处理批次 3/30, 累计样本数: 192, 批次损失: 0.9920
处理批次 4/30, 累计样本数: 240, 批次损失: 1.7435
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8928, AUPRC=0.8155
当前学习率: 0.000025
保存最佳模型（轮次 45）到 result/DrugBAN3D_optimal_augment_20250608_105556/best_model.pth
Epoch 45/100 - 训练损失: 0.1806 - 验证AUROC: 0.8928 - 验证AUPRC: 0.8155
批次 0: 正样本 28, 负样本 20
批次 100: 正样本 27, 负样本 21
批次 200: 正样本 24, 负样本 24
本轮训练: 正样本 79 (54.86%), 负样本 65 (45.14%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.3811
处理批次 1/30, 累计样本数: 96, 批次损失: 2.3085
处理批次 2/30, 累计样本数: 144, 批次损失: 0.9337
处理批次 3/30, 累计样本数: 192, 批次损失: 0.8951
处理批次 4/30, 累计样本数: 240, 批次损失: 2.0150
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8970, AUPRC=0.8218
当前学习率: 0.000025
保存最佳模型（轮次 46）到 result/DrugBAN3D_optimal_augment_20250608_105556/best_model.pth
Epoch 46/100 - 训练损失: 0.1768 - 验证AUROC: 0.8970 - 验证AUPRC: 0.8218
批次 0: 正样本 29, 负样本 19
批次 100: 正样本 23, 负样本 25
批次 200: 正样本 21, 负样本 27
本轮训练: 正样本 73 (50.69%), 负样本 71 (49.31%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.4161
处理批次 1/30, 累计样本数: 96, 批次损失: 1.9704
处理批次 2/30, 累计样本数: 144, 批次损失: 1.0748
处理批次 3/30, 累计样本数: 192, 批次损失: 0.9608
处理批次 4/30, 累计样本数: 240, 批次损失: 1.6634
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8945, AUPRC=0.8225
当前学习率: 0.000025
Epoch 47/100 - 训练损失: 0.1745 - 验证AUROC: 0.8945 - 验证AUPRC: 0.8225
批次 0: 正样本 24, 负样本 24
批次 100: 正样本 22, 负样本 26
批次 200: 正样本 22, 负样本 26
本轮训练: 正样本 68 (47.22%), 负样本 76 (52.78%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.5575
处理批次 1/30, 累计样本数: 96, 批次损失: 2.6655
处理批次 2/30, 累计样本数: 144, 批次损失: 1.1575
处理批次 3/30, 累计样本数: 192, 批次损失: 0.8791
处理批次 4/30, 累计样本数: 240, 批次损失: 2.2440
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8922, AUPRC=0.8138
当前学习率: 0.000025
Epoch 48/100 - 训练损失: 0.1774 - 验证AUROC: 0.8922 - 验证AUPRC: 0.8138
批次 0: 正样本 21, 负样本 27
批次 100: 正样本 20, 负样本 28
批次 200: 正样本 28, 负样本 20
本轮训练: 正样本 69 (47.92%), 负样本 75 (52.08%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.8542
处理批次 1/30, 累计样本数: 96, 批次损失: 3.1097
处理批次 2/30, 累计样本数: 144, 批次损失: 1.4008
处理批次 3/30, 累计样本数: 192, 批次损失: 0.8523
处理批次 4/30, 累计样本数: 240, 批次损失: 2.0406
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8898, AUPRC=0.8141
当前学习率: 0.000025
Epoch 49/100 - 训练损失: 0.1686 - 验证AUROC: 0.8898 - 验证AUPRC: 0.8141
批次 0: 正样本 20, 负样本 28
批次 100: 正样本 23, 负样本 25
批次 200: 正样本 23, 负样本 25
本轮训练: 正样本 66 (45.83%), 负样本 78 (54.17%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.8304
处理批次 1/30, 累计样本数: 96, 批次损失: 1.7431
处理批次 2/30, 累计样本数: 144, 批次损失: 1.3178
处理批次 3/30, 累计样本数: 192, 批次损失: 0.8649
处理批次 4/30, 累计样本数: 240, 批次损失: 2.2357
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8927, AUPRC=0.8136
当前学习率: 0.000025
Epoch 50/100 - 训练损失: 0.1661 - 验证AUROC: 0.8927 - 验证AUPRC: 0.8136
批次 0: 正样本 16, 负样本 32
批次 100: 正样本 21, 负样本 27
批次 200: 正样本 22, 负样本 26
本轮训练: 正样本 59 (40.97%), 负样本 85 (59.03%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.7455
处理批次 1/30, 累计样本数: 96, 批次损失: 2.4465
处理批次 2/30, 累计样本数: 144, 批次损失: 1.1988
处理批次 3/30, 累计样本数: 192, 批次损失: 1.0423
处理批次 4/30, 累计样本数: 240, 批次损失: 2.2528
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8904, AUPRC=0.8100
Epoch 00051: reducing learning rate of group 0 to 1.2500e-05.
当前学习率: 0.000013
Epoch 51/100 - 训练损失: 0.1548 - 验证AUROC: 0.8904 - 验证AUPRC: 0.8100
批次 0: 正样本 26, 负样本 22
批次 100: 正样本 21, 负样本 27
批次 200: 正样本 20, 负样本 28
本轮训练: 正样本 67 (46.53%), 负样本 77 (53.47%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 2.3559
处理批次 1/30, 累计样本数: 96, 批次损失: 3.0081
处理批次 2/30, 累计样本数: 144, 批次损失: 1.3602
处理批次 3/30, 累计样本数: 192, 批次损失: 0.9640
处理批次 4/30, 累计样本数: 240, 批次损失: 2.5670
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8907, AUPRC=0.8126
当前学习率: 0.000013
Epoch 52/100 - 训练损失: 0.1544 - 验证AUROC: 0.8907 - 验证AUPRC: 0.8126
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 25, 负样本 23
批次 200: 正样本 18, 负样本 30
本轮训练: 正样本 61 (42.36%), 负样本 83 (57.64%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.8039
处理批次 1/30, 累计样本数: 96, 批次损失: 2.5450
处理批次 2/30, 累计样本数: 144, 批次损失: 1.3257
处理批次 3/30, 累计样本数: 192, 批次损失: 0.9096
处理批次 4/30, 累计样本数: 240, 批次损失: 2.1479
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8901, AUPRC=0.8070
当前学习率: 0.000013
Epoch 53/100 - 训练损失: 0.1644 - 验证AUROC: 0.8901 - 验证AUPRC: 0.8070
批次 0: 正样本 22, 负样本 26
批次 100: 正样本 23, 负样本 25
批次 200: 正样本 26, 负样本 22
本轮训练: 正样本 71 (49.31%), 负样本 73 (50.69%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.4446
处理批次 1/30, 累计样本数: 96, 批次损失: 2.1954
处理批次 2/30, 累计样本数: 144, 批次损失: 1.2585
处理批次 3/30, 累计样本数: 192, 批次损失: 0.8706
处理批次 4/30, 累计样本数: 240, 批次损失: 2.3015
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8938, AUPRC=0.8137
当前学习率: 0.000013
Epoch 54/100 - 训练损失: 0.1561 - 验证AUROC: 0.8938 - 验证AUPRC: 0.8137
批次 0: 正样本 24, 负样本 24
批次 100: 正样本 30, 负样本 18
批次 200: 正样本 17, 负样本 31
本轮训练: 正样本 71 (49.31%), 负样本 73 (50.69%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.4251
处理批次 1/30, 累计样本数: 96, 批次损失: 2.0760
处理批次 2/30, 累计样本数: 144, 批次损失: 1.1994
处理批次 3/30, 累计样本数: 192, 批次损失: 0.9625
处理批次 4/30, 累计样本数: 240, 批次损失: 2.1098
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8932, AUPRC=0.8170
当前学习率: 0.000013
Epoch 55/100 - 训练损失: 0.1547 - 验证AUROC: 0.8932 - 验证AUPRC: 0.8170
批次 0: 正样本 24, 负样本 24
批次 100: 正样本 17, 负样本 31
批次 200: 正样本 21, 负样本 27
本轮训练: 正样本 62 (43.06%), 负样本 82 (56.94%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.6974
处理批次 1/30, 累计样本数: 96, 批次损失: 2.5520
处理批次 2/30, 累计样本数: 144, 批次损失: 1.1838
处理批次 3/30, 累计样本数: 192, 批次损失: 1.0577
处理批次 4/30, 累计样本数: 240, 批次损失: 2.1867
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8923, AUPRC=0.8167
Epoch 00056: reducing learning rate of group 0 to 6.2500e-06.
当前学习率: 0.000006
Epoch 56/100 - 训练损失: 0.1592 - 验证AUROC: 0.8923 - 验证AUPRC: 0.8167
批次 0: 正样本 23, 负样本 25
批次 100: 正样本 22, 负样本 26
批次 200: 正样本 28, 负样本 20
本轮训练: 正样本 73 (50.69%), 负样本 71 (49.31%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.8001
处理批次 1/30, 累计样本数: 96, 批次损失: 2.5121
处理批次 2/30, 累计样本数: 144, 批次损失: 1.2644
处理批次 3/30, 累计样本数: 192, 批次损失: 0.8837
处理批次 4/30, 累计样本数: 240, 批次损失: 2.2291
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8921, AUPRC=0.8159
当前学习率: 0.000006
Epoch 57/100 - 训练损失: 0.1493 - 验证AUROC: 0.8921 - 验证AUPRC: 0.8159
批次 0: 正样本 24, 负样本 24
批次 100: 正样本 26, 负样本 22
批次 200: 正样本 21, 负样本 27
本轮训练: 正样本 71 (49.31%), 负样本 73 (50.69%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.6805
处理批次 1/30, 累计样本数: 96, 批次损失: 2.5142
处理批次 2/30, 累计样本数: 144, 批次损失: 1.2427
处理批次 3/30, 累计样本数: 192, 批次损失: 1.0158
处理批次 4/30, 累计样本数: 240, 批次损失: 2.1980
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8929, AUPRC=0.8160
当前学习率: 0.000006
Epoch 58/100 - 训练损失: 0.1580 - 验证AUROC: 0.8929 - 验证AUPRC: 0.8160
批次 0: 正样本 29, 负样本 19
批次 100: 正样本 25, 负样本 23
批次 200: 正样本 29, 负样本 19
本轮训练: 正样本 83 (57.64%), 负样本 61 (42.36%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.5899
处理批次 1/30, 累计样本数: 96, 批次损失: 2.4966
处理批次 2/30, 累计样本数: 144, 批次损失: 1.2875
处理批次 3/30, 累计样本数: 192, 批次损失: 0.9642
处理批次 4/30, 累计样本数: 240, 批次损失: 2.2564
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8936, AUPRC=0.8189
当前学习率: 0.000006
Epoch 59/100 - 训练损失: 0.1429 - 验证AUROC: 0.8936 - 验证AUPRC: 0.8189
批次 0: 正样本 21, 负样本 27
批次 100: 正样本 25, 负样本 23
批次 200: 正样本 23, 负样本 25
本轮训练: 正样本 69 (47.92%), 负样本 75 (52.08%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.7155
处理批次 1/30, 累计样本数: 96, 批次损失: 2.5013
处理批次 2/30, 累计样本数: 144, 批次损失: 1.2075
处理批次 3/30, 累计样本数: 192, 批次损失: 1.0327
处理批次 4/30, 累计样本数: 240, 批次损失: 2.1748
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8925, AUPRC=0.8157
当前学习率: 0.000006
Epoch 60/100 - 训练损失: 0.1416 - 验证AUROC: 0.8925 - 验证AUPRC: 0.8157
批次 0: 正样本 24, 负样本 24
批次 100: 正样本 27, 负样本 21
批次 200: 正样本 30, 负样本 18
本轮训练: 正样本 81 (56.25%), 负样本 63 (43.75%)
验证数据集大小: 30 批次
开始进行val评估...
处理批次 0/30, 累计样本数: 48, 批次损失: 1.9776
处理批次 1/30, 累计样本数: 96, 批次损失: 2.5712
处理批次 2/30, 累计样本数: 144, 批次损失: 1.3486
处理批次 3/30, 累计样本数: 192, 批次损失: 1.0297
处理批次 4/30, 累计样本数: 240, 批次损失: 2.5978
测试完成: 处理了 30/30 批次, 1399 个样本
错误批次数: 0
预测标签统计: 正样本数=451, 负样本数=948
成功计算评估指标: AUROC=0.8939, AUPRC=0.8159
Epoch 00061: reducing learning rate of group 0 to 3.1250e-06.
当前学习率: 0.000003
早停触发！连续15轮验证集性能未提升
测试数据集大小: 22 批次
成功加载最佳模型状态（来自Epoch 46）
开始进行test评估...
处理批次 0/22, 累计样本数: 48, 批次损失: 1.1163
处理批次 1/22, 累计样本数: 96, 批次损失: 1.5964
处理批次 2/22, 累计样本数: 144, 批次损失: 1.2083
处理批次 3/22, 累计样本数: 192, 批次损失: 1.3212
处理批次 4/22, 累计样本数: 240, 批次损失: 2.4613
测试完成: 处理了 22/22 批次, 1039 个样本
错误批次数: 0
预测标签统计: 正样本数=336, 负样本数=703
成功计算评估指标: AUROC=0.8919, AUPRC=0.8067
最佳阈值: 0.0486, 对应的F1分数: 0.8240
混淆矩阵:
[[543 160]
 [ 47 289]]
详细测试结果: AUROC=0.8919, AUPRC=0.8067, F1=0.8240, 敏感度=0.7724, 特异度=0.8601, 准确率=0.8008, 精确度=0.6437
训练完成！最佳模型来自Epoch 46 - AUROC: 0.8919 - F1: 0.8240
结果已保存到: result/DrugBAN3D_optimal_augment_20250608_105556
