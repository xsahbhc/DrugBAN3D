
================================================================================
DrugBAN 数据增强与标签生成流程
================================================================================
开始时间: 2025-06-07 00:31:43
原始缓存目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/cached_graphs
增强缓存目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250607_003142
原始标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/labels.csv
训练标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/train_stratified.csv
验证标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/val_stratified.csv
测试标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv
增强标签目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250607_003142
是否增强测试集: 否
================================================================================

步骤1：执行数据增强...
读取标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/labels.csv
总样本数: 10436, 正样本数: 3369 (32.28%), 负样本数: 7067 (67.72%)
使用的增强类型: ['gentle_rotate', 'thermal_vibration', 'bond_flexibility', 'smart_combined', 'minimal_edge_dropout']
正样本增强数量: 每个样本3次
负样本增强数量: 每个样本1次

数据增强完成! 耗时: 324.93秒
成功: 10398/10436 (99.64%)
失败记录已保存到 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250607_003142/augment_failures.txt
生成的文件总数: 27516
  原始文件数: 10398
  增强文件数: 17118
增强后样本总数: 27610
  正样本数: 13476 (48.81%)
  负样本数: 14134 (51.19%)

================================================================================
步骤2：为增强数据生成标签文件...
读取原始标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/labels.csv
原始标签文件包含 10436 条记录
使用预划分的测试集标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv
测试集包含 1044 条记录
测试集正样本率: 32.28%
正在从缓存目录 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250607_003142 中读取增强数据...
找到 27516 个缓存文件
从缓存文件中提取标签信息...
增强标签已保存至 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250607_003142/augmented_labels.csv，包含 27516 条记录
正样本: 13440 (48.84%), 负样本: 14076 (51.16%)
数据集划分: 训练集 7955 分子, 验证集 1404 分子, 测试集 1044 分子
验证集当前正样本率: 50.00%, 目标正样本率: 32.28%
调整验证集: 从1872个正样本中抽样892个
调整后验证集正样本率: 32.27%
训练标签已保存至 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250607_003142/train_augmented.csv，包含 21022 条记录
验证标签已保存至 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250607_003142/valid_augmented.csv，包含 2764 条记录
测试标签已保存至 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250607_003142/test_augmented.csv，包含 1044 条记录
训练集: 总样本 21022, 正样本率 48.63%
验证集: 总样本 2764, 正样本率 32.27%
测试集: 总样本 1044, 正样本率 32.28%

================================================================================
数据增强与标签生成完成!
增强后的缓存文件保存在: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250607_003142
增强后的标签文件保存在: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250607_003142
结束时间: 2025-06-07 00:37:32
================================================================================

使用命令行指定的输出目录: result/DrugBAN3D_improved_augment_20250607_003142
已保存当前配置到 result/DrugBAN3D_improved_augment_20250607_003142/config/config_used.yaml
配置文件: result/DrugBAN3D_improved_augment_20250607_003142/config/DrugBAN3D_augmented_20250607_003142.yaml
输出目录: result/DrugBAN3D_improved_augment_20250607_003142
运行设备: cuda
数据加载器使用 16 个工作线程
使用分层采样的预划分数据集
数据集: 训练集 21022 样本, 验证集 2764 样本, 测试集 1044 样本
正样本比例: 训练集 48.63%, 验证集 32.27%, 测试集 32.28%
使用增强数据集进行训练...
加载标签文件: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250607_003142/train_augmented.csv, 包含 21022 条记录
找到 21022/21022 个对应的缓存文件
数据集初始化完成，总样本数: 21022
训练/验证 数据集初始化完成: 21022 个样本
创建数据加载器成功: 预期 329 批次，批次大小 64
加载标签文件: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250607_003142/valid_augmented.csv, 包含 2764 条记录
找到 2764/2764 个对应的缓存文件
数据集初始化完成，总样本数: 2764
训练/验证 数据集初始化完成: 2764 个样本
创建数据加载器成功: 预期 44 批次，批次大小 64
测试模式: 使用原始测试数据
测试标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv
缓存目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250607_003142
测试标签文件包含 1044 条记录
测试集标签分布: 正样本 337 (32.28%), 负样本 707 (67.72%)
读取测试标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv, 包含 1044 条记录
成功创建测试标签映射，包含 2088 个条目
测试模式：从标签文件获取 2088 个复合物ID
测试模式：只处理标签文件中的 2088 个样本
在缓存目录中找到 2078/2088 个测试样本缓存文件
数据集初始化完成，总样本数: 2078
测试 数据集初始化完成: 2078 个样本
创建数据加载器成功: 预期 33 批次，批次大小 64

==================================================
DrugBAN3D初始化 - 偏差校正模块: 启用
Dropout率: 0.5
GNN层数: 4
==================================================

优化器: Adam, 学习率: 0.0002, L2正则化强度: 0.0003
启用标签平滑，参数值: 0.05
启用类别加权，正样本权重: 1.050
启用梯度裁剪，阈值：1.0
使用state_dict保存模型，避免完整对象复制
使用plateau学习率调度器
运行设备: cuda
启用标签平滑，参数值: 0.05
启用类别加权，正样本权重: 1.0499999523162842
使用ReduceLROnPlateau学习率调度器，监控验证集AUROC
开始训练...
批次 0: 正样本 37, 负样本 27
批次 100: 正样本 28, 负样本 36
批次 200: 正样本 31, 负样本 33
批次 300: 正样本 39, 负样本 25
本轮训练: 正样本 135 (52.73%), 负样本 121 (47.27%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 0.6369
处理批次 1/44, 累计样本数: 128, 批次损失: 0.6989
处理批次 2/44, 累计样本数: 192, 批次损失: 2.1161
处理批次 3/44, 累计样本数: 256, 批次损失: 2.1869
处理批次 4/44, 累计样本数: 320, 批次损失: 2.2415
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.6570, AUPRC=0.4626
当前学习率: 0.000200
保存最佳模型（轮次 1）到 result/DrugBAN3D_improved_augment_20250607_003142/best_model.pth
Epoch 1/100 - 训练损失: 2.5988 - 验证AUROC: 0.6570 - 验证AUPRC: 0.4626
批次 0: 正样本 30, 负样本 34
批次 100: 正样本 31, 负样本 33
批次 200: 正样本 29, 负样本 35
批次 300: 正样本 23, 负样本 41
本轮训练: 正样本 113 (44.14%), 负样本 143 (55.86%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 1.1147
处理批次 1/44, 累计样本数: 128, 批次损失: 0.9411
处理批次 2/44, 累计样本数: 192, 批次损失: 1.0428
处理批次 3/44, 累计样本数: 256, 批次损失: 0.7385
处理批次 4/44, 累计样本数: 320, 批次损失: 2.7616
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.6961, AUPRC=0.4927
当前学习率: 0.000200
保存最佳模型（轮次 2）到 result/DrugBAN3D_improved_augment_20250607_003142/best_model.pth
Epoch 2/100 - 训练损失: 1.7105 - 验证AUROC: 0.6961 - 验证AUPRC: 0.4927
批次 0: 正样本 29, 负样本 35
批次 100: 正样本 29, 负样本 35
批次 200: 正样本 36, 负样本 28
批次 300: 正样本 27, 负样本 37
本轮训练: 正样本 121 (47.27%), 负样本 135 (52.73%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 0.6143
处理批次 1/44, 累计样本数: 128, 批次损失: 0.7783
处理批次 2/44, 累计样本数: 192, 批次损失: 0.6935
处理批次 3/44, 累计样本数: 256, 批次损失: 0.5518
处理批次 4/44, 累计样本数: 320, 批次损失: 3.8292
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.7922, AUPRC=0.5985
当前学习率: 0.000200
保存最佳模型（轮次 3）到 result/DrugBAN3D_improved_augment_20250607_003142/best_model.pth
Epoch 3/100 - 训练损失: 1.4546 - 验证AUROC: 0.7922 - 验证AUPRC: 0.5985
批次 0: 正样本 28, 负样本 36
批次 100: 正样本 28, 负样本 36
批次 200: 正样本 34, 负样本 30
批次 300: 正样本 33, 负样本 31
本轮训练: 正样本 123 (48.05%), 负样本 133 (51.95%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 0.6096
处理批次 1/44, 累计样本数: 128, 批次损失: 0.7527
处理批次 2/44, 累计样本数: 192, 批次损失: 2.0556
处理批次 3/44, 累计样本数: 256, 批次损失: 0.6104
处理批次 4/44, 累计样本数: 320, 批次损失: 2.2860
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.8222, AUPRC=0.6421
当前学习率: 0.000200
保存最佳模型（轮次 4）到 result/DrugBAN3D_improved_augment_20250607_003142/best_model.pth
Epoch 4/100 - 训练损失: 1.2787 - 验证AUROC: 0.8222 - 验证AUPRC: 0.6421
批次 0: 正样本 29, 负样本 35
批次 100: 正样本 29, 负样本 35
批次 200: 正样本 29, 负样本 35
批次 300: 正样本 32, 负样本 32
本轮训练: 正样本 119 (46.48%), 负样本 137 (53.52%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 0.6939
处理批次 1/44, 累计样本数: 128, 批次损失: 0.5858
处理批次 2/44, 累计样本数: 192, 批次损失: 2.1384
处理批次 3/44, 累计样本数: 256, 批次损失: 0.4965
处理批次 4/44, 累计样本数: 320, 批次损失: 2.2561
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.8126, AUPRC=0.6173
当前学习率: 0.000200
Epoch 5/100 - 训练损失: 1.3140 - 验证AUROC: 0.8126 - 验证AUPRC: 0.6173
批次 0: 正样本 24, 负样本 40
批次 100: 正样本 35, 负样本 29
批次 200: 正样本 34, 负样本 30
批次 300: 正样本 34, 负样本 30
本轮训练: 正样本 127 (49.61%), 负样本 129 (50.39%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 0.7093
处理批次 1/44, 累计样本数: 128, 批次损失: 0.9184
处理批次 2/44, 累计样本数: 192, 批次损失: 2.2312
处理批次 3/44, 累计样本数: 256, 批次损失: 0.5947
处理批次 4/44, 累计样本数: 320, 批次损失: 2.2721
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.8300, AUPRC=0.6719
当前学习率: 0.000200
保存最佳模型（轮次 6）到 result/DrugBAN3D_improved_augment_20250607_003142/best_model.pth
Epoch 6/100 - 训练损失: 1.1669 - 验证AUROC: 0.8300 - 验证AUPRC: 0.6719
批次 0: 正样本 32, 负样本 32
批次 100: 正样本 28, 负样本 36
批次 200: 正样本 28, 负样本 36
批次 300: 正样本 31, 负样本 33
本轮训练: 正样本 119 (46.48%), 负样本 137 (53.52%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 0.5957
处理批次 1/44, 累计样本数: 128, 批次损失: 0.7846
处理批次 2/44, 累计样本数: 192, 批次损失: 2.3474
处理批次 3/44, 累计样本数: 256, 批次损失: 0.6064
处理批次 4/44, 累计样本数: 320, 批次损失: 2.2668
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.8192, AUPRC=0.6587
当前学习率: 0.000200
Epoch 7/100 - 训练损失: 1.0464 - 验证AUROC: 0.8192 - 验证AUPRC: 0.6587
批次 0: 正样本 33, 负样本 31
批次 100: 正样本 33, 负样本 31
批次 200: 正样本 26, 负样本 38
批次 300: 正样本 31, 负样本 33
本轮训练: 正样本 123 (48.05%), 负样本 133 (51.95%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 0.6956
处理批次 1/44, 累计样本数: 128, 批次损失: 0.6175
处理批次 2/44, 累计样本数: 192, 批次损失: 2.5127
处理批次 3/44, 累计样本数: 256, 批次损失: 0.6617
处理批次 4/44, 累计样本数: 320, 批次损失: 3.9437
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.8219, AUPRC=0.6389
当前学习率: 0.000200
Epoch 8/100 - 训练损失: 0.9155 - 验证AUROC: 0.8219 - 验证AUPRC: 0.6389
批次 0: 正样本 26, 负样本 38
批次 100: 正样本 30, 负样本 34
批次 200: 正样本 31, 负样本 33
批次 300: 正样本 32, 负样本 32
本轮训练: 正样本 119 (46.48%), 负样本 137 (53.52%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 0.6074
处理批次 1/44, 累计样本数: 128, 批次损失: 0.8224
处理批次 2/44, 累计样本数: 192, 批次损失: 2.4440
处理批次 3/44, 累计样本数: 256, 批次损失: 0.6719
处理批次 4/44, 累计样本数: 320, 批次损失: 2.4702
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.8450, AUPRC=0.7003
当前学习率: 0.000200
保存最佳模型（轮次 9）到 result/DrugBAN3D_improved_augment_20250607_003142/best_model.pth
Epoch 9/100 - 训练损失: 0.8290 - 验证AUROC: 0.8450 - 验证AUPRC: 0.7003
批次 0: 正样本 28, 负样本 36
批次 100: 正样本 38, 负样本 26
批次 200: 正样本 28, 负样本 36
批次 300: 正样本 29, 负样本 35
本轮训练: 正样本 123 (48.05%), 负样本 133 (51.95%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 0.5877
处理批次 1/44, 累计样本数: 128, 批次损失: 0.7533
处理批次 2/44, 累计样本数: 192, 批次损失: 2.3132
处理批次 3/44, 累计样本数: 256, 批次损失: 0.7895
处理批次 4/44, 累计样本数: 320, 批次损失: 1.0878
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.8459, AUPRC=0.6997
当前学习率: 0.000200
保存最佳模型（轮次 10）到 result/DrugBAN3D_improved_augment_20250607_003142/best_model.pth
Epoch 10/100 - 训练损失: 0.7457 - 验证AUROC: 0.8459 - 验证AUPRC: 0.6997
批次 0: 正样本 29, 负样本 35
批次 100: 正样本 27, 负样本 37
批次 200: 正样本 27, 负样本 37
批次 300: 正样本 30, 负样本 34
本轮训练: 正样本 113 (44.14%), 负样本 143 (55.86%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 0.6599
处理批次 1/44, 累计样本数: 128, 批次损失: 0.8239
处理批次 2/44, 累计样本数: 192, 批次损失: 2.4841
处理批次 3/44, 累计样本数: 256, 批次损失: 0.9199
处理批次 4/44, 累计样本数: 320, 批次损失: 2.5201
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.8602, AUPRC=0.7297
当前学习率: 0.000200
保存最佳模型（轮次 11）到 result/DrugBAN3D_improved_augment_20250607_003142/best_model.pth
Epoch 11/100 - 训练损失: 0.6169 - 验证AUROC: 0.8602 - 验证AUPRC: 0.7297
批次 0: 正样本 31, 负样本 33
批次 100: 正样本 40, 负样本 24
批次 200: 正样本 38, 负样本 26
批次 300: 正样本 33, 负样本 31
本轮训练: 正样本 142 (55.47%), 负样本 114 (44.53%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 0.7883
处理批次 1/44, 累计样本数: 128, 批次损失: 0.8034
处理批次 2/44, 累计样本数: 192, 批次损失: 2.4098
处理批次 3/44, 累计样本数: 256, 批次损失: 0.8068
处理批次 4/44, 累计样本数: 320, 批次损失: 2.4968
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.8648, AUPRC=0.7345
当前学习率: 0.000200
保存最佳模型（轮次 12）到 result/DrugBAN3D_improved_augment_20250607_003142/best_model.pth
Epoch 12/100 - 训练损失: 0.5784 - 验证AUROC: 0.8648 - 验证AUPRC: 0.7345
批次 0: 正样本 31, 负样本 33
批次 100: 正样本 30, 负样本 34
批次 200: 正样本 32, 负样本 32
批次 300: 正样本 33, 负样本 31
本轮训练: 正样本 126 (49.22%), 负样本 130 (50.78%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 0.6697
处理批次 1/44, 累计样本数: 128, 批次损失: 0.9942
处理批次 2/44, 累计样本数: 192, 批次损失: 2.4872
处理批次 3/44, 累计样本数: 256, 批次损失: 0.6872
处理批次 4/44, 累计样本数: 320, 批次损失: 0.9895
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.8801, AUPRC=0.7837
当前学习率: 0.000200
保存最佳模型（轮次 13）到 result/DrugBAN3D_improved_augment_20250607_003142/best_model.pth
Epoch 13/100 - 训练损失: 0.4719 - 验证AUROC: 0.8801 - 验证AUPRC: 0.7837
批次 0: 正样本 31, 负样本 33
批次 100: 正样本 28, 负样本 36
批次 200: 正样本 34, 负样本 30
批次 300: 正样本 30, 负样本 34
本轮训练: 正样本 123 (48.05%), 负样本 133 (51.95%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 0.7708
处理批次 1/44, 累计样本数: 128, 批次损失: 1.2776
处理批次 2/44, 累计样本数: 192, 批次损失: 2.8502
处理批次 3/44, 累计样本数: 256, 批次损失: 0.8479
处理批次 4/44, 累计样本数: 320, 批次损失: 1.2312
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.8800, AUPRC=0.7778
当前学习率: 0.000200
Epoch 14/100 - 训练损失: 0.4607 - 验证AUROC: 0.8800 - 验证AUPRC: 0.7778
批次 0: 正样本 27, 负样本 37
批次 100: 正样本 33, 负样本 31
批次 200: 正样本 36, 负样本 28
批次 300: 正样本 36, 负样本 28
本轮训练: 正样本 132 (51.56%), 负样本 124 (48.44%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 0.7967
处理批次 1/44, 累计样本数: 128, 批次损失: 1.2799
处理批次 2/44, 累计样本数: 192, 批次损失: 2.9545
处理批次 3/44, 累计样本数: 256, 批次损失: 0.9909
处理批次 4/44, 累计样本数: 320, 批次损失: 1.2929
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.8708, AUPRC=0.7573
当前学习率: 0.000200
Epoch 15/100 - 训练损失: 0.3952 - 验证AUROC: 0.8708 - 验证AUPRC: 0.7573
批次 0: 正样本 31, 负样本 33
批次 100: 正样本 34, 负样本 30
批次 200: 正样本 34, 负样本 30
批次 300: 正样本 35, 负样本 29
本轮训练: 正样本 134 (52.34%), 负样本 122 (47.66%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 0.7483
处理批次 1/44, 累计样本数: 128, 批次损失: 1.4996
处理批次 2/44, 累计样本数: 192, 批次损失: 3.1797
处理批次 3/44, 累计样本数: 256, 批次损失: 0.7858
处理批次 4/44, 累计样本数: 320, 批次损失: 0.8714
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.8867, AUPRC=0.7839
当前学习率: 0.000200
保存最佳模型（轮次 16）到 result/DrugBAN3D_improved_augment_20250607_003142/best_model.pth
Epoch 16/100 - 训练损失: 0.3661 - 验证AUROC: 0.8867 - 验证AUPRC: 0.7839
批次 0: 正样本 33, 负样本 31
批次 100: 正样本 32, 负样本 32
批次 200: 正样本 33, 负样本 31
批次 300: 正样本 36, 负样本 28
本轮训练: 正样本 134 (52.34%), 负样本 122 (47.66%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 1.0654
处理批次 1/44, 累计样本数: 128, 批次损失: 2.3588
处理批次 2/44, 累计样本数: 192, 批次损失: 3.7041
处理批次 3/44, 累计样本数: 256, 批次损失: 2.7615
处理批次 4/44, 累计样本数: 320, 批次损失: 1.4017
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.8796, AUPRC=0.7689
当前学习率: 0.000200
Epoch 17/100 - 训练损失: 0.3560 - 验证AUROC: 0.8796 - 验证AUPRC: 0.7689
批次 0: 正样本 36, 负样本 28
批次 100: 正样本 28, 负样本 36
批次 200: 正样本 28, 负样本 36
批次 300: 正样本 31, 负样本 33
本轮训练: 正样本 123 (48.05%), 负样本 133 (51.95%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 0.8052
处理批次 1/44, 累计样本数: 128, 批次损失: 1.4967
处理批次 2/44, 累计样本数: 192, 批次损失: 2.9837
处理批次 3/44, 累计样本数: 256, 批次损失: 1.1976
处理批次 4/44, 累计样本数: 320, 批次损失: 2.8400
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.8872, AUPRC=0.7898
当前学习率: 0.000200
保存最佳模型（轮次 18）到 result/DrugBAN3D_improved_augment_20250607_003142/best_model.pth
Epoch 18/100 - 训练损失: 0.3047 - 验证AUROC: 0.8872 - 验证AUPRC: 0.7898
批次 0: 正样本 32, 负样本 32
批次 100: 正样本 30, 负样本 34
批次 200: 正样本 31, 负样本 33
批次 300: 正样本 30, 负样本 34
本轮训练: 正样本 123 (48.05%), 负样本 133 (51.95%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 0.8777
处理批次 1/44, 累计样本数: 128, 批次损失: 1.0079
处理批次 2/44, 累计样本数: 192, 批次损失: 2.7492
处理批次 3/44, 累计样本数: 256, 批次损失: 0.8328
处理批次 4/44, 累计样本数: 320, 批次损失: 2.5664
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.8940, AUPRC=0.7987
当前学习率: 0.000200
保存最佳模型（轮次 19）到 result/DrugBAN3D_improved_augment_20250607_003142/best_model.pth
Epoch 19/100 - 训练损失: 0.2935 - 验证AUROC: 0.8940 - 验证AUPRC: 0.7987
批次 0: 正样本 29, 负样本 35
批次 100: 正样本 29, 负样本 35
批次 200: 正样本 38, 负样本 26
批次 300: 正样本 35, 负样本 29
本轮训练: 正样本 131 (51.17%), 负样本 125 (48.83%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 0.9043
处理批次 1/44, 累计样本数: 128, 批次损失: 1.9661
处理批次 2/44, 累计样本数: 192, 批次损失: 3.5845
处理批次 3/44, 累计样本数: 256, 批次损失: 1.0618
处理批次 4/44, 累计样本数: 320, 批次损失: 1.2094
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.9029, AUPRC=0.8204
当前学习率: 0.000200
保存最佳模型（轮次 20）到 result/DrugBAN3D_improved_augment_20250607_003142/best_model.pth
Epoch 20/100 - 训练损失: 0.2828 - 验证AUROC: 0.9029 - 验证AUPRC: 0.8204
批次 0: 正样本 30, 负样本 34
批次 100: 正样本 26, 负样本 38
批次 200: 正样本 31, 负样本 33
批次 300: 正样本 35, 负样本 29
本轮训练: 正样本 122 (47.66%), 负样本 134 (52.34%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 1.0929
处理批次 1/44, 累计样本数: 128, 批次损失: 1.8056
处理批次 2/44, 累计样本数: 192, 批次损失: 3.5600
处理批次 3/44, 累计样本数: 256, 批次损失: 1.1962
处理批次 4/44, 累计样本数: 320, 批次损失: 2.4848
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.8812, AUPRC=0.7725
当前学习率: 0.000200
Epoch 21/100 - 训练损失: 0.2488 - 验证AUROC: 0.8812 - 验证AUPRC: 0.7725
批次 0: 正样本 34, 负样本 30
批次 100: 正样本 36, 负样本 28
批次 200: 正样本 29, 负样本 35
批次 300: 正样本 35, 负样本 29
本轮训练: 正样本 134 (52.34%), 负样本 122 (47.66%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 0.8906
处理批次 1/44, 累计样本数: 128, 批次损失: 1.6622
处理批次 2/44, 累计样本数: 192, 批次损失: 3.5009
处理批次 3/44, 累计样本数: 256, 批次损失: 1.5689
处理批次 4/44, 累计样本数: 320, 批次损失: 1.7516
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.8956, AUPRC=0.8115
当前学习率: 0.000200
Epoch 22/100 - 训练损失: 0.2498 - 验证AUROC: 0.8956 - 验证AUPRC: 0.8115
批次 0: 正样本 34, 负样本 30
批次 100: 正样本 34, 负样本 30
批次 200: 正样本 29, 负样本 35
批次 300: 正样本 28, 负样本 36
本轮训练: 正样本 125 (48.83%), 负样本 131 (51.17%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 0.8691
处理批次 1/44, 累计样本数: 128, 批次损失: 1.4161
处理批次 2/44, 累计样本数: 192, 批次损失: 3.1722
处理批次 3/44, 累计样本数: 256, 批次损失: 2.7265
处理批次 4/44, 累计样本数: 320, 批次损失: 3.1571
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.8962, AUPRC=0.7898
当前学习率: 0.000200
Epoch 23/100 - 训练损失: 0.2348 - 验证AUROC: 0.8962 - 验证AUPRC: 0.7898
批次 0: 正样本 25, 负样本 39
批次 100: 正样本 27, 负样本 37
批次 200: 正样本 33, 负样本 31
批次 300: 正样本 31, 负样本 33
本轮训练: 正样本 116 (45.31%), 负样本 140 (54.69%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 0.9698
处理批次 1/44, 累计样本数: 128, 批次损失: 1.4524
处理批次 2/44, 累计样本数: 192, 批次损失: 1.8916
处理批次 3/44, 累计样本数: 256, 批次损失: 1.1713
处理批次 4/44, 累计样本数: 320, 批次损失: 1.3494
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.8967, AUPRC=0.7982
当前学习率: 0.000200
Epoch 24/100 - 训练损失: 0.2242 - 验证AUROC: 0.8967 - 验证AUPRC: 0.7982
批次 0: 正样本 29, 负样本 35
批次 100: 正样本 27, 负样本 37
批次 200: 正样本 28, 负样本 36
批次 300: 正样本 39, 负样本 25
本轮训练: 正样本 123 (48.05%), 负样本 133 (51.95%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 0.9311
处理批次 1/44, 累计样本数: 128, 批次损失: 2.4705
处理批次 2/44, 累计样本数: 192, 批次损失: 5.7741
处理批次 3/44, 累计样本数: 256, 批次损失: 1.4066
处理批次 4/44, 累计样本数: 320, 批次损失: 3.2292
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.8860, AUPRC=0.7743
Epoch 00025: reducing learning rate of group 0 to 1.0000e-04.
当前学习率: 0.000100
Epoch 25/100 - 训练损失: 0.2337 - 验证AUROC: 0.8860 - 验证AUPRC: 0.7743
批次 0: 正样本 36, 负样本 28
批次 100: 正样本 24, 负样本 40
批次 200: 正样本 34, 负样本 30
批次 300: 正样本 30, 负样本 34
本轮训练: 正样本 124 (48.44%), 负样本 132 (51.56%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 1.1864
处理批次 1/44, 累计样本数: 128, 批次损失: 2.0167
处理批次 2/44, 累计样本数: 192, 批次损失: 3.7018
处理批次 3/44, 累计样本数: 256, 批次损失: 1.3082
处理批次 4/44, 累计样本数: 320, 批次损失: 3.0998
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.9002, AUPRC=0.8110
当前学习率: 0.000100
Epoch 26/100 - 训练损失: 0.1746 - 验证AUROC: 0.9002 - 验证AUPRC: 0.8110
批次 0: 正样本 28, 负样本 36
批次 100: 正样本 38, 负样本 26
批次 200: 正样本 31, 负样本 33
批次 300: 正样本 30, 负样本 34
本轮训练: 正样本 127 (49.61%), 负样本 129 (50.39%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 1.1368
处理批次 1/44, 累计样本数: 128, 批次损失: 2.0249
处理批次 2/44, 累计样本数: 192, 批次损失: 3.6166
处理批次 3/44, 累计样本数: 256, 批次损失: 1.3343
处理批次 4/44, 累计样本数: 320, 批次损失: 3.1442
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.8952, AUPRC=0.7943
当前学习率: 0.000100
Epoch 27/100 - 训练损失: 0.1538 - 验证AUROC: 0.8952 - 验证AUPRC: 0.7943
批次 0: 正样本 27, 负样本 37
批次 100: 正样本 33, 负样本 31
批次 200: 正样本 26, 负样本 38
批次 300: 正样本 38, 负样本 26
本轮训练: 正样本 124 (48.44%), 负样本 132 (51.56%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 1.4001
处理批次 1/44, 累计样本数: 128, 批次损失: 3.4182
处理批次 2/44, 累计样本数: 192, 批次损失: 3.8645
处理批次 3/44, 累计样本数: 256, 批次损失: 1.3057
处理批次 4/44, 累计样本数: 320, 批次损失: 3.2110
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.8887, AUPRC=0.7847
当前学习率: 0.000100
Epoch 28/100 - 训练损失: 0.1518 - 验证AUROC: 0.8887 - 验证AUPRC: 0.7847
批次 0: 正样本 32, 负样本 32
批次 100: 正样本 35, 负样本 29
批次 200: 正样本 29, 负样本 35
批次 300: 正样本 30, 负样本 34
本轮训练: 正样本 126 (49.22%), 负样本 130 (50.78%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 1.4277
处理批次 1/44, 累计样本数: 128, 批次损失: 1.9171
处理批次 2/44, 累计样本数: 192, 批次损失: 4.2211
处理批次 3/44, 累计样本数: 256, 批次损失: 1.7064
处理批次 4/44, 累计样本数: 320, 批次损失: 3.6315
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.8985, AUPRC=0.8044
当前学习率: 0.000100
Epoch 29/100 - 训练损失: 0.1421 - 验证AUROC: 0.8985 - 验证AUPRC: 0.8044
批次 0: 正样本 34, 负样本 30
批次 100: 正样本 30, 负样本 34
批次 200: 正样本 30, 负样本 34
批次 300: 正样本 39, 负样本 25
本轮训练: 正样本 133 (51.95%), 负样本 123 (48.05%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 1.0740
处理批次 1/44, 累计样本数: 128, 批次损失: 1.4314
处理批次 2/44, 累计样本数: 192, 批次损失: 3.2729
处理批次 3/44, 累计样本数: 256, 批次损失: 1.1769
处理批次 4/44, 累计样本数: 320, 批次损失: 3.3191
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.8996, AUPRC=0.8123
Epoch 00030: reducing learning rate of group 0 to 5.0000e-05.
当前学习率: 0.000050
Epoch 30/100 - 训练损失: 0.1416 - 验证AUROC: 0.8996 - 验证AUPRC: 0.8123
批次 0: 正样本 32, 负样本 32
批次 100: 正样本 34, 负样本 30
批次 200: 正样本 25, 负样本 39
批次 300: 正样本 29, 负样本 35
本轮训练: 正样本 120 (46.88%), 负样本 136 (53.12%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 1.2683
处理批次 1/44, 累计样本数: 128, 批次损失: 1.8552
处理批次 2/44, 累计样本数: 192, 批次损失: 3.6535
处理批次 3/44, 累计样本数: 256, 批次损失: 1.6176
处理批次 4/44, 累计样本数: 320, 批次损失: 4.7428
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.9065, AUPRC=0.8161
当前学习率: 0.000050
保存最佳模型（轮次 31）到 result/DrugBAN3D_improved_augment_20250607_003142/best_model.pth
Epoch 31/100 - 训练损失: 0.1262 - 验证AUROC: 0.9065 - 验证AUPRC: 0.8161
批次 0: 正样本 32, 负样本 32
批次 100: 正样本 40, 负样本 24
批次 200: 正样本 33, 负样本 31
批次 300: 正样本 25, 负样本 39
本轮训练: 正样本 130 (50.78%), 负样本 126 (49.22%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 1.4910
处理批次 1/44, 累计样本数: 128, 批次损失: 1.9616
处理批次 2/44, 累计样本数: 192, 批次损失: 3.9482
处理批次 3/44, 累计样本数: 256, 批次损失: 1.7786
处理批次 4/44, 累计样本数: 320, 批次损失: 3.4681
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.9025, AUPRC=0.8110
当前学习率: 0.000050
Epoch 32/100 - 训练损失: 0.1125 - 验证AUROC: 0.9025 - 验证AUPRC: 0.8110
批次 0: 正样本 36, 负样本 28
批次 100: 正样本 31, 负样本 33
批次 200: 正样本 34, 负样本 30
批次 300: 正样本 25, 负样本 39
本轮训练: 正样本 126 (49.22%), 负样本 130 (50.78%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 1.2999
处理批次 1/44, 累计样本数: 128, 批次损失: 1.6422
处理批次 2/44, 累计样本数: 192, 批次损失: 3.6062
处理批次 3/44, 累计样本数: 256, 批次损失: 1.7788
处理批次 4/44, 累计样本数: 320, 批次损失: 2.0040
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.9044, AUPRC=0.8173
当前学习率: 0.000050
Epoch 33/100 - 训练损失: 0.1098 - 验证AUROC: 0.9044 - 验证AUPRC: 0.8173
批次 0: 正样本 36, 负样本 28
批次 100: 正样本 31, 负样本 33
批次 200: 正样本 27, 负样本 37
批次 300: 正样本 29, 负样本 35
本轮训练: 正样本 123 (48.05%), 负样本 133 (51.95%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 1.5918
处理批次 1/44, 累计样本数: 128, 批次损失: 2.0482
处理批次 2/44, 累计样本数: 192, 批次损失: 3.5896
处理批次 3/44, 累计样本数: 256, 批次损失: 2.1647
处理批次 4/44, 累计样本数: 320, 批次损失: 2.2850
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.8980, AUPRC=0.8017
当前学习率: 0.000050
Epoch 34/100 - 训练损失: 0.1027 - 验证AUROC: 0.8980 - 验证AUPRC: 0.8017
批次 0: 正样本 30, 负样本 34
批次 100: 正样本 25, 负样本 39
批次 200: 正样本 24, 负样本 40
批次 300: 正样本 35, 负样本 29
本轮训练: 正样本 114 (44.53%), 负样本 142 (55.47%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 1.5674
处理批次 1/44, 累计样本数: 128, 批次损失: 2.2018
处理批次 2/44, 累计样本数: 192, 批次损失: 3.8732
处理批次 3/44, 累计样本数: 256, 批次损失: 1.8671
处理批次 4/44, 累计样本数: 320, 批次损失: 4.7529
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.9011, AUPRC=0.8053
当前学习率: 0.000050
Epoch 35/100 - 训练损失: 0.0977 - 验证AUROC: 0.9011 - 验证AUPRC: 0.8053
批次 0: 正样本 36, 负样本 28
批次 100: 正样本 28, 负样本 36
批次 200: 正样本 34, 负样本 30
批次 300: 正样本 31, 负样本 33
本轮训练: 正样本 129 (50.39%), 负样本 127 (49.61%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 1.4971
处理批次 1/44, 累计样本数: 128, 批次损失: 1.7829
处理批次 2/44, 累计样本数: 192, 批次损失: 3.6797
处理批次 3/44, 累计样本数: 256, 批次损失: 3.2417
处理批次 4/44, 累计样本数: 320, 批次损失: 4.7439
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.9018, AUPRC=0.8058
Epoch 00036: reducing learning rate of group 0 to 2.5000e-05.
当前学习率: 0.000025
Epoch 36/100 - 训练损失: 0.1033 - 验证AUROC: 0.9018 - 验证AUPRC: 0.8058
批次 0: 正样本 36, 负样本 28
批次 100: 正样本 29, 负样本 35
批次 200: 正样本 27, 负样本 37
批次 300: 正样本 28, 负样本 36
本轮训练: 正样本 120 (46.88%), 负样本 136 (53.12%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 1.4051
处理批次 1/44, 累计样本数: 128, 批次损失: 1.6107
处理批次 2/44, 累计样本数: 192, 批次损失: 3.5845
处理批次 3/44, 累计样本数: 256, 批次损失: 1.8870
处理批次 4/44, 累计样本数: 320, 批次损失: 2.0416
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.9031, AUPRC=0.8121
当前学习率: 0.000025
Epoch 37/100 - 训练损失: 0.0892 - 验证AUROC: 0.9031 - 验证AUPRC: 0.8121
批次 0: 正样本 35, 负样本 29
批次 100: 正样本 27, 负样本 37
批次 200: 正样本 37, 负样本 27
批次 300: 正样本 37, 负样本 27
本轮训练: 正样本 136 (53.12%), 负样本 120 (46.88%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 2.9317
处理批次 1/44, 累计样本数: 128, 批次损失: 1.4696
处理批次 2/44, 累计样本数: 192, 批次损失: 3.3231
处理批次 3/44, 累计样本数: 256, 批次损失: 2.0120
处理批次 4/44, 累计样本数: 320, 批次损失: 1.8946
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.9046, AUPRC=0.8054
当前学习率: 0.000025
Epoch 38/100 - 训练损失: 0.0955 - 验证AUROC: 0.9046 - 验证AUPRC: 0.8054
批次 0: 正样本 36, 负样本 28
批次 100: 正样本 29, 负样本 35
批次 200: 正样本 25, 负样本 39
批次 300: 正样本 37, 负样本 27
本轮训练: 正样本 127 (49.61%), 负样本 129 (50.39%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 1.3982
处理批次 1/44, 累计样本数: 128, 批次损失: 1.7250
处理批次 2/44, 累计样本数: 192, 批次损失: 3.4455
处理批次 3/44, 累计样本数: 256, 批次损失: 1.9960
处理批次 4/44, 累计样本数: 320, 批次损失: 1.9928
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.9017, AUPRC=0.8124
当前学习率: 0.000025
Epoch 39/100 - 训练损失: 0.0821 - 验证AUROC: 0.9017 - 验证AUPRC: 0.8124
批次 0: 正样本 27, 负样本 37
批次 100: 正样本 39, 负样本 25
批次 200: 正样本 28, 负样本 36
批次 300: 正样本 32, 负样本 32
本轮训练: 正样本 126 (49.22%), 负样本 130 (50.78%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 1.7818
处理批次 1/44, 累计样本数: 128, 批次损失: 1.6620
处理批次 2/44, 累计样本数: 192, 批次损失: 3.5783
处理批次 3/44, 累计样本数: 256, 批次损失: 3.4118
处理批次 4/44, 累计样本数: 320, 批次损失: 3.4460
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.9006, AUPRC=0.8094
当前学习率: 0.000025
Epoch 40/100 - 训练损失: 0.0852 - 验证AUROC: 0.9006 - 验证AUPRC: 0.8094
批次 0: 正样本 24, 负样本 40
批次 100: 正样本 34, 负样本 30
批次 200: 正样本 41, 负样本 23
批次 300: 正样本 24, 负样本 40
本轮训练: 正样本 123 (48.05%), 负样本 133 (51.95%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 1.7976
处理批次 1/44, 累计样本数: 128, 批次损失: 2.0065
处理批次 2/44, 累计样本数: 192, 批次损失: 4.0337
处理批次 3/44, 累计样本数: 256, 批次损失: 2.0262
处理批次 4/44, 累计样本数: 320, 批次损失: 3.1547
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.9021, AUPRC=0.8038
Epoch 00041: reducing learning rate of group 0 to 1.2500e-05.
当前学习率: 0.000013
Epoch 41/100 - 训练损失: 0.0878 - 验证AUROC: 0.9021 - 验证AUPRC: 0.8038
批次 0: 正样本 28, 负样本 36
批次 100: 正样本 34, 负样本 30
批次 200: 正样本 36, 负样本 28
批次 300: 正样本 34, 负样本 30
本轮训练: 正样本 132 (51.56%), 负样本 124 (48.44%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 1.7311
处理批次 1/44, 累计样本数: 128, 批次损失: 2.0074
处理批次 2/44, 累计样本数: 192, 批次损失: 4.0715
处理批次 3/44, 累计样本数: 256, 批次损失: 2.0226
处理批次 4/44, 累计样本数: 320, 批次损失: 2.1133
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.9031, AUPRC=0.8058
当前学习率: 0.000013
Epoch 42/100 - 训练损失: 0.0794 - 验证AUROC: 0.9031 - 验证AUPRC: 0.8058
批次 0: 正样本 34, 负样本 30
批次 100: 正样本 30, 负样本 34
批次 200: 正样本 27, 负样本 37
批次 300: 正样本 31, 负样本 33
本轮训练: 正样本 122 (47.66%), 负样本 134 (52.34%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 1.3317
处理批次 1/44, 累计样本数: 128, 批次损失: 1.9015
处理批次 2/44, 累计样本数: 192, 批次损失: 3.9926
处理批次 3/44, 累计样本数: 256, 批次损失: 1.8995
处理批次 4/44, 累计样本数: 320, 批次损失: 2.0119
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.9030, AUPRC=0.8073
当前学习率: 0.000013
Epoch 43/100 - 训练损失: 0.0715 - 验证AUROC: 0.9030 - 验证AUPRC: 0.8073
批次 0: 正样本 31, 负样本 33
批次 100: 正样本 33, 负样本 31
批次 200: 正样本 35, 负样本 29
批次 300: 正样本 28, 负样本 36
本轮训练: 正样本 127 (49.61%), 负样本 129 (50.39%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 1.6646
处理批次 1/44, 累计样本数: 128, 批次损失: 2.0594
处理批次 2/44, 累计样本数: 192, 批次损失: 4.0859
处理批次 3/44, 累计样本数: 256, 批次损失: 2.1514
处理批次 4/44, 累计样本数: 320, 批次损失: 1.8848
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.9007, AUPRC=0.8076
当前学习率: 0.000013
Epoch 44/100 - 训练损失: 0.0733 - 验证AUROC: 0.9007 - 验证AUPRC: 0.8076
批次 0: 正样本 31, 负样本 33
批次 100: 正样本 25, 负样本 39
批次 200: 正样本 26, 负样本 38
批次 300: 正样本 28, 负样本 36
本轮训练: 正样本 110 (42.97%), 负样本 146 (57.03%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 1.5525
处理批次 1/44, 累计样本数: 128, 批次损失: 2.0699
处理批次 2/44, 累计样本数: 192, 批次损失: 4.0965
处理批次 3/44, 累计样本数: 256, 批次损失: 1.8507
处理批次 4/44, 累计样本数: 320, 批次损失: 3.4597
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.9013, AUPRC=0.8023
当前学习率: 0.000013
Epoch 45/100 - 训练损失: 0.0736 - 验证AUROC: 0.9013 - 验证AUPRC: 0.8023
批次 0: 正样本 38, 负样本 26
批次 100: 正样本 31, 负样本 33
批次 200: 正样本 24, 负样本 40
批次 300: 正样本 26, 负样本 38
本轮训练: 正样本 119 (46.48%), 负样本 137 (53.52%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 3.0144
处理批次 1/44, 累计样本数: 128, 批次损失: 2.2548
处理批次 2/44, 累计样本数: 192, 批次损失: 4.2191
处理批次 3/44, 累计样本数: 256, 批次损失: 1.9095
处理批次 4/44, 累计样本数: 320, 批次损失: 2.0180
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.9014, AUPRC=0.8058
Epoch 00046: reducing learning rate of group 0 to 6.2500e-06.
当前学习率: 0.000006
Epoch 46/100 - 训练损失: 0.0713 - 验证AUROC: 0.9014 - 验证AUPRC: 0.8058
批次 0: 正样本 30, 负样本 34
批次 100: 正样本 30, 负样本 34
批次 200: 正样本 32, 负样本 32
批次 300: 正样本 31, 负样本 33
本轮训练: 正样本 123 (48.05%), 负样本 133 (51.95%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 1.6721
处理批次 1/44, 累计样本数: 128, 批次损失: 2.1178
处理批次 2/44, 累计样本数: 192, 批次损失: 4.1921
处理批次 3/44, 累计样本数: 256, 批次损失: 1.9235
处理批次 4/44, 累计样本数: 320, 批次损失: 2.0692
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.8995, AUPRC=0.8018
当前学习率: 0.000006
Epoch 47/100 - 训练损失: 0.0729 - 验证AUROC: 0.8995 - 验证AUPRC: 0.8018
批次 0: 正样本 28, 负样本 36
批次 100: 正样本 24, 负样本 40
批次 200: 正样本 29, 负样本 35
批次 300: 正样本 32, 负样本 32
本轮训练: 正样本 113 (44.14%), 负样本 143 (55.86%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 1.6487
处理批次 1/44, 累计样本数: 128, 批次损失: 1.9910
处理批次 2/44, 累计样本数: 192, 批次损失: 4.1563
处理批次 3/44, 累计样本数: 256, 批次损失: 2.0241
处理批次 4/44, 累计样本数: 320, 批次损失: 2.1609
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.8984, AUPRC=0.7995
当前学习率: 0.000006
Epoch 48/100 - 训练损失: 0.0752 - 验证AUROC: 0.8984 - 验证AUPRC: 0.7995
批次 0: 正样本 32, 负样本 32
批次 100: 正样本 31, 负样本 33
批次 200: 正样本 29, 负样本 35
批次 300: 正样本 27, 负样本 37
本轮训练: 正样本 119 (46.48%), 负样本 137 (53.52%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 1.6925
处理批次 1/44, 累计样本数: 128, 批次损失: 2.1728
处理批次 2/44, 累计样本数: 192, 批次损失: 4.2203
处理批次 3/44, 累计样本数: 256, 批次损失: 2.0857
处理批次 4/44, 累计样本数: 320, 批次损失: 2.1312
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.8995, AUPRC=0.8022
当前学习率: 0.000006
Epoch 49/100 - 训练损失: 0.0662 - 验证AUROC: 0.8995 - 验证AUPRC: 0.8022
批次 0: 正样本 22, 负样本 42
批次 100: 正样本 23, 负样本 41
批次 200: 正样本 29, 负样本 35
批次 300: 正样本 29, 负样本 35
本轮训练: 正样本 103 (40.23%), 负样本 153 (59.77%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 1.6610
处理批次 1/44, 累计样本数: 128, 批次损失: 2.1260
处理批次 2/44, 累计样本数: 192, 批次损失: 4.1787
处理批次 3/44, 累计样本数: 256, 批次损失: 2.0478
处理批次 4/44, 累计样本数: 320, 批次损失: 2.1715
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.8997, AUPRC=0.8039
当前学习率: 0.000006
Epoch 50/100 - 训练损失: 0.0670 - 验证AUROC: 0.8997 - 验证AUPRC: 0.8039
批次 0: 正样本 29, 负样本 35
批次 100: 正样本 31, 负样本 33
批次 200: 正样本 29, 负样本 35
批次 300: 正样本 32, 负样本 32
本轮训练: 正样本 121 (47.27%), 负样本 135 (52.73%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 64, 批次损失: 1.7784
处理批次 1/44, 累计样本数: 128, 批次损失: 2.1023
处理批次 2/44, 累计样本数: 192, 批次损失: 4.1805
处理批次 3/44, 累计样本数: 256, 批次损失: 2.0821
处理批次 4/44, 累计样本数: 320, 批次损失: 1.9643
测试完成: 处理了 44/44 批次, 2764 个样本
错误批次数: 0
预测标签统计: 正样本数=892, 负样本数=1872
成功计算评估指标: AUROC=0.8990, AUPRC=0.8017
Epoch 00051: reducing learning rate of group 0 to 3.1250e-06.
当前学习率: 0.000003
早停触发！连续20轮验证集性能未提升
测试数据集大小: 33 批次
成功加载最佳模型状态（来自Epoch 31）
开始进行test评估...
处理批次 0/33, 累计样本数: 64, 批次损失: 1.4200
处理批次 1/33, 累计样本数: 128, 批次损失: 1.7819
处理批次 2/33, 累计样本数: 192, 批次损失: 4.3195
处理批次 3/33, 累计样本数: 256, 批次损失: 0.7937
处理批次 4/33, 累计样本数: 320, 批次损失: 7.5423
测试完成: 处理了 33/33 批次, 2078 个样本
错误批次数: 0
预测标签统计: 正样本数=672, 负样本数=1406
成功计算评估指标: AUROC=0.8866, AUPRC=0.7709
最佳阈值: 0.0568, 对应的F1分数: 0.8251
混淆矩阵:
[[1096  310]
 [  96  576]]
详细测试结果: AUROC=0.8866, AUPRC=0.7709, F1=0.8251, 敏感度=0.7795, 特异度=0.8571, 准确率=0.8046, 精确度=0.6501
训练完成！最佳模型来自Epoch 31 - AUROC: 0.8866 - F1: 0.8251
结果已保存到: result/DrugBAN3D_improved_augment_20250607_003142
