
================================================================================
DrugBAN 数据增强与标签生成流程
================================================================================
开始时间: 2025-06-07 13:09:05
原始缓存目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/cached_graphs
增强缓存目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250607_130903
原始标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/labels.csv
训练标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/train_stratified.csv
验证标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/val_stratified.csv
测试标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv
增强标签目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250607_130903
是否增强测试集: 否
================================================================================

步骤1：执行数据增强...
读取标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/labels.csv
总样本数: 10436, 正样本数: 3369 (32.28%), 负样本数: 7067 (67.72%)
使用的增强类型: ['gentle_rotate', 'thermal_vibration', 'bond_flexibility', 'smart_combined', 'minimal_edge_dropout']
正样本增强数量: 每个样本1次
负样本增强数量: 每个样本0次

数据增强完成! 耗时: 61.90秒
成功: 10398/10436 (99.64%)
失败记录已保存到 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250607_130903/augment_failures.txt
生成的文件总数: 13758
  原始文件数: 10398
  增强文件数: 3360
增强后样本总数: 13805
  正样本数: 6738 (48.81%)
  负样本数: 7067 (51.19%)

================================================================================
步骤2：为增强数据生成标签文件...
读取原始标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/labels.csv
原始标签文件包含 10436 条记录
使用预划分的测试集标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv
测试集包含 1044 条记录
测试集正样本率: 32.28%
正在从缓存目录 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250607_130903 中读取增强数据...
找到 13758 个缓存文件
从缓存文件中提取标签信息...
增强标签已保存至 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250607_130903/augmented_labels.csv，包含 13758 条记录
正样本: 6720 (48.84%), 负样本: 7038 (51.16%)
数据集划分: 训练集 7955 分子, 验证集 1404 分子, 测试集 1044 分子
验证集当前正样本率: 48.54%, 目标正样本率: 32.28%
调整验证集: 从900个正样本中抽样454个
调整后验证集正样本率: 32.24%
训练标签已保存至 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250607_130903/train_augmented.csv，包含 10529 条记录
验证标签已保存至 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250607_130903/valid_augmented.csv，包含 1408 条记录
测试标签已保存至 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250607_130903/test_augmented.csv，包含 1044 条记录
训练集: 总样本 10529, 正样本率 48.89%
验证集: 总样本 1408, 正样本率 32.24%
测试集: 总样本 1044, 正样本率 32.28%

================================================================================
数据增强与标签生成完成!
增强后的缓存文件保存在: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250607_130903
增强后的标签文件保存在: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250607_130903
结束时间: 2025-06-07 13:10:18
================================================================================

使用命令行指定的输出目录: result/DrugBAN3D_improved_augment_20250607_130903
已保存当前配置到 result/DrugBAN3D_improved_augment_20250607_130903/config/config_used.yaml
配置文件: result/DrugBAN3D_improved_augment_20250607_130903/config/DrugBAN3D_augmented_20250607_130903.yaml
输出目录: result/DrugBAN3D_improved_augment_20250607_130903
运行设备: cuda
数据加载器使用 16 个工作线程
使用分层采样的预划分数据集
数据集: 训练集 10529 样本, 验证集 1408 样本, 测试集 1044 样本
正样本比例: 训练集 48.89%, 验证集 32.24%, 测试集 32.28%
使用增强数据集进行训练...
加载标签文件: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250607_130903/train_augmented.csv, 包含 10529 条记录
找到 10529/10529 个对应的缓存文件
数据集初始化完成，总样本数: 10529
训练/验证 数据集初始化完成: 10529 个样本
创建数据加载器成功: 预期 165 批次，批次大小 64
加载标签文件: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250607_130903/valid_augmented.csv, 包含 1408 条记录
找到 1408/1408 个对应的缓存文件
数据集初始化完成，总样本数: 1408
训练/验证 数据集初始化完成: 1408 个样本
创建数据加载器成功: 预期 22 批次，批次大小 64
测试模式: 使用原始测试数据
测试标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv
缓存目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/cached_graphs
测试标签文件包含 1044 条记录
测试集标签分布: 正样本 337 (32.28%), 负样本 707 (67.72%)
读取测试标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv, 包含 1044 条记录
成功创建测试标签映射，包含 2088 个条目
测试模式：从标签文件获取 2088 个复合物ID
测试模式：只处理标签文件中的 2088 个样本
在缓存目录中找到 1039/2088 个测试样本缓存文件
数据集初始化完成，总样本数: 1039
测试 数据集初始化完成: 1039 个样本
创建数据加载器成功: 预期 17 批次，批次大小 64

==================================================
DrugBAN3D初始化 - 偏差校正模块: 启用
Dropout率: 0.5
GNN层数: 4
==================================================

优化器: Adam, 学习率: 0.0002, L2正则化强度: 0.001
启用标签平滑，参数值: 0.05
启用类别加权，正样本权重: 1.050
启用梯度裁剪，阈值：1.0
使用state_dict保存模型，避免完整对象复制
使用plateau学习率调度器
运行设备: cuda
启用标签平滑，参数值: 0.05
启用类别加权，正样本权重: 1.0499999523162842
使用ReduceLROnPlateau学习率调度器，监控验证集AUROC
开始训练...
批次 0: 正样本 36, 负样本 28
批次 100: 正样本 35, 负样本 29
本轮训练: 正样本 71 (55.47%), 负样本 57 (44.53%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 2.2875
处理批次 1/22, 累计样本数: 128, 批次损失: 2.2365
处理批次 2/22, 累计样本数: 192, 批次损失: 0.7553
处理批次 3/22, 累计样本数: 256, 批次损失: 2.1831
处理批次 4/22, 累计样本数: 320, 批次损失: 0.7872
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.5758, AUPRC=0.3889
当前学习率: 0.000200
保存最佳模型（轮次 1）到 result/DrugBAN3D_improved_augment_20250607_130903/best_model.pth
Epoch 1/100 - 训练损失: 2.9913 - 验证AUROC: 0.5758 - 验证AUPRC: 0.3889
批次 0: 正样本 25, 负样本 39
批次 100: 正样本 30, 负样本 34
本轮训练: 正样本 55 (42.97%), 负样本 73 (57.03%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 2.2207
处理批次 1/22, 累计样本数: 128, 批次损失: 2.1558
处理批次 2/22, 累计样本数: 192, 批次损失: 0.6513
处理批次 3/22, 累计样本数: 256, 批次损失: 2.2096
处理批次 4/22, 累计样本数: 320, 批次损失: 0.6520
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.6348, AUPRC=0.4361
当前学习率: 0.000200
保存最佳模型（轮次 2）到 result/DrugBAN3D_improved_augment_20250607_130903/best_model.pth
Epoch 2/100 - 训练损失: 2.2470 - 验证AUROC: 0.6348 - 验证AUPRC: 0.4361
批次 0: 正样本 30, 负样本 34
批次 100: 正样本 34, 负样本 30
本轮训练: 正样本 64 (50.00%), 负样本 64 (50.00%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 2.2799
处理批次 1/22, 累计样本数: 128, 批次损失: 2.1799
处理批次 2/22, 累计样本数: 192, 批次损失: 0.8315
处理批次 3/22, 累计样本数: 256, 批次损失: 2.1066
处理批次 4/22, 累计样本数: 320, 批次损失: 2.2548
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.6637, AUPRC=0.4507
当前学习率: 0.000200
保存最佳模型（轮次 3）到 result/DrugBAN3D_improved_augment_20250607_130903/best_model.pth
Epoch 3/100 - 训练损失: 1.9510 - 验证AUROC: 0.6637 - 验证AUPRC: 0.4507
批次 0: 正样本 31, 负样本 33
批次 100: 正样本 33, 负样本 31
本轮训练: 正样本 64 (50.00%), 负样本 64 (50.00%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 0.9723
处理批次 1/22, 累计样本数: 128, 批次损失: 2.1264
处理批次 2/22, 累计样本数: 192, 批次损失: 0.9186
处理批次 3/22, 累计样本数: 256, 批次损失: 2.2823
处理批次 4/22, 累计样本数: 320, 批次损失: 0.7254
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.6957, AUPRC=0.4998
当前学习率: 0.000200
保存最佳模型（轮次 4）到 result/DrugBAN3D_improved_augment_20250607_130903/best_model.pth
Epoch 4/100 - 训练损失: 1.6724 - 验证AUROC: 0.6957 - 验证AUPRC: 0.4998
批次 0: 正样本 36, 负样本 28
批次 100: 正样本 32, 负样本 32
本轮训练: 正样本 68 (53.12%), 负样本 60 (46.88%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 0.6120
处理批次 1/22, 累计样本数: 128, 批次损失: 2.1945
处理批次 2/22, 累计样本数: 192, 批次损失: 0.5667
处理批次 3/22, 累计样本数: 256, 批次损失: 2.0832
处理批次 4/22, 累计样本数: 320, 批次损失: 0.6896
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.7742, AUPRC=0.5845
当前学习率: 0.000200
保存最佳模型（轮次 5）到 result/DrugBAN3D_improved_augment_20250607_130903/best_model.pth
Epoch 5/100 - 训练损失: 1.5348 - 验证AUROC: 0.7742 - 验证AUPRC: 0.5845
批次 0: 正样本 40, 负样本 24
批次 100: 正样本 36, 负样本 28
本轮训练: 正样本 76 (59.38%), 负样本 52 (40.62%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 0.6728
处理批次 1/22, 累计样本数: 128, 批次损失: 2.1684
处理批次 2/22, 累计样本数: 192, 批次损失: 0.7445
处理批次 3/22, 累计样本数: 256, 批次损失: 2.1317
处理批次 4/22, 累计样本数: 320, 批次损失: 0.8332
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.7993, AUPRC=0.5986
当前学习率: 0.000200
保存最佳模型（轮次 6）到 result/DrugBAN3D_improved_augment_20250607_130903/best_model.pth
Epoch 6/100 - 训练损失: 1.4033 - 验证AUROC: 0.7993 - 验证AUPRC: 0.5986
批次 0: 正样本 26, 负样本 38
批次 100: 正样本 32, 负样本 32
本轮训练: 正样本 58 (45.31%), 负样本 70 (54.69%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 2.1778
处理批次 1/22, 累计样本数: 128, 批次损失: 2.2236
处理批次 2/22, 累计样本数: 192, 批次损失: 0.5953
处理批次 3/22, 累计样本数: 256, 批次损失: 2.1336
处理批次 4/22, 累计样本数: 320, 批次损失: 0.5137
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.7761, AUPRC=0.5874
当前学习率: 0.000200
Epoch 7/100 - 训练损失: 1.5702 - 验证AUROC: 0.7761 - 验证AUPRC: 0.5874
批次 0: 正样本 31, 负样本 33
批次 100: 正样本 25, 负样本 39
本轮训练: 正样本 56 (43.75%), 负样本 72 (56.25%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 2.1332
处理批次 1/22, 累计样本数: 128, 批次损失: 2.1191
处理批次 2/22, 累计样本数: 192, 批次损失: 0.8235
处理批次 3/22, 累计样本数: 256, 批次损失: 2.0911
处理批次 4/22, 累计样本数: 320, 批次损失: 0.9964
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.7806, AUPRC=0.5933
当前学习率: 0.000200
Epoch 8/100 - 训练损失: 1.3995 - 验证AUROC: 0.7806 - 验证AUPRC: 0.5933
批次 0: 正样本 29, 负样本 35
批次 100: 正样本 31, 负样本 33
本轮训练: 正样本 60 (46.88%), 负样本 68 (53.12%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 2.0094
处理批次 1/22, 累计样本数: 128, 批次损失: 2.2501
处理批次 2/22, 累计样本数: 192, 批次损失: 0.6391
处理批次 3/22, 累计样本数: 256, 批次损失: 2.2531
处理批次 4/22, 累计样本数: 320, 批次损失: 0.5827
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.7940, AUPRC=0.6163
当前学习率: 0.000200
Epoch 9/100 - 训练损失: 1.3531 - 验证AUROC: 0.7940 - 验证AUPRC: 0.6163
批次 0: 正样本 34, 负样本 30
批次 100: 正样本 35, 负样本 29
本轮训练: 正样本 69 (53.91%), 负样本 59 (46.09%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 0.7535
处理批次 1/22, 累计样本数: 128, 批次损失: 2.2690
处理批次 2/22, 累计样本数: 192, 批次损失: 0.7863
处理批次 3/22, 累计样本数: 256, 批次损失: 2.1181
处理批次 4/22, 累计样本数: 320, 批次损失: 0.6890
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.7466, AUPRC=0.5649
当前学习率: 0.000200
Epoch 10/100 - 训练损失: 1.2804 - 验证AUROC: 0.7466 - 验证AUPRC: 0.5649
批次 0: 正样本 33, 负样本 31
批次 100: 正样本 36, 负样本 28
本轮训练: 正样本 69 (53.91%), 负样本 59 (46.09%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 0.7218
处理批次 1/22, 累计样本数: 128, 批次损失: 2.1228
处理批次 2/22, 累计样本数: 192, 批次损失: 0.6383
处理批次 3/22, 累计样本数: 256, 批次损失: 2.1088
处理批次 4/22, 累计样本数: 320, 批次损失: 0.6420
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8204, AUPRC=0.6592
当前学习率: 0.000200
保存最佳模型（轮次 11）到 result/DrugBAN3D_improved_augment_20250607_130903/best_model.pth
Epoch 11/100 - 训练损失: 1.0353 - 验证AUROC: 0.8204 - 验证AUPRC: 0.6592
批次 0: 正样本 34, 负样本 30
批次 100: 正样本 31, 负样本 33
本轮训练: 正样本 65 (50.78%), 负样本 63 (49.22%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 2.0737
处理批次 1/22, 累计样本数: 128, 批次损失: 2.1423
处理批次 2/22, 累计样本数: 192, 批次损失: 0.7117
处理批次 3/22, 累计样本数: 256, 批次损失: 2.1620
处理批次 4/22, 累计样本数: 320, 批次损失: 0.6932
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8148, AUPRC=0.6459
当前学习率: 0.000200
Epoch 12/100 - 训练损失: 0.9419 - 验证AUROC: 0.8148 - 验证AUPRC: 0.6459
批次 0: 正样本 29, 负样本 35
批次 100: 正样本 26, 负样本 38
本轮训练: 正样本 55 (42.97%), 负样本 73 (57.03%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 2.2055
处理批次 1/22, 累计样本数: 128, 批次损失: 2.1639
处理批次 2/22, 累计样本数: 192, 批次损失: 0.7415
处理批次 3/22, 累计样本数: 256, 批次损失: 2.2674
处理批次 4/22, 累计样本数: 320, 批次损失: 0.8267
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8129, AUPRC=0.6312
当前学习率: 0.000200
Epoch 13/100 - 训练损失: 0.8673 - 验证AUROC: 0.8129 - 验证AUPRC: 0.6312
批次 0: 正样本 35, 负样本 29
批次 100: 正样本 30, 负样本 34
本轮训练: 正样本 65 (50.78%), 负样本 63 (49.22%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 2.2605
处理批次 1/22, 累计样本数: 128, 批次损失: 2.4258
处理批次 2/22, 累计样本数: 192, 批次损失: 0.7869
处理批次 3/22, 累计样本数: 256, 批次损失: 2.1069
处理批次 4/22, 累计样本数: 320, 批次损失: 0.8689
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.7816, AUPRC=0.5842
当前学习率: 0.000200
Epoch 14/100 - 训练损失: 0.8378 - 验证AUROC: 0.7816 - 验证AUPRC: 0.5842
批次 0: 正样本 33, 负样本 31
批次 100: 正样本 36, 负样本 28
本轮训练: 正样本 69 (53.91%), 负样本 59 (46.09%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 0.6283
处理批次 1/22, 累计样本数: 128, 批次损失: 1.4859
处理批次 2/22, 累计样本数: 192, 批次损失: 0.6001
处理批次 3/22, 累计样本数: 256, 批次损失: 1.0134
处理批次 4/22, 累计样本数: 320, 批次损失: 1.0815
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8358, AUPRC=0.6787
当前学习率: 0.000200
保存最佳模型（轮次 15）到 result/DrugBAN3D_improved_augment_20250607_130903/best_model.pth
Epoch 15/100 - 训练损失: 0.7373 - 验证AUROC: 0.8358 - 验证AUPRC: 0.6787
批次 0: 正样本 31, 负样本 33
批次 100: 正样本 39, 负样本 25
本轮训练: 正样本 70 (54.69%), 负样本 58 (45.31%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 0.5490
处理批次 1/22, 累计样本数: 128, 批次损失: 0.7849
处理批次 2/22, 累计样本数: 192, 批次损失: 0.6259
处理批次 3/22, 累计样本数: 256, 批次损失: 0.6271
处理批次 4/22, 累计样本数: 320, 批次损失: 0.7793
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8505, AUPRC=0.7249
当前学习率: 0.000200
保存最佳模型（轮次 16）到 result/DrugBAN3D_improved_augment_20250607_130903/best_model.pth
Epoch 16/100 - 训练损失: 0.7046 - 验证AUROC: 0.8505 - 验证AUPRC: 0.7249
批次 0: 正样本 29, 负样本 35
批次 100: 正样本 35, 负样本 29
本轮训练: 正样本 64 (50.00%), 负样本 64 (50.00%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 0.7749
处理批次 1/22, 累计样本数: 128, 批次损失: 0.8933
处理批次 2/22, 累计样本数: 192, 批次损失: 0.7794
处理批次 3/22, 累计样本数: 256, 批次损失: 0.7222
处理批次 4/22, 累计样本数: 320, 批次损失: 0.8242
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8364, AUPRC=0.7061
当前学习率: 0.000200
Epoch 17/100 - 训练损失: 0.6182 - 验证AUROC: 0.8364 - 验证AUPRC: 0.7061
批次 0: 正样本 31, 负样本 33
批次 100: 正样本 29, 负样本 35
本轮训练: 正样本 60 (46.88%), 负样本 68 (53.12%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 1.1407
处理批次 1/22, 累计样本数: 128, 批次损失: 1.4313
处理批次 2/22, 累计样本数: 192, 批次损失: 2.8652
处理批次 3/22, 累计样本数: 256, 批次损失: 1.8976
处理批次 4/22, 累计样本数: 320, 批次损失: 0.7890
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8300, AUPRC=0.7102
当前学习率: 0.000200
Epoch 18/100 - 训练损失: 0.5999 - 验证AUROC: 0.8300 - 验证AUPRC: 0.7102
批次 0: 正样本 25, 负样本 39
批次 100: 正样本 31, 负样本 33
本轮训练: 正样本 56 (43.75%), 负样本 72 (56.25%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 0.4518
处理批次 1/22, 累计样本数: 128, 批次损失: 0.8365
处理批次 2/22, 累计样本数: 192, 批次损失: 0.6067
处理批次 3/22, 累计样本数: 256, 批次损失: 0.5963
处理批次 4/22, 累计样本数: 320, 批次损失: 0.7094
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8665, AUPRC=0.7581
当前学习率: 0.000200
保存最佳模型（轮次 19）到 result/DrugBAN3D_improved_augment_20250607_130903/best_model.pth
Epoch 19/100 - 训练损失: 0.5498 - 验证AUROC: 0.8665 - 验证AUPRC: 0.7581
批次 0: 正样本 38, 负样本 26
批次 100: 正样本 28, 负样本 36
本轮训练: 正样本 66 (51.56%), 负样本 62 (48.44%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 0.4543
处理批次 1/22, 累计样本数: 128, 批次损失: 0.8472
处理批次 2/22, 累计样本数: 192, 批次损失: 0.5494
处理批次 3/22, 累计样本数: 256, 批次损失: 0.5788
处理批次 4/22, 累计样本数: 320, 批次损失: 0.7217
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8684, AUPRC=0.7475
当前学习率: 0.000200
保存最佳模型（轮次 20）到 result/DrugBAN3D_improved_augment_20250607_130903/best_model.pth
Epoch 20/100 - 训练损失: 0.5850 - 验证AUROC: 0.8684 - 验证AUPRC: 0.7475
批次 0: 正样本 31, 负样本 33
批次 100: 正样本 30, 负样本 34
本轮训练: 正样本 61 (47.66%), 负样本 67 (52.34%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 0.4982
处理批次 1/22, 累计样本数: 128, 批次损失: 0.7557
处理批次 2/22, 累计样本数: 192, 批次损失: 0.5447
处理批次 3/22, 累计样本数: 256, 批次损失: 0.6340
处理批次 4/22, 累计样本数: 320, 批次损失: 0.6470
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8735, AUPRC=0.7778
当前学习率: 0.000200
保存最佳模型（轮次 21）到 result/DrugBAN3D_improved_augment_20250607_130903/best_model.pth
Epoch 21/100 - 训练损失: 0.5536 - 验证AUROC: 0.8735 - 验证AUPRC: 0.7778
批次 0: 正样本 27, 负样本 37
批次 100: 正样本 34, 负样本 30
本轮训练: 正样本 61 (47.66%), 负样本 67 (52.34%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 0.5741
处理批次 1/22, 累计样本数: 128, 批次损失: 0.8031
处理批次 2/22, 累计样本数: 192, 批次损失: 0.5748
处理批次 3/22, 累计样本数: 256, 批次损失: 0.6546
处理批次 4/22, 累计样本数: 320, 批次损失: 0.6816
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8615, AUPRC=0.7514
当前学习率: 0.000200
Epoch 22/100 - 训练损失: 0.4987 - 验证AUROC: 0.8615 - 验证AUPRC: 0.7514
批次 0: 正样本 28, 负样本 36
批次 100: 正样本 31, 负样本 33
本轮训练: 正样本 59 (46.09%), 负样本 69 (53.91%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 0.5668
处理批次 1/22, 累计样本数: 128, 批次损失: 0.7863
处理批次 2/22, 累计样本数: 192, 批次损失: 0.5631
处理批次 3/22, 累计样本数: 256, 批次损失: 0.6362
处理批次 4/22, 累计样本数: 320, 批次损失: 0.7799
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8612, AUPRC=0.7469
当前学习率: 0.000200
Epoch 23/100 - 训练损失: 0.4700 - 验证AUROC: 0.8612 - 验证AUPRC: 0.7469
批次 0: 正样本 31, 负样本 33
批次 100: 正样本 26, 负样本 38
本轮训练: 正样本 57 (44.53%), 负样本 71 (55.47%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 0.5823
处理批次 1/22, 累计样本数: 128, 批次损失: 1.1946
处理批次 2/22, 累计样本数: 192, 批次损失: 0.6441
处理批次 3/22, 累计样本数: 256, 批次损失: 0.8234
处理批次 4/22, 累计样本数: 320, 批次损失: 0.8496
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8743, AUPRC=0.7736
当前学习率: 0.000200
保存最佳模型（轮次 24）到 result/DrugBAN3D_improved_augment_20250607_130903/best_model.pth
Epoch 24/100 - 训练损失: 0.5045 - 验证AUROC: 0.8743 - 验证AUPRC: 0.7736
批次 0: 正样本 26, 负样本 38
批次 100: 正样本 30, 负样本 34
本轮训练: 正样本 56 (43.75%), 负样本 72 (56.25%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 0.5743
处理批次 1/22, 累计样本数: 128, 批次损失: 0.8883
处理批次 2/22, 累计样本数: 192, 批次损失: 0.6489
处理批次 3/22, 累计样本数: 256, 批次损失: 0.7298
处理批次 4/22, 累计样本数: 320, 批次损失: 1.0826
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8885, AUPRC=0.7888
当前学习率: 0.000200
保存最佳模型（轮次 25）到 result/DrugBAN3D_improved_augment_20250607_130903/best_model.pth
Epoch 25/100 - 训练损失: 0.4873 - 验证AUROC: 0.8885 - 验证AUPRC: 0.7888
批次 0: 正样本 28, 负样本 36
批次 100: 正样本 39, 负样本 25
本轮训练: 正样本 67 (52.34%), 负样本 61 (47.66%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 0.6899
处理批次 1/22, 累计样本数: 128, 批次损失: 1.0062
处理批次 2/22, 累计样本数: 192, 批次损失: 0.7275
处理批次 3/22, 累计样本数: 256, 批次损失: 0.6829
处理批次 4/22, 累计样本数: 320, 批次损失: 0.7715
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8885, AUPRC=0.7967
当前学习率: 0.000200
Epoch 26/100 - 训练损失: 0.4710 - 验证AUROC: 0.8885 - 验证AUPRC: 0.7967
批次 0: 正样本 32, 负样本 32
批次 100: 正样本 36, 负样本 28
本轮训练: 正样本 68 (53.12%), 负样本 60 (46.88%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 1.0138
处理批次 1/22, 累计样本数: 128, 批次损失: 1.6016
处理批次 2/22, 累计样本数: 192, 批次损失: 0.7300
处理批次 3/22, 累计样本数: 256, 批次损失: 0.8006
处理批次 4/22, 累计样本数: 320, 批次损失: 0.8677
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8624, AUPRC=0.7465
当前学习率: 0.000200
Epoch 27/100 - 训练损失: 0.4438 - 验证AUROC: 0.8624 - 验证AUPRC: 0.7465
批次 0: 正样本 35, 负样本 29
批次 100: 正样本 34, 负样本 30
本轮训练: 正样本 69 (53.91%), 负样本 59 (46.09%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 0.6080
处理批次 1/22, 累计样本数: 128, 批次损失: 1.0496
处理批次 2/22, 累计样本数: 192, 批次损失: 0.8321
处理批次 3/22, 累计样本数: 256, 批次损失: 1.0799
处理批次 4/22, 累计样本数: 320, 批次损失: 0.6956
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8811, AUPRC=0.7926
当前学习率: 0.000200
Epoch 28/100 - 训练损失: 0.4288 - 验证AUROC: 0.8811 - 验证AUPRC: 0.7926
批次 0: 正样本 33, 负样本 31
批次 100: 正样本 36, 负样本 28
本轮训练: 正样本 69 (53.91%), 负样本 59 (46.09%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 0.6574
处理批次 1/22, 累计样本数: 128, 批次损失: 1.1458
处理批次 2/22, 累计样本数: 192, 批次损失: 0.5745
处理批次 3/22, 累计样本数: 256, 批次损失: 1.3542
处理批次 4/22, 累计样本数: 320, 批次损失: 0.6995
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8744, AUPRC=0.7808
当前学习率: 0.000200
Epoch 29/100 - 训练损失: 0.4353 - 验证AUROC: 0.8744 - 验证AUPRC: 0.7808
批次 0: 正样本 30, 负样本 34
批次 100: 正样本 29, 负样本 35
本轮训练: 正样本 59 (46.09%), 负样本 69 (53.91%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 0.9899
处理批次 1/22, 累计样本数: 128, 批次损失: 1.6534
处理批次 2/22, 累计样本数: 192, 批次损失: 0.6617
处理批次 3/22, 累计样本数: 256, 批次损失: 0.6555
处理批次 4/22, 累计样本数: 320, 批次损失: 0.9609
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8760, AUPRC=0.7832
Epoch 00030: reducing learning rate of group 0 to 1.0000e-04.
当前学习率: 0.000100
Epoch 30/100 - 训练损失: 0.4281 - 验证AUROC: 0.8760 - 验证AUPRC: 0.7832
批次 0: 正样本 29, 负样本 35
批次 100: 正样本 34, 负样本 30
本轮训练: 正样本 63 (49.22%), 负样本 65 (50.78%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 0.7673
处理批次 1/22, 累计样本数: 128, 批次损失: 2.4772
处理批次 2/22, 累计样本数: 192, 批次损失: 0.6738
处理批次 3/22, 累计样本数: 256, 批次损失: 0.7615
处理批次 4/22, 累计样本数: 320, 批次损失: 0.8864
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8881, AUPRC=0.8091
当前学习率: 0.000100
Epoch 31/100 - 训练损失: 0.3760 - 验证AUROC: 0.8881 - 验证AUPRC: 0.8091
批次 0: 正样本 33, 负样本 31
批次 100: 正样本 32, 负样本 32
本轮训练: 正样本 65 (50.78%), 负样本 63 (49.22%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 0.6163
处理批次 1/22, 累计样本数: 128, 批次损失: 0.8108
处理批次 2/22, 累计样本数: 192, 批次损失: 0.5109
处理批次 3/22, 累计样本数: 256, 批次损失: 0.7522
处理批次 4/22, 累计样本数: 320, 批次损失: 0.7271
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8986, AUPRC=0.8119
当前学习率: 0.000100
保存最佳模型（轮次 32）到 result/DrugBAN3D_improved_augment_20250607_130903/best_model.pth
Epoch 32/100 - 训练损失: 0.3677 - 验证AUROC: 0.8986 - 验证AUPRC: 0.8119
批次 0: 正样本 27, 负样本 37
批次 100: 正样本 35, 负样本 29
本轮训练: 正样本 62 (48.44%), 负样本 66 (51.56%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 1.0701
处理批次 1/22, 累计样本数: 128, 批次损失: 1.8099
处理批次 2/22, 累计样本数: 192, 批次损失: 0.6626
处理批次 3/22, 累计样本数: 256, 批次损失: 0.8587
处理批次 4/22, 累计样本数: 320, 批次损失: 1.0260
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8764, AUPRC=0.7942
当前学习率: 0.000100
Epoch 33/100 - 训练损失: 0.3396 - 验证AUROC: 0.8764 - 验证AUPRC: 0.7942
批次 0: 正样本 29, 负样本 35
批次 100: 正样本 33, 负样本 31
本轮训练: 正样本 62 (48.44%), 负样本 66 (51.56%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 0.7355
处理批次 1/22, 累计样本数: 128, 批次损失: 0.8682
处理批次 2/22, 累计样本数: 192, 批次损失: 0.6250
处理批次 3/22, 累计样本数: 256, 批次损失: 0.8391
处理批次 4/22, 累计样本数: 320, 批次损失: 0.7422
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8961, AUPRC=0.8178
当前学习率: 0.000100
Epoch 34/100 - 训练损失: 0.3633 - 验证AUROC: 0.8961 - 验证AUPRC: 0.8178
批次 0: 正样本 31, 负样本 33
批次 100: 正样本 26, 负样本 38
本轮训练: 正样本 57 (44.53%), 负样本 71 (55.47%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 0.7735
处理批次 1/22, 累计样本数: 128, 批次损失: 1.0478
处理批次 2/22, 累计样本数: 192, 批次损失: 0.8289
处理批次 3/22, 累计样本数: 256, 批次损失: 0.8703
处理批次 4/22, 累计样本数: 320, 批次损失: 0.9075
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8799, AUPRC=0.7953
当前学习率: 0.000100
Epoch 35/100 - 训练损失: 0.3473 - 验证AUROC: 0.8799 - 验证AUPRC: 0.7953
批次 0: 正样本 25, 负样本 39
批次 100: 正样本 25, 负样本 39
本轮训练: 正样本 50 (39.06%), 负样本 78 (60.94%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 0.9041
处理批次 1/22, 累计样本数: 128, 批次损失: 1.1407
处理批次 2/22, 累计样本数: 192, 批次损失: 0.9162
处理批次 3/22, 累计样本数: 256, 批次损失: 0.8392
处理批次 4/22, 累计样本数: 320, 批次损失: 0.9959
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8797, AUPRC=0.8019
当前学习率: 0.000100
Epoch 36/100 - 训练损失: 0.3291 - 验证AUROC: 0.8797 - 验证AUPRC: 0.8019
批次 0: 正样本 27, 负样本 37
批次 100: 正样本 30, 负样本 34
本轮训练: 正样本 57 (44.53%), 负样本 71 (55.47%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 0.7763
处理批次 1/22, 累计样本数: 128, 批次损失: 0.9318
处理批次 2/22, 累计样本数: 192, 批次损失: 0.5475
处理批次 3/22, 累计样本数: 256, 批次损失: 0.8080
处理批次 4/22, 累计样本数: 320, 批次损失: 0.9322
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8932, AUPRC=0.8164
Epoch 00037: reducing learning rate of group 0 to 5.0000e-05.
当前学习率: 0.000050
Epoch 37/100 - 训练损失: 0.3504 - 验证AUROC: 0.8932 - 验证AUPRC: 0.8164
批次 0: 正样本 29, 负样本 35
批次 100: 正样本 30, 负样本 34
本轮训练: 正样本 59 (46.09%), 负样本 69 (53.91%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 0.9218
处理批次 1/22, 累计样本数: 128, 批次损失: 1.1316
处理批次 2/22, 累计样本数: 192, 批次损失: 0.6941
处理批次 3/22, 累计样本数: 256, 批次损失: 0.8510
处理批次 4/22, 累计样本数: 320, 批次损失: 0.9803
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8951, AUPRC=0.8216
当前学习率: 0.000050
Epoch 38/100 - 训练损失: 0.3402 - 验证AUROC: 0.8951 - 验证AUPRC: 0.8216
批次 0: 正样本 37, 负样本 27
批次 100: 正样本 22, 负样本 42
本轮训练: 正样本 59 (46.09%), 负样本 69 (53.91%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 0.9149
处理批次 1/22, 累计样本数: 128, 批次损失: 1.1513
处理批次 2/22, 累计样本数: 192, 批次损失: 0.6600
处理批次 3/22, 累计样本数: 256, 批次损失: 0.8810
处理批次 4/22, 累计样本数: 320, 批次损失: 0.8376
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8964, AUPRC=0.8175
当前学习率: 0.000050
Epoch 39/100 - 训练损失: 0.3125 - 验证AUROC: 0.8964 - 验证AUPRC: 0.8175
批次 0: 正样本 31, 负样本 33
批次 100: 正样本 35, 负样本 29
本轮训练: 正样本 66 (51.56%), 负样本 62 (48.44%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 1.1142
处理批次 1/22, 累计样本数: 128, 批次损失: 1.0814
处理批次 2/22, 累计样本数: 192, 批次损失: 0.6390
处理批次 3/22, 累计样本数: 256, 批次损失: 1.0138
处理批次 4/22, 累计样本数: 320, 批次损失: 1.0348
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.9008, AUPRC=0.8252
当前学习率: 0.000050
保存最佳模型（轮次 40）到 result/DrugBAN3D_improved_augment_20250607_130903/best_model.pth
Epoch 40/100 - 训练损失: 0.2903 - 验证AUROC: 0.9008 - 验证AUPRC: 0.8252
批次 0: 正样本 28, 负样本 36
批次 100: 正样本 27, 负样本 37
本轮训练: 正样本 55 (42.97%), 负样本 73 (57.03%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 2.4617
处理批次 1/22, 累计样本数: 128, 批次损失: 1.3053
处理批次 2/22, 累计样本数: 192, 批次损失: 0.6048
处理批次 3/22, 累计样本数: 256, 批次损失: 0.9516
处理批次 4/22, 累计样本数: 320, 批次损失: 0.9953
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8985, AUPRC=0.8186
当前学习率: 0.000050
Epoch 41/100 - 训练损失: 0.3002 - 验证AUROC: 0.8985 - 验证AUPRC: 0.8186
批次 0: 正样本 33, 负样本 31
批次 100: 正样本 36, 负样本 28
本轮训练: 正样本 69 (53.91%), 负样本 59 (46.09%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 2.5273
处理批次 1/22, 累计样本数: 128, 批次损失: 1.1957
处理批次 2/22, 累计样本数: 192, 批次损失: 0.6471
处理批次 3/22, 累计样本数: 256, 批次损失: 1.0487
处理批次 4/22, 累计样本数: 320, 批次损失: 1.1361
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8970, AUPRC=0.8199
当前学习率: 0.000050
Epoch 42/100 - 训练损失: 0.2880 - 验证AUROC: 0.8970 - 验证AUPRC: 0.8199
批次 0: 正样本 38, 负样本 26
批次 100: 正样本 38, 负样本 26
本轮训练: 正样本 76 (59.38%), 负样本 52 (40.62%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 0.9467
处理批次 1/22, 累计样本数: 128, 批次损失: 1.0021
处理批次 2/22, 累计样本数: 192, 批次损失: 0.5566
处理批次 3/22, 累计样本数: 256, 批次损失: 1.0610
处理批次 4/22, 累计样本数: 320, 批次损失: 1.1282
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.9021, AUPRC=0.8333
当前学习率: 0.000050
保存最佳模型（轮次 43）到 result/DrugBAN3D_improved_augment_20250607_130903/best_model.pth
Epoch 43/100 - 训练损失: 0.2853 - 验证AUROC: 0.9021 - 验证AUPRC: 0.8333
批次 0: 正样本 34, 负样本 30
批次 100: 正样本 32, 负样本 32
本轮训练: 正样本 66 (51.56%), 负样本 62 (48.44%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 1.2318
处理批次 1/22, 累计样本数: 128, 批次损失: 1.2427
处理批次 2/22, 累计样本数: 192, 批次损失: 0.7054
处理批次 3/22, 累计样本数: 256, 批次损失: 1.1659
处理批次 4/22, 累计样本数: 320, 批次损失: 1.1924
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8967, AUPRC=0.8186
当前学习率: 0.000050
Epoch 44/100 - 训练损失: 0.2989 - 验证AUROC: 0.8967 - 验证AUPRC: 0.8186
批次 0: 正样本 31, 负样本 33
批次 100: 正样本 27, 负样本 37
本轮训练: 正样本 58 (45.31%), 负样本 70 (54.69%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 1.0725
处理批次 1/22, 累计样本数: 128, 批次损失: 1.1664
处理批次 2/22, 累计样本数: 192, 批次损失: 0.7611
处理批次 3/22, 累计样本数: 256, 批次损失: 1.3051
处理批次 4/22, 累计样本数: 320, 批次损失: 1.0680
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.9044, AUPRC=0.8320
当前学习率: 0.000050
保存最佳模型（轮次 45）到 result/DrugBAN3D_improved_augment_20250607_130903/best_model.pth
Epoch 45/100 - 训练损失: 0.2906 - 验证AUROC: 0.9044 - 验证AUPRC: 0.8320
批次 0: 正样本 36, 负样本 28
批次 100: 正样本 31, 负样本 33
本轮训练: 正样本 67 (52.34%), 负样本 61 (47.66%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 0.9079
处理批次 1/22, 累计样本数: 128, 批次损失: 1.2865
处理批次 2/22, 累计样本数: 192, 批次损失: 0.8076
处理批次 3/22, 累计样本数: 256, 批次损失: 0.9332
处理批次 4/22, 累计样本数: 320, 批次损失: 1.1296
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8951, AUPRC=0.8239
当前学习率: 0.000050
Epoch 46/100 - 训练损失: 0.2973 - 验证AUROC: 0.8951 - 验证AUPRC: 0.8239
批次 0: 正样本 28, 负样本 36
批次 100: 正样本 36, 负样本 28
本轮训练: 正样本 64 (50.00%), 负样本 64 (50.00%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 1.1757
处理批次 1/22, 累计样本数: 128, 批次损失: 1.3850
处理批次 2/22, 累计样本数: 192, 批次损失: 0.7552
处理批次 3/22, 累计样本数: 256, 批次损失: 1.1660
处理批次 4/22, 累计样本数: 320, 批次损失: 0.9177
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8971, AUPRC=0.8219
当前学习率: 0.000050
Epoch 47/100 - 训练损失: 0.3084 - 验证AUROC: 0.8971 - 验证AUPRC: 0.8219
批次 0: 正样本 34, 负样本 30
批次 100: 正样本 38, 负样本 26
本轮训练: 正样本 72 (56.25%), 负样本 56 (43.75%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 1.1849
处理批次 1/22, 累计样本数: 128, 批次损失: 1.4146
处理批次 2/22, 累计样本数: 192, 批次损失: 0.7036
处理批次 3/22, 累计样本数: 256, 批次损失: 1.1558
处理批次 4/22, 累计样本数: 320, 批次损失: 1.4261
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8860, AUPRC=0.8107
当前学习率: 0.000050
Epoch 48/100 - 训练损失: 0.2949 - 验证AUROC: 0.8860 - 验证AUPRC: 0.8107
批次 0: 正样本 33, 负样本 31
批次 100: 正样本 37, 负样本 27
本轮训练: 正样本 70 (54.69%), 负样本 58 (45.31%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 1.1585
处理批次 1/22, 累计样本数: 128, 批次损失: 1.1581
处理批次 2/22, 累计样本数: 192, 批次损失: 0.8900
处理批次 3/22, 累计样本数: 256, 批次损失: 2.4408
处理批次 4/22, 累计样本数: 320, 批次损失: 1.2016
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8922, AUPRC=0.8113
当前学习率: 0.000050
Epoch 49/100 - 训练损失: 0.2967 - 验证AUROC: 0.8922 - 验证AUPRC: 0.8113
批次 0: 正样本 30, 负样本 34
批次 100: 正样本 27, 负样本 37
本轮训练: 正样本 57 (44.53%), 负样本 71 (55.47%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 0.9888
处理批次 1/22, 累计样本数: 128, 批次损失: 1.5324
处理批次 2/22, 累计样本数: 192, 批次损失: 0.8270
处理批次 3/22, 累计样本数: 256, 批次损失: 1.4364
处理批次 4/22, 累计样本数: 320, 批次损失: 1.3611
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8694, AUPRC=0.7731
Epoch 00050: reducing learning rate of group 0 to 2.5000e-05.
当前学习率: 0.000025
Epoch 50/100 - 训练损失: 0.2918 - 验证AUROC: 0.8694 - 验证AUPRC: 0.7731
批次 0: 正样本 35, 负样本 29
批次 100: 正样本 28, 负样本 36
本轮训练: 正样本 63 (49.22%), 负样本 65 (50.78%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 1.3694
处理批次 1/22, 累计样本数: 128, 批次损失: 1.3747
处理批次 2/22, 累计样本数: 192, 批次损失: 0.8519
处理批次 3/22, 累计样本数: 256, 批次损失: 2.6156
处理批次 4/22, 累计样本数: 320, 批次损失: 1.4887
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8838, AUPRC=0.7944
当前学习率: 0.000025
Epoch 51/100 - 训练损失: 0.2746 - 验证AUROC: 0.8838 - 验证AUPRC: 0.7944
批次 0: 正样本 30, 负样本 34
批次 100: 正样本 31, 负样本 33
本轮训练: 正样本 61 (47.66%), 负样本 67 (52.34%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 2.7296
处理批次 1/22, 累计样本数: 128, 批次损失: 1.5037
处理批次 2/22, 累计样本数: 192, 批次损失: 0.8274
处理批次 3/22, 累计样本数: 256, 批次损失: 2.5384
处理批次 4/22, 累计样本数: 320, 批次损失: 1.4455
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8846, AUPRC=0.7924
当前学习率: 0.000025
Epoch 52/100 - 训练损失: 0.2728 - 验证AUROC: 0.8846 - 验证AUPRC: 0.7924
批次 0: 正样本 35, 负样本 29
批次 100: 正样本 32, 负样本 32
本轮训练: 正样本 67 (52.34%), 负样本 61 (47.66%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 1.4952
处理批次 1/22, 累计样本数: 128, 批次损失: 1.4307
处理批次 2/22, 累计样本数: 192, 批次损失: 0.9129
处理批次 3/22, 累计样本数: 256, 批次损失: 1.4101
处理批次 4/22, 累计样本数: 320, 批次损失: 1.3180
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8903, AUPRC=0.8139
当前学习率: 0.000025
Epoch 53/100 - 训练损失: 0.2591 - 验证AUROC: 0.8903 - 验证AUPRC: 0.8139
批次 0: 正样本 28, 负样本 36
批次 100: 正样本 33, 负样本 31
本轮训练: 正样本 61 (47.66%), 负样本 67 (52.34%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 1.5565
处理批次 1/22, 累计样本数: 128, 批次损失: 1.4464
处理批次 2/22, 累计样本数: 192, 批次损失: 0.8965
处理批次 3/22, 累计样本数: 256, 批次损失: 1.4875
处理批次 4/22, 累计样本数: 320, 批次损失: 1.3788
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8860, AUPRC=0.8009
当前学习率: 0.000025
Epoch 54/100 - 训练损失: 0.2524 - 验证AUROC: 0.8860 - 验证AUPRC: 0.8009
批次 0: 正样本 24, 负样本 40
批次 100: 正样本 31, 负样本 33
本轮训练: 正样本 55 (42.97%), 负样本 73 (57.03%)
验证数据集大小: 22 批次
开始进行val评估...
处理批次 0/22, 累计样本数: 64, 批次损失: 1.7379
处理批次 1/22, 累计样本数: 128, 批次损失: 1.8915
处理批次 2/22, 累计样本数: 192, 批次损失: 0.8222
处理批次 3/22, 累计样本数: 256, 批次损失: 1.4380
处理批次 4/22, 累计样本数: 320, 批次损失: 1.4585
测试完成: 处理了 22/22 批次, 1408 个样本
错误批次数: 0
预测标签统计: 正样本数=454, 负样本数=954
成功计算评估指标: AUROC=0.8779, AUPRC=0.7841
Epoch 00055: reducing learning rate of group 0 to 1.2500e-05.
当前学习率: 0.000013
早停触发！连续10轮验证集性能未提升
测试数据集大小: 17 批次
成功加载最佳模型状态（来自Epoch 45）
开始进行test评估...
处理批次 0/17, 累计样本数: 64, 批次损失: 0.9969
处理批次 1/17, 累计样本数: 128, 批次损失: 0.8622
处理批次 2/17, 累计样本数: 192, 批次损失: 3.3046
处理批次 3/17, 累计样本数: 256, 批次损失: 0.9799
处理批次 4/17, 累计样本数: 320, 批次损失: 0.9056
测试完成: 处理了 17/17 批次, 1039 个样本
错误批次数: 0
预测标签统计: 正样本数=336, 负样本数=703
成功计算评估指标: AUROC=0.8890, AUPRC=0.8048
最佳阈值: 0.1917, 对应的F1分数: 0.8289
混淆矩阵:
[[534 169]
 [ 41 295]]
详细测试结果: AUROC=0.8890, AUPRC=0.8048, F1=0.8289, 敏感度=0.7596, 特异度=0.8780, 准确率=0.7979, 精确度=0.6358
训练完成！最佳模型来自Epoch 45 - AUROC: 0.8890 - F1: 0.8289
结果已保存到: result/DrugBAN3D_improved_augment_20250607_130903
