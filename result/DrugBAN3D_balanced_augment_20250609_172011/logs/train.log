
================================================================================
DrugBAN 数据增强与标签生成流程
================================================================================
开始时间: 2025-06-09 17:20:12
原始缓存目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/cached_graphs
增强缓存目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250609_172011
原始标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/labels.csv
训练标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/train_stratified.csv
验证标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/val_stratified.csv
测试标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv
增强标签目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_172011
是否增强测试集: 否
================================================================================

步骤1：执行数据增强...
读取标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/labels.csv
总样本数: 10436, 正样本数: 3369 (32.28%), 负样本数: 7067 (67.72%)
使用的增强类型: ['gentle_rotate', 'thermal_vibration']
正样本增强数量: 每个样本0.5次
负样本增强数量: 每个样本0.5次

数据增强完成! 耗时: 345.35秒
成功: 10398/10436 (99.64%)
失败记录已保存到 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250609_172011/augment_failures.txt
生成的文件总数: 15620
  原始文件数: 10398
  增强文件数: 5222
增强后样本总数: 15654 (期望值)
  正样本数: 5053 (32.28%)
  负样本数: 10600 (67.72%)
分布保持: 原始32.28% → 增强后32.28% (分布保持)

================================================================================
步骤2：为增强数据生成标签文件...
读取原始标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/labels.csv
原始标签文件包含 10436 条记录
使用预划分的测试集标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv
测试集包含 1044 条记录
测试集正样本率: 32.28%
正在从缓存目录 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250609_172011 中读取增强数据...
找到 15620 个缓存文件
从缓存文件中提取标签信息...
增强标签已保存至 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_172011/augmented_labels.csv，包含 15620 条记录
正样本: 5057 (32.38%), 负样本: 10563 (67.62%)
数据集划分: 训练集 7955 分子, 验证集 1404 分子, 测试集 1044 分子
验证集当前正样本率: 33.15%, 目标正样本率: 32.28%
调整验证集: 从706个正样本中抽样678个
调整后验证集正样本率: 32.25%
训练标签已保存至 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_172011/train_augmented.csv，包含 11941 条记录
验证标签已保存至 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_172011/valid_augmented.csv，包含 2102 条记录
测试标签已保存至 /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_172011/test_augmented.csv，包含 1044 条记录
训练集: 总样本 11941, 正样本率 32.23%
验证集: 总样本 2102, 正样本率 32.25%
测试集: 总样本 1044, 正样本率 32.28%

================================================================================
数据增强与标签生成完成!
增强后的缓存文件保存在: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250609_172011
增强后的标签文件保存在: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_172011
结束时间: 2025-06-09 17:26:14
================================================================================

=== 详细配置信息 ===
配置文件: result/DrugBAN3D_balanced_augment_20250609_172011/config/DrugBAN3D_augmented_20250609_172011.yaml
训练数据: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_172011/train_augmented.csv
验证数据: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_172011/valid_augmented.csv
测试数据: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv
缓存目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/graphs/20250609_172011
结果目录: result/DrugBAN3D_balanced_augment_20250609_172011

=== 完整配置参数详览 ===
📋 训练参数 (TRAIN):
  TRAIN:
    D_LEARNING_RATE: 0.0004   # 最优判别器学习率（来自最佳实验）
    G_LEARNING_RATE: 0.0002   # 最优生成器学习率（来自最佳实验）
    BATCH_SIZE: 48  # 最佳batch size（来自最佳实验）
    D_STEPS_PER_G_STEP: 1
    RESUME_CHECKPOINT: ""
    EPOCH: 100  # 充足的训练轮数
    GRADIENT_ACCUMULATE_STEPS: 2  # 梯度累积，有效batch size = 48*2 = 96
    GRADIENT_CLIP_NORM: 1.0  # 梯度裁剪阈值（来自最佳实验）
    WEIGHT_DECAY: 0.0004  # 最优权重衰减（来自最佳实验）
    LABEL_SMOOTHING: 0.05  # 标签平滑参数（来自最佳实验）
    POS_WEIGHT: 1.05  # 正样本权重（来自最佳实验）

🏗️ GNN配置:
  GNN:
    HIDDEN_DIM: 384  # 最优GNN隐藏维度
    NUM_LAYERS: 4    # 最优GNN层数
  
  BCN:
    HEADS: 8  # 最优注意力头数量

🔧 解码器配置:
  DECODER:
    IN_DIM: 384
    HIDDEN_DIM: 512  # 最优解码器隐藏维度
    OUT_DIM: 128  # 最优解码器输出维度
    BINARY: 1
    DROPOUT: 0.3  # 最优Dropout率，平衡过拟合和欠拟合
  
  ADAPT:
    LAMBDA: 0.1

📊 损失函数配置:
  USE_BIAS_CORRECTION: True  # 启用偏置校正，提升模型稳定性
  USE_FOCAL_LOSS: True  # 使用焦点损失处理类别不平衡
  FOCAL_LOSS_GAMMA: 1.0  # 最优gamma值，温和的焦点损失
  FOCAL_LOSS_ALPHA: 0.3  # 最优alpha值，平衡正负样本

🌐 3D空间特征配置:
  SPATIAL_3D:
    ENABLE_SPATIAL_FUSION: true      # 启用3D空间感知特征融合 - 重要性能提升
    ENABLE_MULTISCALE: true          # 启用多尺度特征提取 - 捕获不同距离的相互作用
    DISTANCE_SCALES: [2.0, 5.0, 8.0]  # 最优多尺度距离阈值(Å)
    SPATIAL_DROPOUT: 0.1             # 最优空间模块Dropout率
    CROSS_ATTENTION_HEADS: 8         # 最优交叉注意力头数
  
  # 损失函数配置 - 最优设置
  USE_FOCAL_LOSS: True  # 使用焦点损失处理类别不平衡

⚙️ 求解器配置:
  SOLVER:
    MAX_EPOCH: 100  # 充足的训练轮数
    BATCH_SIZE: 48  # 最优batch size（来自最佳实验）
    USE_MIXED_PRECISION: False  # 不使用混合精度训练，保持稳定性
    LR_SCHEDULER: True  # 启用学习率调度器（来自最佳实验）
    LR_SCHEDULER_TYPE: "plateau"  # 最优学习率调度器（来自最佳实验）
    LR_WARMUP_EPOCHS: 4  # 最优学习率预热轮数（来自最佳实验）
    GRADIENT_CLIP_NORM: 1.0  # 梯度裁剪阈值（来自最佳实验）
    SEED: 42  # 固定随机种子保证可重现性
  
  RESULT:

⏹️ 早停配置:
  USE_EARLY_STOPPING: True
  EARLY_STOPPING_PATIENCE: 15  # 最优早停耐心值，避免过早停止

=========================

训练开始时间: 2025年 06月 09日 星期一 17:26:15 CST
使用命令行指定的输出目录: result/DrugBAN3D_balanced_augment_20250609_172011
已保存当前配置到 result/DrugBAN3D_balanced_augment_20250609_172011/config/config_used.yaml
配置文件: result/DrugBAN3D_balanced_augment_20250609_172011/config/DrugBAN3D_augmented_20250609_172011.yaml
输出目录: result/DrugBAN3D_balanced_augment_20250609_172011
运行设备: cuda
数据加载器使用 16 个工作线程
使用分层采样的预划分数据集
数据集: 训练集 11941 样本, 验证集 2102 样本, 测试集 1044 样本
正样本比例: 训练集 32.23%, 验证集 32.25%, 测试集 32.28%
使用增强数据集进行训练...
加载标签文件: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_172011/train_augmented.csv, 包含 11941 条记录
找到 11941/11941 个对应的缓存文件
数据集初始化完成，总样本数: 11941
训练/验证 数据集初始化完成: 11941 个样本
创建数据加载器成功: 预期 249 批次，批次大小 48
加载标签文件: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/data/augmented/labels/20250609_172011/valid_augmented.csv, 包含 2102 条记录
找到 2102/2102 个对应的缓存文件
数据集初始化完成，总样本数: 2102
训练/验证 数据集初始化完成: 2102 个样本
创建数据加载器成功: 预期 44 批次，批次大小 48
测试模式: 使用原始测试数据
测试标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv
缓存目录: /home/work/workspace/shi_shaoqun/snap/DrugBAN-main/cached_graphs
测试标签文件包含 1044 条记录
测试集标签分布: 正样本 337 (32.28%), 负样本 707 (67.72%)
读取测试标签文件: /home/work/workspace/shi_shaoqun/snap/3D_structure/bindingdb/train_csv/test_stratified.csv, 包含 1044 条记录
成功创建测试标签映射，包含 2088 个条目
测试模式：从标签文件获取 2088 个复合物ID
测试模式：只处理标签文件中的 2088 个样本
在缓存目录中找到 1039/2088 个测试样本缓存文件
数据集初始化完成，总样本数: 1039
测试 数据集初始化完成: 1039 个样本
创建数据加载器成功: 预期 22 批次，批次大小 48

==================================================
DrugBAN3D初始化 - 偏差校正模块: 启用
Dropout率: 0.3
GNN层数: 4
==================================================

优化器: Adam, 学习率: 0.0002, L2正则化强度: 0.0004
启用标签平滑，参数值: 0.05
启用类别加权，正样本权重: 1.050
启用梯度裁剪，阈值：1.0
使用state_dict保存模型，避免完整对象复制
使用plateau学习率调度器
运行设备: cuda
启用标签平滑，参数值: 0.05
启用类别加权，正样本权重: 1.0499999523162842
使用ReduceLROnPlateau学习率调度器，监控验证集AUROC
开始训练...
批次 0: 正样本 16, 负样本 32
批次 100: 正样本 13, 负样本 35
批次 200: 正样本 14, 负样本 34
本轮训练: 正样本 43 (29.86%), 负样本 101 (70.14%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.0043
处理批次 1/44, 累计样本数: 96, 批次损失: 0.8162
处理批次 2/44, 累计样本数: 144, 批次损失: 0.8598
处理批次 3/44, 累计样本数: 192, 批次损失: 0.6457
处理批次 4/44, 累计样本数: 240, 批次损失: 2.7590
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.6326, AUPRC=0.4384
当前学习率: 0.000200
保存最佳模型（轮次 1）到 result/DrugBAN3D_balanced_augment_20250609_172011/best_model.pth
Epoch 1/100 - 训练损失: 2.2040 - 验证AUROC: 0.6326 - 验证AUPRC: 0.4384
批次 0: 正样本 16, 负样本 32
批次 100: 正样本 16, 负样本 32
批次 200: 正样本 23, 负样本 25
本轮训练: 正样本 55 (38.19%), 负样本 89 (61.81%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 2.5061
处理批次 1/44, 累计样本数: 96, 批次损失: 0.9720
处理批次 2/44, 累计样本数: 144, 批次损失: 3.1599
处理批次 3/44, 累计样本数: 192, 批次损失: 0.7570
处理批次 4/44, 累计样本数: 240, 批次损失: 2.2760
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.6138, AUPRC=0.4074
当前学习率: 0.000200
Epoch 2/100 - 训练损失: 1.6095 - 验证AUROC: 0.6138 - 验证AUPRC: 0.4074
批次 0: 正样本 13, 负样本 35
批次 100: 正样本 19, 负样本 29
批次 200: 正样本 15, 负样本 33
本轮训练: 正样本 47 (32.64%), 负样本 97 (67.36%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.2197
处理批次 1/44, 累计样本数: 96, 批次损失: 0.8886
处理批次 2/44, 累计样本数: 144, 批次损失: 1.0759
处理批次 3/44, 累计样本数: 192, 批次损失: 0.9371
处理批次 4/44, 累计样本数: 240, 批次损失: 2.7239
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.7305, AUPRC=0.5267
当前学习率: 0.000200
保存最佳模型（轮次 3）到 result/DrugBAN3D_balanced_augment_20250609_172011/best_model.pth
Epoch 3/100 - 训练损失: 1.1961 - 验证AUROC: 0.7305 - 验证AUPRC: 0.5267
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 18, 负样本 30
批次 200: 正样本 18, 负样本 30
本轮训练: 正样本 54 (37.50%), 负样本 90 (62.50%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.7776
处理批次 1/44, 累计样本数: 96, 批次损失: 0.6355
处理批次 2/44, 累计样本数: 144, 批次损失: 0.7997
处理批次 3/44, 累计样本数: 192, 批次损失: 0.8280
处理批次 4/44, 累计样本数: 240, 批次损失: 0.6583
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.7447, AUPRC=0.5821
当前学习率: 0.000200
保存最佳模型（轮次 4）到 result/DrugBAN3D_balanced_augment_20250609_172011/best_model.pth
Epoch 4/100 - 训练损失: 1.1449 - 验证AUROC: 0.7447 - 验证AUPRC: 0.5821
批次 0: 正样本 19, 负样本 29
批次 100: 正样本 16, 负样本 32
批次 200: 正样本 13, 负样本 35
本轮训练: 正样本 48 (33.33%), 负样本 96 (66.67%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.9776
处理批次 1/44, 累计样本数: 96, 批次损失: 0.5697
处理批次 2/44, 累计样本数: 144, 批次损失: 1.1942
处理批次 3/44, 累计样本数: 192, 批次损失: 0.6890
处理批次 4/44, 累计样本数: 240, 批次损失: 0.9751
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.7303, AUPRC=0.5662
当前学习率: 0.000200
Epoch 5/100 - 训练损失: 0.9676 - 验证AUROC: 0.7303 - 验证AUPRC: 0.5662
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 13, 负样本 35
批次 200: 正样本 16, 负样本 32
本轮训练: 正样本 47 (32.64%), 负样本 97 (67.36%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.8344
处理批次 1/44, 累计样本数: 96, 批次损失: 0.6696
处理批次 2/44, 累计样本数: 144, 批次损失: 0.6748
处理批次 3/44, 累计样本数: 192, 批次损失: 0.7508
处理批次 4/44, 累计样本数: 240, 批次损失: 0.5825
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.7599, AUPRC=0.6016
当前学习率: 0.000200
保存最佳模型（轮次 6）到 result/DrugBAN3D_balanced_augment_20250609_172011/best_model.pth
Epoch 6/100 - 训练损失: 0.8973 - 验证AUROC: 0.7599 - 验证AUPRC: 0.6016
批次 0: 正样本 20, 负样本 28
批次 100: 正样本 17, 负样本 31
批次 200: 正样本 22, 负样本 26
本轮训练: 正样本 59 (40.97%), 负样本 85 (59.03%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.6847
处理批次 1/44, 累计样本数: 96, 批次损失: 0.7497
处理批次 2/44, 累计样本数: 144, 批次损失: 0.6589
处理批次 3/44, 累计样本数: 192, 批次损失: 0.6799
处理批次 4/44, 累计样本数: 240, 批次损失: 0.8775
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.7884, AUPRC=0.6040
当前学习率: 0.000200
保存最佳模型（轮次 7）到 result/DrugBAN3D_balanced_augment_20250609_172011/best_model.pth
Epoch 7/100 - 训练损失: 0.7864 - 验证AUROC: 0.7884 - 验证AUPRC: 0.6040
批次 0: 正样本 16, 负样本 32
批次 100: 正样本 16, 负样本 32
批次 200: 正样本 12, 负样本 36
本轮训练: 正样本 44 (30.56%), 负样本 100 (69.44%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.6245
处理批次 1/44, 累计样本数: 96, 批次损失: 0.5623
处理批次 2/44, 累计样本数: 144, 批次损失: 0.5605
处理批次 3/44, 累计样本数: 192, 批次损失: 0.6473
处理批次 4/44, 累计样本数: 240, 批次损失: 0.6634
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8009, AUPRC=0.6835
当前学习率: 0.000200
保存最佳模型（轮次 8）到 result/DrugBAN3D_balanced_augment_20250609_172011/best_model.pth
Epoch 8/100 - 训练损失: 0.7569 - 验证AUROC: 0.8009 - 验证AUPRC: 0.6835
批次 0: 正样本 27, 负样本 21
批次 100: 正样本 15, 负样本 33
批次 200: 正样本 15, 负样本 33
本轮训练: 正样本 57 (39.58%), 负样本 87 (60.42%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.6223
处理批次 1/44, 累计样本数: 96, 批次损失: 0.7193
处理批次 2/44, 累计样本数: 144, 批次损失: 0.5207
处理批次 3/44, 累计样本数: 192, 批次损失: 0.6532
处理批次 4/44, 累计样本数: 240, 批次损失: 0.5899
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8063, AUPRC=0.6803
当前学习率: 0.000200
保存最佳模型（轮次 9）到 result/DrugBAN3D_balanced_augment_20250609_172011/best_model.pth
Epoch 9/100 - 训练损失: 0.6874 - 验证AUROC: 0.8063 - 验证AUPRC: 0.6803
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 12, 负样本 36
批次 200: 正样本 16, 负样本 32
本轮训练: 正样本 46 (31.94%), 负样本 98 (68.06%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.5085
处理批次 1/44, 累计样本数: 96, 批次损失: 0.5815
处理批次 2/44, 累计样本数: 144, 批次损失: 0.5525
处理批次 3/44, 累计样本数: 192, 批次损失: 0.6873
处理批次 4/44, 累计样本数: 240, 批次损失: 0.6825
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8345, AUPRC=0.7338
当前学习率: 0.000200
保存最佳模型（轮次 10）到 result/DrugBAN3D_balanced_augment_20250609_172011/best_model.pth
Epoch 10/100 - 训练损失: 0.6159 - 验证AUROC: 0.8345 - 验证AUPRC: 0.7338
批次 0: 正样本 17, 负样本 31
批次 100: 正样本 11, 负样本 37
批次 200: 正样本 18, 负样本 30
本轮训练: 正样本 46 (31.94%), 负样本 98 (68.06%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.5689
处理批次 1/44, 累计样本数: 96, 批次损失: 0.7110
处理批次 2/44, 累计样本数: 144, 批次损失: 1.4815
处理批次 3/44, 累计样本数: 192, 批次损失: 0.6767
处理批次 4/44, 累计样本数: 240, 批次损失: 0.6015
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8372, AUPRC=0.7310
当前学习率: 0.000200
保存最佳模型（轮次 11）到 result/DrugBAN3D_balanced_augment_20250609_172011/best_model.pth
Epoch 11/100 - 训练损失: 0.6057 - 验证AUROC: 0.8372 - 验证AUPRC: 0.7310
批次 0: 正样本 14, 负样本 34
批次 100: 正样本 11, 负样本 37
批次 200: 正样本 20, 负样本 28
本轮训练: 正样本 45 (31.25%), 负样本 99 (68.75%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.5258
处理批次 1/44, 累计样本数: 96, 批次损失: 0.6285
处理批次 2/44, 累计样本数: 144, 批次损失: 2.5156
处理批次 3/44, 累计样本数: 192, 批次损失: 0.6749
处理批次 4/44, 累计样本数: 240, 批次损失: 0.5892
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8216, AUPRC=0.7140
当前学习率: 0.000200
Epoch 12/100 - 训练损失: 0.5566 - 验证AUROC: 0.8216 - 验证AUPRC: 0.7140
批次 0: 正样本 14, 负样本 34
批次 100: 正样本 15, 负样本 33
批次 200: 正样本 13, 负样本 35
本轮训练: 正样本 42 (29.17%), 负样本 102 (70.83%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.6547
处理批次 1/44, 累计样本数: 96, 批次损失: 1.0587
处理批次 2/44, 累计样本数: 144, 批次损失: 0.7362
处理批次 3/44, 累计样本数: 192, 批次损失: 0.9424
处理批次 4/44, 累计样本数: 240, 批次损失: 0.7806
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8505, AUPRC=0.7683
当前学习率: 0.000200
保存最佳模型（轮次 13）到 result/DrugBAN3D_balanced_augment_20250609_172011/best_model.pth
Epoch 13/100 - 训练损失: 0.5575 - 验证AUROC: 0.8505 - 验证AUPRC: 0.7683
批次 0: 正样本 17, 负样本 31
批次 100: 正样本 12, 负样本 36
批次 200: 正样本 7, 负样本 41
本轮训练: 正样本 36 (25.00%), 负样本 108 (75.00%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.5415
处理批次 1/44, 累计样本数: 96, 批次损失: 1.0481
处理批次 2/44, 累计样本数: 144, 批次损失: 0.5791
处理批次 3/44, 累计样本数: 192, 批次损失: 0.9749
处理批次 4/44, 累计样本数: 240, 批次损失: 0.7933
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8513, AUPRC=0.7574
当前学习率: 0.000200
保存最佳模型（轮次 14）到 result/DrugBAN3D_balanced_augment_20250609_172011/best_model.pth
Epoch 14/100 - 训练损失: 0.4841 - 验证AUROC: 0.8513 - 验证AUPRC: 0.7574
批次 0: 正样本 12, 负样本 36
批次 100: 正样本 16, 负样本 32
批次 200: 正样本 13, 负样本 35
本轮训练: 正样本 41 (28.47%), 负样本 103 (71.53%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.7614
处理批次 1/44, 累计样本数: 96, 批次损失: 1.3422
处理批次 2/44, 累计样本数: 144, 批次损失: 1.1568
处理批次 3/44, 累计样本数: 192, 批次损失: 1.2716
处理批次 4/44, 累计样本数: 240, 批次损失: 0.6767
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8562, AUPRC=0.7771
当前学习率: 0.000200
保存最佳模型（轮次 15）到 result/DrugBAN3D_balanced_augment_20250609_172011/best_model.pth
Epoch 15/100 - 训练损失: 0.4392 - 验证AUROC: 0.8562 - 验证AUPRC: 0.7771
批次 0: 正样本 8, 负样本 40
批次 100: 正样本 16, 负样本 32
批次 200: 正样本 19, 负样本 29
本轮训练: 正样本 43 (29.86%), 负样本 101 (70.14%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.6649
处理批次 1/44, 累计样本数: 96, 批次损失: 0.7551
处理批次 2/44, 累计样本数: 144, 批次损失: 0.6413
处理批次 3/44, 累计样本数: 192, 批次损失: 0.8060
处理批次 4/44, 累计样本数: 240, 批次损失: 0.6546
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8612, AUPRC=0.7689
当前学习率: 0.000200
保存最佳模型（轮次 16）到 result/DrugBAN3D_balanced_augment_20250609_172011/best_model.pth
Epoch 16/100 - 训练损失: 0.4820 - 验证AUROC: 0.8612 - 验证AUPRC: 0.7689
批次 0: 正样本 16, 负样本 32
批次 100: 正样本 12, 负样本 36
批次 200: 正样本 18, 负样本 30
本轮训练: 正样本 46 (31.94%), 负样本 98 (68.06%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.6736
处理批次 1/44, 累计样本数: 96, 批次损失: 0.7877
处理批次 2/44, 累计样本数: 144, 批次损失: 1.5028
处理批次 3/44, 累计样本数: 192, 批次损失: 0.7761
处理批次 4/44, 累计样本数: 240, 批次损失: 0.6366
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8618, AUPRC=0.7879
当前学习率: 0.000200
保存最佳模型（轮次 17）到 result/DrugBAN3D_balanced_augment_20250609_172011/best_model.pth
Epoch 17/100 - 训练损失: 0.4765 - 验证AUROC: 0.8618 - 验证AUPRC: 0.7879
批次 0: 正样本 20, 负样本 28
批次 100: 正样本 14, 负样本 34
批次 200: 正样本 20, 负样本 28
本轮训练: 正样本 54 (37.50%), 负样本 90 (62.50%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.6814
处理批次 1/44, 累计样本数: 96, 批次损失: 1.4731
处理批次 2/44, 累计样本数: 144, 批次损失: 1.0631
处理批次 3/44, 累计样本数: 192, 批次损失: 1.5067
处理批次 4/44, 累计样本数: 240, 批次损失: 0.7979
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8572, AUPRC=0.7817
当前学习率: 0.000200
Epoch 18/100 - 训练损失: 0.4341 - 验证AUROC: 0.8572 - 验证AUPRC: 0.7817
批次 0: 正样本 16, 负样本 32
批次 100: 正样本 15, 负样本 33
批次 200: 正样本 16, 负样本 32
本轮训练: 正样本 47 (32.64%), 负样本 97 (67.36%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.5411
处理批次 1/44, 累计样本数: 96, 批次损失: 1.2646
处理批次 2/44, 累计样本数: 144, 批次损失: 0.6961
处理批次 3/44, 累计样本数: 192, 批次损失: 1.3028
处理批次 4/44, 累计样本数: 240, 批次损失: 0.8038
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8633, AUPRC=0.7743
当前学习率: 0.000200
保存最佳模型（轮次 19）到 result/DrugBAN3D_balanced_augment_20250609_172011/best_model.pth
Epoch 19/100 - 训练损失: 0.4187 - 验证AUROC: 0.8633 - 验证AUPRC: 0.7743
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 17, 负样本 31
批次 200: 正样本 17, 负样本 31
本轮训练: 正样本 52 (36.11%), 负样本 92 (63.89%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.5746
处理批次 1/44, 累计样本数: 96, 批次损失: 1.1302
处理批次 2/44, 累计样本数: 144, 批次损失: 0.9240
处理批次 3/44, 累计样本数: 192, 批次损失: 1.0728
处理批次 4/44, 累计样本数: 240, 批次损失: 0.5770
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8733, AUPRC=0.8162
当前学习率: 0.000200
保存最佳模型（轮次 20）到 result/DrugBAN3D_balanced_augment_20250609_172011/best_model.pth
Epoch 20/100 - 训练损失: 0.4051 - 验证AUROC: 0.8733 - 验证AUPRC: 0.8162
批次 0: 正样本 18, 负样本 30
批次 100: 正样本 13, 负样本 35
批次 200: 正样本 14, 负样本 34
本轮训练: 正样本 45 (31.25%), 负样本 99 (68.75%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.7598
处理批次 1/44, 累计样本数: 96, 批次损失: 1.7993
处理批次 2/44, 累计样本数: 144, 批次损失: 1.7747
处理批次 3/44, 累计样本数: 192, 批次损失: 1.8746
处理批次 4/44, 累计样本数: 240, 批次损失: 0.8226
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8754, AUPRC=0.8116
当前学习率: 0.000200
保存最佳模型（轮次 21）到 result/DrugBAN3D_balanced_augment_20250609_172011/best_model.pth
Epoch 21/100 - 训练损失: 0.3844 - 验证AUROC: 0.8754 - 验证AUPRC: 0.8116
批次 0: 正样本 11, 负样本 37
批次 100: 正样本 16, 负样本 32
批次 200: 正样本 14, 负样本 34
本轮训练: 正样本 41 (28.47%), 负样本 103 (71.53%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.6358
处理批次 1/44, 累计样本数: 96, 批次损失: 1.0157
处理批次 2/44, 累计样本数: 144, 批次损失: 1.6757
处理批次 3/44, 累计样本数: 192, 批次损失: 0.9004
处理批次 4/44, 累计样本数: 240, 批次损失: 0.7884
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8608, AUPRC=0.7719
当前学习率: 0.000200
Epoch 22/100 - 训练损失: 0.3716 - 验证AUROC: 0.8608 - 验证AUPRC: 0.7719
批次 0: 正样本 11, 负样本 37
批次 100: 正样本 18, 负样本 30
批次 200: 正样本 16, 负样本 32
本轮训练: 正样本 45 (31.25%), 负样本 99 (68.75%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.7752
处理批次 1/44, 累计样本数: 96, 批次损失: 0.8573
处理批次 2/44, 累计样本数: 144, 批次损失: 1.4238
处理批次 3/44, 累计样本数: 192, 批次损失: 1.1839
处理批次 4/44, 累计样本数: 240, 批次损失: 0.8083
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8855, AUPRC=0.8177
当前学习率: 0.000200
保存最佳模型（轮次 23）到 result/DrugBAN3D_balanced_augment_20250609_172011/best_model.pth
Epoch 23/100 - 训练损失: 0.3497 - 验证AUROC: 0.8855 - 验证AUPRC: 0.8177
批次 0: 正样本 19, 负样本 29
批次 100: 正样本 17, 负样本 31
批次 200: 正样本 18, 负样本 30
本轮训练: 正样本 54 (37.50%), 负样本 90 (62.50%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 2.9508
处理批次 1/44, 累计样本数: 96, 批次损失: 1.2039
处理批次 2/44, 累计样本数: 144, 批次损失: 0.8387
处理批次 3/44, 累计样本数: 192, 批次损失: 1.1581
处理批次 4/44, 累计样本数: 240, 批次损失: 0.5663
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8841, AUPRC=0.8065
当前学习率: 0.000200
Epoch 24/100 - 训练损失: 0.3773 - 验证AUROC: 0.8841 - 验证AUPRC: 0.8065
批次 0: 正样本 20, 负样本 28
批次 100: 正样本 15, 负样本 33
批次 200: 正样本 12, 负样本 36
本轮训练: 正样本 47 (32.64%), 负样本 97 (67.36%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.6938
处理批次 1/44, 累计样本数: 96, 批次损失: 1.2762
处理批次 2/44, 累计样本数: 144, 批次损失: 0.6687
处理批次 3/44, 累计样本数: 192, 批次损失: 1.4059
处理批次 4/44, 累计样本数: 240, 批次损失: 0.8147
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8744, AUPRC=0.8099
当前学习率: 0.000200
Epoch 25/100 - 训练损失: 0.3510 - 验证AUROC: 0.8744 - 验证AUPRC: 0.8099
批次 0: 正样本 15, 负样本 33
批次 100: 正样本 16, 负样本 32
批次 200: 正样本 14, 负样本 34
本轮训练: 正样本 45 (31.25%), 负样本 99 (68.75%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.8626
处理批次 1/44, 累计样本数: 96, 批次损失: 1.4065
处理批次 2/44, 累计样本数: 144, 批次损失: 1.3535
处理批次 3/44, 累计样本数: 192, 批次损失: 1.1972
处理批次 4/44, 累计样本数: 240, 批次损失: 0.7068
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8676, AUPRC=0.7924
当前学习率: 0.000200
Epoch 26/100 - 训练损失: 0.3354 - 验证AUROC: 0.8676 - 验证AUPRC: 0.7924
批次 0: 正样本 13, 负样本 35
批次 100: 正样本 13, 负样本 35
批次 200: 正样本 19, 负样本 29
本轮训练: 正样本 45 (31.25%), 负样本 99 (68.75%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.0326
处理批次 1/44, 累计样本数: 96, 批次损失: 1.8072
处理批次 2/44, 累计样本数: 144, 批次损失: 0.9041
处理批次 3/44, 累计样本数: 192, 批次损失: 1.1793
处理批次 4/44, 累计样本数: 240, 批次损失: 0.8196
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8688, AUPRC=0.7960
当前学习率: 0.000200
Epoch 27/100 - 训练损失: 0.3701 - 验证AUROC: 0.8688 - 验证AUPRC: 0.7960
批次 0: 正样本 17, 负样本 31
批次 100: 正样本 15, 负样本 33
批次 200: 正样本 15, 负样本 33
本轮训练: 正样本 47 (32.64%), 负样本 97 (67.36%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.7699
处理批次 1/44, 累计样本数: 96, 批次损失: 1.9439
处理批次 2/44, 累计样本数: 144, 批次损失: 1.6500
处理批次 3/44, 累计样本数: 192, 批次损失: 1.6360
处理批次 4/44, 累计样本数: 240, 批次损失: 1.2761
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8668, AUPRC=0.8012
Epoch 00028: reducing learning rate of group 0 to 1.0000e-04.
当前学习率: 0.000100
Epoch 28/100 - 训练损失: 0.3258 - 验证AUROC: 0.8668 - 验证AUPRC: 0.8012
批次 0: 正样本 15, 负样本 33
批次 100: 正样本 17, 负样本 31
批次 200: 正样本 17, 负样本 31
本轮训练: 正样本 49 (34.03%), 负样本 95 (65.97%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.8349
处理批次 1/44, 累计样本数: 96, 批次损失: 1.5296
处理批次 2/44, 累计样本数: 144, 批次损失: 1.0354
处理批次 3/44, 累计样本数: 192, 批次损失: 0.8416
处理批次 4/44, 累计样本数: 240, 批次损失: 1.1403
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8841, AUPRC=0.8186
当前学习率: 0.000100
Epoch 29/100 - 训练损失: 0.2803 - 验证AUROC: 0.8841 - 验证AUPRC: 0.8186
批次 0: 正样本 13, 负样本 35
批次 100: 正样本 13, 负样本 35
批次 200: 正样本 10, 负样本 38
本轮训练: 正样本 36 (25.00%), 负样本 108 (75.00%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.8846
处理批次 1/44, 累计样本数: 96, 批次损失: 1.5127
处理批次 2/44, 累计样本数: 144, 批次损失: 1.4117
处理批次 3/44, 累计样本数: 192, 批次损失: 0.9066
处理批次 4/44, 累计样本数: 240, 批次损失: 0.9889
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8862, AUPRC=0.8269
当前学习率: 0.000100
保存最佳模型（轮次 30）到 result/DrugBAN3D_balanced_augment_20250609_172011/best_model.pth
Epoch 30/100 - 训练损失: 0.2537 - 验证AUROC: 0.8862 - 验证AUPRC: 0.8269
批次 0: 正样本 13, 负样本 35
批次 100: 正样本 18, 负样本 30
批次 200: 正样本 14, 负样本 34
本轮训练: 正样本 45 (31.25%), 负样本 99 (68.75%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.1794
处理批次 1/44, 累计样本数: 96, 批次损失: 1.6613
处理批次 2/44, 累计样本数: 144, 批次损失: 1.8810
处理批次 3/44, 累计样本数: 192, 批次损失: 1.3383
处理批次 4/44, 累计样本数: 240, 批次损失: 1.0084
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8860, AUPRC=0.8219
当前学习率: 0.000100
Epoch 31/100 - 训练损失: 0.2487 - 验证AUROC: 0.8860 - 验证AUPRC: 0.8219
批次 0: 正样本 16, 负样本 32
批次 100: 正样本 14, 负样本 34
批次 200: 正样本 13, 负样本 35
本轮训练: 正样本 43 (29.86%), 负样本 101 (70.14%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.2006
处理批次 1/44, 累计样本数: 96, 批次损失: 1.3468
处理批次 2/44, 累计样本数: 144, 批次损失: 1.4834
处理批次 3/44, 累计样本数: 192, 批次损失: 0.9583
处理批次 4/44, 累计样本数: 240, 批次损失: 1.0185
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8801, AUPRC=0.8213
当前学习率: 0.000100
Epoch 32/100 - 训练损失: 0.2473 - 验证AUROC: 0.8801 - 验证AUPRC: 0.8213
批次 0: 正样本 9, 负样本 39
批次 100: 正样本 15, 负样本 33
批次 200: 正样本 14, 负样本 34
本轮训练: 正样本 38 (26.39%), 负样本 106 (73.61%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.0906
处理批次 1/44, 累计样本数: 96, 批次损失: 1.3027
处理批次 2/44, 累计样本数: 144, 批次损失: 1.6372
处理批次 3/44, 累计样本数: 192, 批次损失: 0.9062
处理批次 4/44, 累计样本数: 240, 批次损失: 1.5169
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8740, AUPRC=0.8121
Epoch 00033: reducing learning rate of group 0 to 5.0000e-05.
当前学习率: 0.000050
Epoch 33/100 - 训练损失: 0.2473 - 验证AUROC: 0.8740 - 验证AUPRC: 0.8121
批次 0: 正样本 15, 负样本 33
批次 100: 正样本 16, 负样本 32
批次 200: 正样本 16, 负样本 32
本轮训练: 正样本 47 (32.64%), 负样本 97 (67.36%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.0083
处理批次 1/44, 累计样本数: 96, 批次损失: 1.5885
处理批次 2/44, 累计样本数: 144, 批次损失: 1.5036
处理批次 3/44, 累计样本数: 192, 批次损失: 1.2898
处理批次 4/44, 累计样本数: 240, 批次损失: 1.3410
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8843, AUPRC=0.8259
当前学习率: 0.000050
Epoch 34/100 - 训练损失: 0.2335 - 验证AUROC: 0.8843 - 验证AUPRC: 0.8259
批次 0: 正样本 14, 负样本 34
批次 100: 正样本 17, 负样本 31
批次 200: 正样本 16, 负样本 32
本轮训练: 正样本 47 (32.64%), 负样本 97 (67.36%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.3872
处理批次 1/44, 累计样本数: 96, 批次损失: 1.6447
处理批次 2/44, 累计样本数: 144, 批次损失: 1.9159
处理批次 3/44, 累计样本数: 192, 批次损失: 1.2911
处理批次 4/44, 累计样本数: 240, 批次损失: 1.5813
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8839, AUPRC=0.8202
当前学习率: 0.000050
Epoch 35/100 - 训练损失: 0.2000 - 验证AUROC: 0.8839 - 验证AUPRC: 0.8202
批次 0: 正样本 14, 负样本 34
批次 100: 正样本 10, 负样本 38
批次 200: 正样本 12, 负样本 36
本轮训练: 正样本 36 (25.00%), 负样本 108 (75.00%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.1609
处理批次 1/44, 累计样本数: 96, 批次损失: 1.6955
处理批次 2/44, 累计样本数: 144, 批次损失: 2.0868
处理批次 3/44, 累计样本数: 192, 批次损失: 1.1938
处理批次 4/44, 累计样本数: 240, 批次损失: 1.1616
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8835, AUPRC=0.8243
当前学习率: 0.000050
Epoch 36/100 - 训练损失: 0.1954 - 验证AUROC: 0.8835 - 验证AUPRC: 0.8243
批次 0: 正样本 15, 负样本 33
批次 100: 正样本 15, 负样本 33
批次 200: 正样本 19, 负样本 29
本轮训练: 正样本 49 (34.03%), 负样本 95 (65.97%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.5853
处理批次 1/44, 累计样本数: 96, 批次损失: 1.5456
处理批次 2/44, 累计样本数: 144, 批次损失: 1.8391
处理批次 3/44, 累计样本数: 192, 批次损失: 1.2511
处理批次 4/44, 累计样本数: 240, 批次损失: 1.4143
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8779, AUPRC=0.8173
当前学习率: 0.000050
Epoch 37/100 - 训练损失: 0.2005 - 验证AUROC: 0.8779 - 验证AUPRC: 0.8173
批次 0: 正样本 17, 负样本 31
批次 100: 正样本 15, 负样本 33
批次 200: 正样本 19, 负样本 29
本轮训练: 正样本 51 (35.42%), 负样本 93 (64.58%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.4113
处理批次 1/44, 累计样本数: 96, 批次损失: 1.5285
处理批次 2/44, 累计样本数: 144, 批次损失: 2.0283
处理批次 3/44, 累计样本数: 192, 批次损失: 1.2376
处理批次 4/44, 累计样本数: 240, 批次损失: 1.4420
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8887, AUPRC=0.8366
当前学习率: 0.000050
保存最佳模型（轮次 38）到 result/DrugBAN3D_balanced_augment_20250609_172011/best_model.pth
Epoch 38/100 - 训练损失: 0.2014 - 验证AUROC: 0.8887 - 验证AUPRC: 0.8366
批次 0: 正样本 13, 负样本 35
批次 100: 正样本 17, 负样本 31
批次 200: 正样本 16, 负样本 32
本轮训练: 正样本 46 (31.94%), 负样本 98 (68.06%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.1253
处理批次 1/44, 累计样本数: 96, 批次损失: 1.3952
处理批次 2/44, 累计样本数: 144, 批次损失: 1.6660
处理批次 3/44, 累计样本数: 192, 批次损失: 1.1789
处理批次 4/44, 累计样本数: 240, 批次损失: 1.2701
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8868, AUPRC=0.8305
当前学习率: 0.000050
Epoch 39/100 - 训练损失: 0.1854 - 验证AUROC: 0.8868 - 验证AUPRC: 0.8305
批次 0: 正样本 12, 负样本 36
批次 100: 正样本 9, 负样本 39
批次 200: 正样本 17, 负样本 31
本轮训练: 正样本 38 (26.39%), 负样本 106 (73.61%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 3.1952
处理批次 1/44, 累计样本数: 96, 批次损失: 1.5879
处理批次 2/44, 累计样本数: 144, 批次损失: 2.1637
处理批次 3/44, 累计样本数: 192, 批次损失: 1.1010
处理批次 4/44, 累计样本数: 240, 批次损失: 1.5841
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8781, AUPRC=0.8134
当前学习率: 0.000050
Epoch 40/100 - 训练损失: 0.1875 - 验证AUROC: 0.8781 - 验证AUPRC: 0.8134
批次 0: 正样本 16, 负样本 32
批次 100: 正样本 12, 负样本 36
批次 200: 正样本 19, 负样本 29
本轮训练: 正样本 47 (32.64%), 负样本 97 (67.36%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.2484
处理批次 1/44, 累计样本数: 96, 批次损失: 1.5813
处理批次 2/44, 累计样本数: 144, 批次损失: 1.3885
处理批次 3/44, 累计样本数: 192, 批次损失: 1.1094
处理批次 4/44, 累计样本数: 240, 批次损失: 1.2522
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8745, AUPRC=0.8066
当前学习率: 0.000050
Epoch 41/100 - 训练损失: 0.1856 - 验证AUROC: 0.8745 - 验证AUPRC: 0.8066
批次 0: 正样本 11, 负样本 37
批次 100: 正样本 15, 负样本 33
批次 200: 正样本 13, 负样本 35
本轮训练: 正样本 39 (27.08%), 负样本 105 (72.92%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 0.9996
处理批次 1/44, 累计样本数: 96, 批次损失: 1.3453
处理批次 2/44, 累计样本数: 144, 批次损失: 1.5986
处理批次 3/44, 累计样本数: 192, 批次损失: 0.9486
处理批次 4/44, 累计样本数: 240, 批次损失: 1.2801
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8819, AUPRC=0.8153
当前学习率: 0.000050
Epoch 42/100 - 训练损失: 0.1753 - 验证AUROC: 0.8819 - 验证AUPRC: 0.8153
批次 0: 正样本 13, 负样本 35
批次 100: 正样本 12, 负样本 36
批次 200: 正样本 12, 负样本 36
本轮训练: 正样本 37 (25.69%), 负样本 107 (74.31%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.0747
处理批次 1/44, 累计样本数: 96, 批次损失: 1.4648
处理批次 2/44, 累计样本数: 144, 批次损失: 1.6057
处理批次 3/44, 累计样本数: 192, 批次损失: 1.0252
处理批次 4/44, 累计样本数: 240, 批次损失: 1.6436
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8842, AUPRC=0.8236
Epoch 00043: reducing learning rate of group 0 to 2.5000e-05.
当前学习率: 0.000025
Epoch 43/100 - 训练损失: 0.1785 - 验证AUROC: 0.8842 - 验证AUPRC: 0.8236
批次 0: 正样本 16, 负样本 32
批次 100: 正样本 14, 负样本 34
批次 200: 正样本 12, 负样本 36
本轮训练: 正样本 42 (29.17%), 负样本 102 (70.83%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.0779
处理批次 1/44, 累计样本数: 96, 批次损失: 1.7491
处理批次 2/44, 累计样本数: 144, 批次损失: 1.6802
处理批次 3/44, 累计样本数: 192, 批次损失: 1.1612
处理批次 4/44, 累计样本数: 240, 批次损失: 1.5019
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8808, AUPRC=0.8245
当前学习率: 0.000025
Epoch 44/100 - 训练损失: 0.1661 - 验证AUROC: 0.8808 - 验证AUPRC: 0.8245
批次 0: 正样本 14, 负样本 34
批次 100: 正样本 13, 负样本 35
批次 200: 正样本 10, 负样本 38
本轮训练: 正样本 37 (25.69%), 负样本 107 (74.31%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.2813
处理批次 1/44, 累计样本数: 96, 批次损失: 1.6815
处理批次 2/44, 累计样本数: 144, 批次损失: 1.7845
处理批次 3/44, 累计样本数: 192, 批次损失: 1.1295
处理批次 4/44, 累计样本数: 240, 批次损失: 1.5553
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8831, AUPRC=0.8302
当前学习率: 0.000025
Epoch 45/100 - 训练损失: 0.1570 - 验证AUROC: 0.8831 - 验证AUPRC: 0.8302
批次 0: 正样本 12, 负样本 36
批次 100: 正样本 14, 负样本 34
批次 200: 正样本 24, 负样本 24
本轮训练: 正样本 50 (34.72%), 负样本 94 (65.28%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.2056
处理批次 1/44, 累计样本数: 96, 批次损失: 1.8138
处理批次 2/44, 累计样本数: 144, 批次损失: 1.7435
处理批次 3/44, 累计样本数: 192, 批次损失: 1.2942
处理批次 4/44, 累计样本数: 240, 批次损失: 1.6774
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8817, AUPRC=0.8266
当前学习率: 0.000025
Epoch 46/100 - 训练损失: 0.1521 - 验证AUROC: 0.8817 - 验证AUPRC: 0.8266
批次 0: 正样本 17, 负样本 31
批次 100: 正样本 16, 负样本 32
批次 200: 正样本 16, 负样本 32
本轮训练: 正样本 49 (34.03%), 负样本 95 (65.97%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.1223
处理批次 1/44, 累计样本数: 96, 批次损失: 1.4096
处理批次 2/44, 累计样本数: 144, 批次损失: 1.9705
处理批次 3/44, 累计样本数: 192, 批次损失: 1.1357
处理批次 4/44, 累计样本数: 240, 批次损失: 1.5993
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8766, AUPRC=0.8066
当前学习率: 0.000025
Epoch 47/100 - 训练损失: 0.1491 - 验证AUROC: 0.8766 - 验证AUPRC: 0.8066
批次 0: 正样本 17, 负样本 31
批次 100: 正样本 24, 负样本 24
批次 200: 正样本 11, 负样本 37
本轮训练: 正样本 52 (36.11%), 负样本 92 (63.89%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.2717
处理批次 1/44, 累计样本数: 96, 批次损失: 1.6172
处理批次 2/44, 累计样本数: 144, 批次损失: 1.9905
处理批次 3/44, 累计样本数: 192, 批次损失: 1.1835
处理批次 4/44, 累计样本数: 240, 批次损失: 1.4968
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8721, AUPRC=0.8106
Epoch 00048: reducing learning rate of group 0 to 1.2500e-05.
当前学习率: 0.000013
Epoch 48/100 - 训练损失: 0.1461 - 验证AUROC: 0.8721 - 验证AUPRC: 0.8106
批次 0: 正样本 21, 负样本 27
批次 100: 正样本 12, 负样本 36
批次 200: 正样本 15, 负样本 33
本轮训练: 正样本 48 (33.33%), 负样本 96 (66.67%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.4288
处理批次 1/44, 累计样本数: 96, 批次损失: 1.8307
处理批次 2/44, 累计样本数: 144, 批次损失: 2.2444
处理批次 3/44, 累计样本数: 192, 批次损失: 1.2024
处理批次 4/44, 累计样本数: 240, 批次损失: 1.5314
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8826, AUPRC=0.8177
当前学习率: 0.000013
Epoch 49/100 - 训练损失: 0.1363 - 验证AUROC: 0.8826 - 验证AUPRC: 0.8177
批次 0: 正样本 16, 负样本 32
批次 100: 正样本 15, 负样本 33
批次 200: 正样本 10, 负样本 38
本轮训练: 正样本 41 (28.47%), 负样本 103 (71.53%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.3128
处理批次 1/44, 累计样本数: 96, 批次损失: 1.6640
处理批次 2/44, 累计样本数: 144, 批次损失: 1.8478
处理批次 3/44, 累计样本数: 192, 批次损失: 1.1995
处理批次 4/44, 累计样本数: 240, 批次损失: 1.4800
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8834, AUPRC=0.8183
当前学习率: 0.000013
Epoch 50/100 - 训练损失: 0.1375 - 验证AUROC: 0.8834 - 验证AUPRC: 0.8183
批次 0: 正样本 12, 负样本 36
批次 100: 正样本 14, 负样本 34
批次 200: 正样本 13, 负样本 35
本轮训练: 正样本 39 (27.08%), 负样本 105 (72.92%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.5401
处理批次 1/44, 累计样本数: 96, 批次损失: 1.5451
处理批次 2/44, 累计样本数: 144, 批次损失: 2.0360
处理批次 3/44, 累计样本数: 192, 批次损失: 1.2156
处理批次 4/44, 累计样本数: 240, 批次损失: 1.7304
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8816, AUPRC=0.8141
当前学习率: 0.000013
Epoch 51/100 - 训练损失: 0.1332 - 验证AUROC: 0.8816 - 验证AUPRC: 0.8141
批次 0: 正样本 14, 负样本 34
批次 100: 正样本 18, 负样本 30
批次 200: 正样本 18, 负样本 30
本轮训练: 正样本 50 (34.72%), 负样本 94 (65.28%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 1.5148
处理批次 1/44, 累计样本数: 96, 批次损失: 1.5768
处理批次 2/44, 累计样本数: 144, 批次损失: 1.9917
处理批次 3/44, 累计样本数: 192, 批次损失: 1.2721
处理批次 4/44, 累计样本数: 240, 批次损失: 1.3976
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8805, AUPRC=0.8157
当前学习率: 0.000013
Epoch 52/100 - 训练损失: 0.1402 - 验证AUROC: 0.8805 - 验证AUPRC: 0.8157
批次 0: 正样本 13, 负样本 35
批次 100: 正样本 13, 负样本 35
批次 200: 正样本 18, 负样本 30
本轮训练: 正样本 44 (30.56%), 负样本 100 (69.44%)
验证数据集大小: 44 批次
开始进行val评估...
处理批次 0/44, 累计样本数: 48, 批次损失: 3.4812
处理批次 1/44, 累计样本数: 96, 批次损失: 1.6106
处理批次 2/44, 累计样本数: 144, 批次损失: 1.9777
处理批次 3/44, 累计样本数: 192, 批次损失: 1.3120
处理批次 4/44, 累计样本数: 240, 批次损失: 1.6152
测试完成: 处理了 44/44 批次, 2102 个样本
错误批次数: 0
预测标签统计: 正样本数=678, 负样本数=1424
成功计算评估指标: AUROC=0.8832, AUPRC=0.8125
Epoch 00053: reducing learning rate of group 0 to 6.2500e-06.
当前学习率: 0.000006
早停触发！连续15轮验证集性能未提升
测试数据集大小: 22 批次
成功加载最佳模型状态（来自Epoch 38）
开始进行test评估...
处理批次 0/22, 累计样本数: 48, 批次损失: 0.9445
处理批次 1/22, 累计样本数: 96, 批次损失: 0.8092
处理批次 2/22, 累计样本数: 144, 批次损失: 1.8428
处理批次 3/22, 累计样本数: 192, 批次损失: 1.8429
处理批次 4/22, 累计样本数: 240, 批次损失: 1.1981
测试完成: 处理了 22/22 批次, 1039 个样本
错误批次数: 0
预测标签统计: 正样本数=336, 负样本数=703
成功计算评估指标: AUROC=0.8917, AUPRC=0.8093
最佳阈值: 0.0226, 对应的F1分数: 0.8281
混淆矩阵:
[[497 206]
 [ 29 307]]
详细测试结果: AUROC=0.8917, AUPRC=0.8093, F1=0.8281, 敏感度=0.7070, 特异度=0.9137, 准确率=0.7738, 精确度=0.5984
训练完成！最佳模型来自Epoch 38 - AUROC: 0.8917 - F1: 0.8281
结果已保存到: result/DrugBAN3D_balanced_augment_20250609_172011
训练完成时间: 2025年 06月 09日 星期一 20:26:53 CST
=== 训练总结 ===
训练成功完成！
结果保存在: result/DrugBAN3D_balanced_augment_20250609_172011
配置文件: result/DrugBAN3D_balanced_augment_20250609_172011/config/DrugBAN3D_augmented_20250609_172011.yaml
日志文件: result/DrugBAN3D_balanced_augment_20250609_172011/logs/train.log
保存的模型文件:
  result/DrugBAN3D_balanced_augment_20250609_172011/best_model.pth
